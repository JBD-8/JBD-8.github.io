<!DOCTYPE HTML>
<html>
<head>
	<title> Rapport satistique </title>
	<script src="https://www.chartjs.org/dist/2.8.0/Chart.min.js"></script>
	<script src="https://www.chartjs.org/samples/latest/utils.js"></script>
	<script src="data/Couche_finale_typo_1.js"></script>
	<script src="data/tableau_donnees.js"></script>
	<script src="data/EPCI.js"></script>
	<script src="data/France.js"></script>
	<script src="data/DEP.js"></script>
	<script src="data/Facade.js"></script>
	<script src="js/jquery-3.4.1.js"></script>
	<script src="js/chartjs-plugin-datalabels.js"></script>
	<script src="js/canvas-toBlob.js"></script>
	<script src="js/FileSaver.js"></script>
	<script src="data/secondaires_com.js"></script>
	<script src="data/secondaires_epci.js"></script>
	<script src="data/secondaires_dep.js"></script>
	<script src="data/secondaires_fac.js"></script>
	<script src="data/secondaires_fra.js"></script>
	
<style>

html, body { height: 100%; padding: 0; margin: 0; }
div { }
#div1 { background: #d6eaf8; width: 49.75%; height: 50%; float: left; border-width:1px; border-style:dotted; border-color:black;}
#div2 { background: #d6eaf8; width: 49.75%; height: 50%; float: left; border-width:1px; border-style:dotted; border-color:black;}
#div3 { background: #d6eaf8; width: 49.75%; height: 50%; float: left; border-width:1px; border-style:dotted; border-color:black;}
#div4 { background: #d6eaf8; width: 49.75%; height: 50%; float: left; border-width:1px; border-style:dotted; border-color:black;}

canvas {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	
canvas2 {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	
canvas3 {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	
canvas4 {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

#graphique1 {
	width: 40%;
}

#graphique2 {
	width: 40%;
}

#graphique3 {
	width: 40%;
}

#graphique4 {
	width: 40%;
}

#centered_div {
   width: 5%;
   height: 2%;
   position: absolute;
   top: 45%;
   left: 46%;
   margin-left: auto;
   margin-top: auto;
}

.carre {
	display: inline-block;
  height: 75px;
  width: 120px;
  background-color: #d6eaf8;
  border: solid;
  border-width: 1px;
  border-color: black;
  font-family: Helvetica;
  color: #626567;
}

</style>
</head>
<body>

<div id="div1">
	<div style="width: 87%; margin: 0 auto;">
		<canvas id="canvas"></canvas>
	</div>
	
	<select name="selection" id="graphique1" onchange="graphe1(this)" autocomplete="off" style="margin-left: 2%;">
	<option disabled selected value="0"> Données >> </option>
	<optgroup label="Socio-démographique">
    <option value="1">Taux d'évolution annuel de la population</option>
	<option value ="2">Structure par âge de la population</option>
	</optgroup>
	<optgroup label="Économique">
    <option value="3">Part des emplois de la sphère présentielle dans l’emploi total </option>
	<option value="4">Nombre d’emplois au lieu de travail</option>
	</optgroup>
	<optgroup label="Occupation du sol - Logement">
    <option value="5">Part des espaces artificialisés sur le territoire communal </option>
	<option value="6">Part des résidences secondaires dans le total des logements </option>
	<option value="7">Composition du parc de logements</option>
	<optgroup label="Fiscalo-financier">
	<option value="8">Part du produit des impôts ménages dans le produit total des impôts locaux du bloc communal </option>
	<option value="9">Part des recettes fiscales dans le produit total de fonctionnement</option>
</select>
	<select name="selection2" id="selecteur" onchange="graphe1(this)" autocomplete="off">
	<option value="1999"> 1999 </option>
	<option value="2010"> 2010 </option>
	<option value="2016"> 2016 </option>
	</select>
	<button id="save1"> Sauvegarder le graphique </button>
	<a style="float: right; margin-right: 4px;" href="../typologie.html" target="_blank">Source des données</a> 
</div> 
<div id="div2">
	<div style="width: 87%; margin: 0 auto;">
		<canvas id="canvas2"></canvas>
	</div>
	
	<select name="selection2" id="graphique2" onchange="graphe2(this)" autocomplete="off" style="margin-left: 2%;">
	<option disabled selected value="0"> Données >> </option>
	<optgroup label="Socio-démographique">
    <option value="1">Taux d'évolution annuel de la population</option>
	<option value ="2">Structure par âge de la population</option>
	</optgroup>
	<optgroup label="Économique">
    <option value="3">Part des emplois de la sphère présentielle dans l’emploi total </option>
	<option value="4">Nombre d’emplois au lieu de travail</option>
	</optgroup>
	<optgroup label="Occupation du sol - Logement">
    <option value="5">Part des espaces artificialisés sur le territoire communal </option>
	<option value="6">Part des résidences secondaires dans le total des logements </option>
	<option value="7">Composition du parc de logements</option>
	<optgroup label="Fiscalo-financier">
	<option value="8">Part du produit des impôts ménages dans le produit total des impôts locaux du bloc communal </option>
	<option value="9">Part des recettes fiscales dans le produit total de fonctionnement</option>
</select>
	<select name="selection2.1" id="selecteur2" onchange="graphe2(this)" autocomplete="off">
	<option value="1999"> 1999 </option>
	<option value="2010"> 2010 </option>
	<option value="2016"> 2016 </option>
	</select>
	<button id="save2"> Sauvegarder le graphique </button>
	<a style="float: right; margin-right: 4px;" href="../typologie.html" target="_blank">Source des données</a> 
</div> 

<div id="div3">
	<div style="width: 87%; margin: 0 auto;">
		<canvas id="canvas3"></canvas>
	</div>
	
	<select name="selection3" id="graphique3" onchange="graphe3(this)" autocomplete="off" style="margin-left: 2%;">
	<option disabled selected value="0"> Données >> </option>
	<optgroup label="Socio-démographique">
    <option value="1">Taux d'évolution annuel de la population</option>
	<option value ="2">Structure par âge de la population</option>
	</optgroup>
	<optgroup label="Économique">
    <option value="3">Part des emplois de la sphère présentielle dans l’emploi total </option>
	<option value="4">Nombre d’emplois au lieu de travail</option>
	</optgroup>
	<optgroup label="Occupation du sol - Logement">
    <option value="5">Part des espaces artificialisés sur le territoire communal </option>
	<option value="6">Part des résidences secondaires dans le total des logements </option>
	<option value="7">Composition du parc de logements</option>
	<optgroup label="Fiscalo-financier">
	<option value="8">Part du produit des impôts ménages dans le produit total des impôts locaux du bloc communal </option>
	<option value="9">Part des recettes fiscales dans le produit total de fonctionnement</option>
</select>
	<select name="selection3.1" id="selecteur3" onchange="graphe3(this)" autocomplete="off">
	<option value="1999"> 1999 </option>
	<option value="2010"> 2010 </option>
	<option value="2016"> 2016 </option>
	</select>
	<button id="save3"> Sauvegarder le graphique </button>
	<a style="float: right; margin-right: 4px;" href="../typologie.html" target="_blank">Source des données</a> 
</div>
<div id="div4">
	<div style="width: 87%; margin: 0 auto;">
		<canvas id="canvas4"></canvas>
	</div>
	
	<select name="selection4" id="graphique4" onchange="graphe4(this)" autocomplete="off" style="margin-left: 2%;">
	<option disabled selected value="0"> Données >> </option>
	<optgroup label="Socio-démographique">
    <option value="1">Taux d'évolution annuel de la population</option>
	<option value ="2">Structure par âge de la population</option>
	</optgroup>
	<optgroup label="Économique">
    <option value="3">Part des emplois de la sphère présentielle dans l’emploi total </option>
	<option value="4">Nombre d’emplois au lieu de travail</option>
	</optgroup>
	<optgroup label="Occupation du sol - Logement">
    <option value="5">Part des espaces artificialisés sur le territoire communal </option>
	<option value="6">Part des résidences secondaires dans le total des logements </option>
	<option value="7">Composition du parc de logements</option>
	<optgroup label="Fiscalo-financier">
	<option value="8">Part du produit des impôts ménages dans le produit total des impôts locaux du bloc communal </option>
	<option value="9">Part des recettes fiscales dans le produit total de fonctionnement</option>
</select>
	<select name="selection4.1" id="selecteur4" onchange="graphe4(this)" autocomplete="off">
	<option value="1999"> 1999 </option>
	<option value="2010"> 2010 </option>
	<option value="2016"> 2016 </option>
	</select>
	<button id="save4"> Sauvegarder le graphique </button>
	<a style="float: right; margin-right: 4px;" href="../typologie.html" target="_blank">Source des données</a> 
</div>


	<script>
		var url_c = window.location.href;
		var codecommuneconc = url_c.slice(-5);
		
		var backgroundColor = "#d6eaf8";
		Chart.plugins.register({
		beforeDraw: function(c) {
			var ctx = c.chart.ctx;
			ctx.fillStyle = backgroundColor;
			ctx.fillRect(0, 0, c.chart.width, c.chart.height);
			}
		});
		
		$("#save1").click(function() {
			$("#canvas").get(0).toBlob(function(blob) {
				saveAs(blob, "graphique_"  + nomcom + ".jpg")
			}, "image/jpeg");
		});
		
		$("#save2").click(function() {
			$("#canvas2").get(0).toBlob(function(blob) {
				saveAs(blob, "graphique_"  + nomcom + ".jpg")
			}, "image/jpeg");
		});
		
		$("#save3").click(function() {
			$("#canvas3").get(0).toBlob(function(blob) {
				saveAs(blob, "graphique_"  + nomcom + ".jpg")
			}, "image/jpeg");
		});
		
		$("#save4").click(function() {
			$("#canvas4").get(0).toBlob(function(blob) {
				saveAs(blob, "graphique_"  + nomcom + ".jpg")
			}, "image/jpeg");
		});
		
	</script>
	
	<script>
		document.getElementById("selecteur").style.visibility = "hidden";
		document.getElementById("selecteur2").style.visibility = "hidden";
		document.getElementById("selecteur3").style.visibility = "hidden";
		document.getElementById("selecteur4").style.visibility = "hidden";
		document.getElementById("selection").style.visibility = "hidden";
		document.getElementById("selection2").style.visibility = "hidden";
		document.getElementById("selection3").style.visibility = "hidden";
		document.getElementById("selection4").style.visibility = "hidden";
		function indexdata(codeinsee) { // Fonction pour trouver l'index de la commune dans le tableau de donnéees
			var indexcom_f = "Erreur";
			for( j = 0; j < json_donnees_finales.features.length; j += 1) { // Parcourt le tableau de données pour récupérer l'index de l'entité correspondant au code INSEE
				if(json_donnees_finales.features[j].properties.insee_comm === codeinsee) {
					indexcom_f = j;
				}
			}
			return indexcom_f;
		}

		function graphe1(choix) {	
		//window.myBar.options.scales.yAxes.ticks.max = null;
		document.getElementById("selecteur").style.visibility = "hidden";

		
		
		while (barChartData.datasets.length > 0){
			barChartData.datasets.pop(); 
		}
		
		barChartData.datasets.push({label : nomcom, backgroundColor: window.chartColors.red, stack : 'Stack 0', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData.datasets.push({label : 'Moyenne ' + epci, backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData.datasets.push({label : 'Moyenne ' + depart, backgroundColor: window.chartColors.yellow, stack : 'Stack 2', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData.datasets.push({label : 'Moyenne ' + facade, backgroundColor: window.chartColors.blue, stack : 'Stack 3', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData.datasets.push({label : 'Moyenne France', backgroundColor: window.chartColors.green, stack : 'Stack 4', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});

		window.myBar.options.legend.display = true;
		window.myBar.update();

		
		var valeur_graphe1 = document.getElementById("graphique1"); 
		var choixUti1 = valeur_graphe1.options[valeur_graphe1.selectedIndex].value; // Récupération du choix de l'utilisateur

		switch (choixUti1) { // Calcul des données des graphiques en fonction du choix de l'utilisateur graphique 1
			case '1': // Cas n°1 : données de population 

				////////////// COMMUNE
			
				var pop_com99 = json_donnees_finales.features[indexcom_d].properties.Pop_1999;
				var pop_com10 = json_donnees_finales.features[indexcom_d].properties.Pop_2010;
				var pop_com15 = json_donnees_finales.features[indexcom_d].properties.Pop_2015;
				var evolpop9910 = (((pop_com10-pop_com99)/pop_com99)*100)/11;
				var evolpop1015 = (((pop_com15-pop_com10)/pop_com10)*100)/5;
				var nouvelleData = [evolpop9910.toFixed(2),evolpop1015.toFixed(2)]; // Valeur d'évolution de la population de la commune

				////////////// EPCI

				var pop_epci99 = epci_data.features[indexepci].properties.Pop_1999;
				var pop_epci10 = epci_data.features[indexepci].properties.Pop_2010;
				var pop_epci15 = epci_data.features[indexepci].properties.Pop_2015;
				var evolpopepci9910 = (((pop_epci10-pop_epci99)/pop_epci99)*100)/11;
				var evolpopepci1015 = (((pop_epci15-pop_epci10)/pop_epci10)*100)/5;
				var epci_graphe = [evolpopepci9910.toFixed(2),evolpopepci1015.toFixed(2)]; // Valeur d'évolution de la population de la commune

				
				////////////// DEPARTEMENT
				
				var pop_depart99 = dep_data_t.features[indexdep].properties.Pop_1999;
				var pop_depart10 = dep_data_t.features[indexdep].properties.Pop_2010;
				var pop_depart15 = dep_data_t.features[indexdep].properties.Pop_2015;
				var evolpopdepart9910 = (((pop_depart10-pop_depart99)/pop_depart99)*100)/11;
				var evolpopdepart1015 = (((pop_depart15-pop_depart10)/pop_depart10)*100)/5;
				var depart_data = [evolpopdepart9910.toFixed(2),evolpopdepart1015.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var pop_facade99 = facade_data_t.features[indexfac].properties.Pop_1999;
				var pop_facade10 = facade_data_t.features[indexfac].properties.Pop_2010;
				var pop_facade15 = facade_data_t.features[indexfac].properties.Pop_2015;
				var evolpopfacade9910 = (((pop_facade10-pop_facade99)/pop_facade99)*100)/11;
				var evolpopfacade1015 = (((pop_facade15-pop_facade10)/pop_facade10)*100)/5;
				var facade_data = [evolpopfacade9910.toFixed(2),evolpopfacade1015.toFixed(2)];
				
				
				////////////// FRANCE
				
				var pop_fra99 = france_data_t.features[0].properties.Pop_1999;
				var pop_fra10 = france_data_t.features[0].properties.Pop_2010;
				var pop_fra15 = france_data_t.features[0].properties.Pop_2015;
				var evolpopfra9910 = (((pop_fra10-pop_fra99)/pop_fra99)*100)/11;
				var evolpopfra1015 = (((pop_fra15-pop_fra10)/pop_fra10)*100)/5;
				var fra_data = [evolpopfra9910.toFixed(2),evolpopfra1015.toFixed(2)];
				
				barChartData.datasets[0].data = nouvelleData; // Remplacement des données de base par les données de population 
				barChartData.datasets[1].data = epci_graphe;
				barChartData.datasets[2].data = depart_data;
				barChartData.datasets[3].data = facade_data;
				barChartData.datasets[4].data = fra_data;
				barChartData.labels = ['1999 - 2010', '2010 - 2015'];
				window.myBar.update();
		
				window.myBar.options.title.text = 'Taux d\'évolution annuel de la population (%)';
				barChartData.datasets[0].label = nomcom;
				barChartData.datasets[1].label = "Moyenne " + epci;
				barChartData.datasets[2].label = "Moyenne " + depart;
				window.myBar.update();
				
				
			break;
			
			
			
			
			
			case '2': // Cas n°2 : Structure des âges
			
				while (barChartData.datasets.length > 0 ){
					barChartData.datasets.pop(); 
				}
				
				document.getElementById("selecteur").style.visibility = "visible";
				
				barChartData.datasets.push({label : ' -15 ans', backgroundColor: window.chartColors.red, stack : 'Stack 1', data : [1,1,1,5,5,5,5,5,5,5,5,5]});
				barChartData.datasets.push({label : ' 15 - 29 ans', backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData.datasets.push({label : ' 30 - 44 ans', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData.datasets.push({label : ' 45 - 59 ans', backgroundColor: window.chartColors.blue, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData.datasets.push({label : ' 60 - 74 ans', backgroundColor: window.chartColors.green, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData.datasets.push({label : ' 75 ans et plus', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				
				//////////////// Populations
				
				var pop_com_s_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP;
				var pop_com_s_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP;
				var pop_com_s_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP;
				var pop_epci_s_99 = epci_data.features[indexepci].properties.P99_POP;
				var pop_epci_s_10 = epci_data.features[indexepci].properties.P10_POP;
				var pop_epci_s_16 = epci_data.features[indexepci].properties.P16_POP;
				var pop_dep_s_99 = dep_data_t.features[indexdep].properties.P99_POP;
				var pop_dep_s_10 = dep_data_t.features[indexdep].properties.P10_POP;
				var pop_dep_s_16 = dep_data_t.features[indexdep].properties.P16_POP;
				var pop_fac_s_99 = facade_data_t.features[indexfac].properties.P99_POP;
				var pop_fac_s_10 = facade_data_t.features[indexfac].properties.P10_POP;
				var pop_fac_s_16 = facade_data_t.features[indexfac].properties.P16_POP;
				var pop_fra_s_99 = france_data_t.features[0].properties.P99_POP;
				var pop_fra_s_10 = france_data_t.features[0].properties.P10_POP;
				var pop_fra_s_16 = france_data_t.features[0].properties.P16_POP;
				
				
				
				////////////// Moins de 15 ans 
				
				var moins_15_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP0014;
				var moins_15_epci_99 = epci_data.features[indexepci].properties.P99_POP0014;
				var moins_15_dep_99 = dep_data_t.features[indexdep].properties.P99_POP0014;
				var moins_15_fac_99 = facade_data_t.features[indexfac].properties.P99_POP0014;
				var moins_15_fra_99 = france_data_t.features[0].properties.P99_POP0014;
				var moins_15_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP0014;
				var moins_15_epci_10 = epci_data.features[indexepci].properties.P10_POP0014;
				var moins_15_dep_10 = dep_data_t.features[indexdep].properties.P10_POP0014;
				var moins_15_fac_10 = facade_data_t.features[indexfac].properties.P10_POP0014;
				var moins_15_fra_10 = france_data_t.features[0].properties.P10_POP0014;
				var moins_15_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP0014;
				var moins_15_epci_16 = epci_data.features[indexepci].properties.P16_POP0014;
				var moins_15_dep_16 = dep_data_t.features[indexdep].properties.P16_POP0014;
				var moins_15_fac_16 = facade_data_t.features[indexfac].properties.P16_POP0014;
				var moins_15_fra_16 = france_data_t.features[0].properties.P16_POP0014;
				
				var part_moins_15_com_99 = (moins_15_com_99 / pop_com_s_99) * 100;
				var part_moins_15_epci_99 = (moins_15_epci_99 / pop_epci_s_99) * 100;
				var part_moins_15_dep_99 = (moins_15_dep_99 / pop_dep_s_99) * 100;
				var part_moins_15_fac_99 = (moins_15_fac_99 / pop_fac_s_99) * 100;
				var part_moins_15_fra_99 = (moins_15_fra_99 / pop_fra_s_99) * 100;
				var part_moins_15_com_10 = (moins_15_com_10 / pop_com_s_10) * 100;
				var part_moins_15_epci_10 = (moins_15_epci_10 / pop_epci_s_10) * 100;
				var part_moins_15_dep_10 = (moins_15_dep_10 / pop_dep_s_10) * 100;
				var part_moins_15_fac_10 = (moins_15_fac_10 / pop_fac_s_10) * 100;
				var part_moins_15_fra_10 = (moins_15_fra_10 / pop_fra_s_10) * 100;
				var part_moins_15_com_16 = (moins_15_com_16 / pop_com_s_16) * 100;
				var part_moins_15_epci_16 = (moins_15_epci_16 / pop_epci_s_16) * 100;
				var part_moins_15_dep_16 = (moins_15_dep_16 / pop_dep_s_16) * 100;
				var part_moins_15_fac_16 = (moins_15_fac_16 / pop_fac_s_16) * 100;
				var part_moins_15_fra_16 = (moins_15_fra_16 / pop_fra_s_16) * 100;

				////////////// 15 à 29 ans

				var p_1529_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP1529;
				var p_1529_epci_99 = epci_data.features[indexepci].properties.P99_POP1529;
				var p_1529_dep_99 = dep_data_t.features[indexdep].properties.P99_POP1529;
				var p_1529_fac_99 = facade_data_t.features[indexfac].properties.P99_POP1529;
				var p_1529_fra_99 = france_data_t.features[0].properties.P99_POP1529;
				var p_1529_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP1529;
				var p_1529_epci_10 = epci_data.features[indexepci].properties.P10_POP1529;
				var p_1529_dep_10 = dep_data_t.features[indexdep].properties.P10_POP1529;
				var p_1529_fac_10 = facade_data_t.features[indexfac].properties.P10_POP1529;
				var p_1529_fra_10 = france_data_t.features[0].properties.P10_POP1529;
				var p_1529_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP1529;
				var p_1529_epci_16 = epci_data.features[indexepci].properties.P16_POP1529;
				var p_1529_dep_16 = dep_data_t.features[indexdep].properties.P16_POP1529;
				var p_1529_fac_16 = facade_data_t.features[indexfac].properties.P16_POP1529;
				var p_1529_fra_16 = france_data_t.features[0].properties.P16_POP1529;

				var part_p_1529_com_99 = (p_1529_com_99 / pop_com_s_99) * 100;
				var part_p_1529_epci_99 = (p_1529_epci_99 / pop_epci_s_99) * 100;
				var part_p_1529_dep_99 = (p_1529_dep_99 / pop_dep_s_99) * 100;
				var part_p_1529_fac_99 = (p_1529_fac_99 / pop_fac_s_99) * 100;
				var part_p_1529_fra_99 = (p_1529_fra_99 / pop_fra_s_99) * 100;
				var part_p_1529_com_10 = (p_1529_com_10 / pop_com_s_10) * 100;
				var part_p_1529_epci_10 = (p_1529_epci_10 / pop_epci_s_10) * 100;
				var part_p_1529_dep_10 = (p_1529_dep_10 / pop_dep_s_10) * 100;
				var part_p_1529_fac_10 = (p_1529_fac_10 / pop_fac_s_10) * 100;
				var part_p_1529_fra_10 = (p_1529_fra_10 / pop_fra_s_10) * 100;
				var part_p_1529_com_16 = (p_1529_com_16 / pop_com_s_16) * 100;
				var part_p_1529_epci_16 = (p_1529_epci_16 / pop_epci_s_16) * 100;
				var part_p_1529_dep_16 = (p_1529_dep_16 / pop_dep_s_16) * 100;
				var part_p_1529_fac_16 = (p_1529_fac_16 / pop_fac_s_16) * 100;
				var part_p_1529_fra_16 = (p_1529_fra_16 / pop_fra_s_16) * 100;
				
				
				
				////////////// 30 à 44 ans
				
				var p_3044_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP3044;
				var p_3044_epci_99 = epci_data.features[indexepci].properties.P99_POP3044;
				var p_3044_dep_99 = dep_data_t.features[indexdep].properties.P99_POP3044;
				var p_3044_fac_99 = facade_data_t.features[indexfac].properties.P99_POP3044;
				var p_3044_fra_99 = france_data_t.features[0].properties.P99_POP3044;
				var p_3044_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP3044;
				var p_3044_epci_10 = epci_data.features[indexepci].properties.P10_POP3044;
				var p_3044_dep_10 = dep_data_t.features[indexdep].properties.P10_POP3044;
				var p_3044_fac_10 = facade_data_t.features[indexfac].properties.P10_POP3044;
				var p_3044_fra_10 = france_data_t.features[0].properties.P10_POP3044;
				var p_3044_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP3044;
				var p_3044_epci_16 = epci_data.features[indexepci].properties.P16_POP3044;
				var p_3044_dep_16 = dep_data_t.features[indexdep].properties.P16_POP3044;
				var p_3044_fac_16 = facade_data_t.features[indexfac].properties.P16_POP3044;
				var p_3044_fra_16 = france_data_t.features[0].properties.P16_POP3044;
				
				var part_p_3044_com_99 = (p_3044_com_99 / pop_com_s_99) * 100;
				var part_p_3044_epci_99 = (p_3044_epci_99 / pop_epci_s_99) * 100;
				var part_p_3044_dep_99 = (p_3044_dep_99 / pop_dep_s_99) * 100;
				var part_p_3044_fac_99 = (p_3044_fac_99 / pop_fac_s_99) * 100;
				var part_p_3044_fra_99 = (p_3044_fra_99 / pop_fra_s_99) * 100;
				var part_p_3044_com_10 = (p_3044_com_10 / pop_com_s_10) * 100;
				var part_p_3044_epci_10 = (p_3044_epci_10 / pop_epci_s_10) * 100;
				var part_p_3044_dep_10 = (p_3044_dep_10 / pop_dep_s_10) * 100;
				var part_p_3044_fac_10 = (p_3044_fac_10 / pop_fac_s_10) * 100;
				var part_p_3044_fra_10 = (p_3044_fra_10 / pop_fra_s_10) * 100;
				var part_p_3044_com_16 = (p_3044_com_16 / pop_com_s_16) * 100;
				var part_p_3044_epci_16 = (p_3044_epci_16 / pop_epci_s_16) * 100;
				var part_p_3044_dep_16 = (p_3044_dep_16 / pop_dep_s_16) * 100;
				var part_p_3044_fac_16 = (p_3044_fac_16 / pop_fac_s_16) * 100;
				var part_p_3044_fra_16 = (p_3044_fra_16 / pop_fra_s_16) * 100;
				
				////////////// 45 à 59 ans 
				
				var p_4559_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP4559;
				var p_4559_epci_99 = epci_data.features[indexepci].properties.P99_POP4559;
				var p_4559_dep_99 = dep_data_t.features[indexdep].properties.P99_POP4559;
				var p_4559_fac_99 = facade_data_t.features[indexfac].properties.P99_POP4559;
				var p_4559_fra_99 = france_data_t.features[0].properties.P99_POP4559;
				var p_4559_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP4559;
				var p_4559_epci_10 = epci_data.features[indexepci].properties.P10_POP4559;
				var p_4559_dep_10 = dep_data_t.features[indexdep].properties.P10_POP4559;
				var p_4559_fac_10 = facade_data_t.features[indexfac].properties.P10_POP4559;
				var p_4559_fra_10 = france_data_t.features[0].properties.P10_POP4559;
				var p_4559_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP4559;
				var p_4559_epci_16 = epci_data.features[indexepci].properties.P16_POP4559;
				var p_4559_dep_16 = dep_data_t.features[indexdep].properties.P16_POP4559;
				var p_4559_fac_16 = facade_data_t.features[indexfac].properties.P16_POP4559;
				var p_4559_fra_16 = france_data_t.features[0].properties.P16_POP4559;
				
				var part_p_4559_com_99 = (p_4559_com_99 / pop_com_s_99) * 100;
				var part_p_4559_epci_99 = (p_4559_epci_99 / pop_epci_s_99) * 100;
				var part_p_4559_dep_99 = (p_4559_dep_99 / pop_dep_s_99) * 100;
				var part_p_4559_fac_99 = (p_4559_fac_99 / pop_fac_s_99) * 100;
				var part_p_4559_fra_99 = (p_4559_fra_99 / pop_fra_s_99) * 100;
				var part_p_4559_com_10 = (p_4559_com_10 / pop_com_s_10) * 100;
				var part_p_4559_epci_10 = (p_4559_epci_10 / pop_epci_s_10) * 100;
				var part_p_4559_dep_10 = (p_4559_dep_10 / pop_dep_s_10) * 100;
				var part_p_4559_fac_10 = (p_4559_fac_10 / pop_fac_s_10) * 100;
				var part_p_4559_fra_10 = (p_4559_fra_10 / pop_fra_s_10) * 100;
				var part_p_4559_com_16 = (p_4559_com_16 / pop_com_s_16) * 100;
				var part_p_4559_epci_16 = (p_4559_epci_16 / pop_epci_s_16) * 100;
				var part_p_4559_dep_16 = (p_4559_dep_16 / pop_dep_s_16) * 100;
				var part_p_4559_fac_16 = (p_4559_fac_16 / pop_fac_s_16) * 100;
				var part_p_4559_fra_16 = (p_4559_fra_16 / pop_fra_s_16) * 100;
				
				
				////////////// 60 à 74 ans
				
				var p_6074_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP6074;
				var p_6074_epci_99 = epci_data.features[indexepci].properties.P99_POP6074;
				var p_6074_dep_99 = dep_data_t.features[indexdep].properties.P99_POP6074;
				var p_6074_fac_99 = facade_data_t.features[indexfac].properties.P99_POP6074;
				var p_6074_fra_99 = france_data_t.features[0].properties.P99_POP6074;
				var p_6074_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP6074;
				var p_6074_epci_10 = epci_data.features[indexepci].properties.P10_POP6074;
				var p_6074_dep_10 = dep_data_t.features[indexdep].properties.P10_POP6074;
				var p_6074_fac_10 = facade_data_t.features[indexfac].properties.P10_POP6074;
				var p_6074_fra_10 = france_data_t.features[0].properties.P10_POP6074;
				var p_6074_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP6074;
				var p_6074_epci_16 = epci_data.features[indexepci].properties.P16_POP6074;
				var p_6074_dep_16 = dep_data_t.features[indexdep].properties.P16_POP6074;
				var p_6074_fac_16 = facade_data_t.features[indexfac].properties.P16_POP6074;
				var p_6074_fra_16 = france_data_t.features[0].properties.P16_POP6074;

				var part_p_6074_com_99 = (p_6074_com_99 / pop_com_s_99) * 100;
				var part_p_6074_epci_99 = (p_6074_epci_99 / pop_epci_s_99) * 100;
				var part_p_6074_dep_99 = (p_6074_dep_99 / pop_dep_s_99) * 100;
				var part_p_6074_fac_99 = (p_6074_fac_99 / pop_fac_s_99) * 100;
				var part_p_6074_fra_99 = (p_6074_fra_99 / pop_fra_s_99) * 100;
				var part_p_6074_com_10 = (p_6074_com_10 / pop_com_s_10) * 100;
				var part_p_6074_epci_10 = (p_6074_epci_10 / pop_epci_s_10) * 100;
				var part_p_6074_dep_10 = (p_6074_dep_10 / pop_dep_s_10) * 100;
				var part_p_6074_fac_10 = (p_6074_fac_10 / pop_fac_s_10) * 100;
				var part_p_6074_fra_10 = (p_6074_fra_10 / pop_fra_s_10) * 100;
				var part_p_6074_com_16 = (p_6074_com_16 / pop_com_s_16) * 100;
				var part_p_6074_epci_16 = (p_6074_epci_16 / pop_epci_s_16) * 100;
				var part_p_6074_dep_16 = (p_6074_dep_16 / pop_dep_s_16) * 100;
				var part_p_6074_fac_16 = (p_6074_fac_16 / pop_fac_s_16) * 100;
				var part_p_6074_fra_16 = (p_6074_fra_16 / pop_fra_s_16) * 100;
				
				////////////// 75 ans et plus
				
				var p_75P_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP75P;
				var p_75P_epci_99 = epci_data.features[indexepci].properties.P99_POP75P;
				var p_75P_dep_99 = dep_data_t.features[indexdep].properties.P99_POP75P;
				var p_75P_fac_99 = facade_data_t.features[indexfac].properties.P99_POP75P;
				var p_75P_fra_99 = france_data_t.features[0].properties.P99_POP75P;
				var p_75P_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP75P;
				var p_75P_epci_10 = epci_data.features[indexepci].properties.P10_POP75P;
				var p_75P_dep_10 = dep_data_t.features[indexdep].properties.P10_POP75P;
				var p_75P_fac_10 = facade_data_t.features[indexfac].properties.P10_POP75P;
				var p_75P_fra_10 = france_data_t.features[0].properties.P10_POP75P;
				var p_75P_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP75P;
				var p_75P_epci_16 = epci_data.features[indexepci].properties.P16_POP75P;
				var p_75P_dep_16 = dep_data_t.features[indexdep].properties.P16_POP75P;
				var p_75P_fac_16 = facade_data_t.features[indexfac].properties.P16_POP75P;
				var p_75P_fra_16 = france_data_t.features[0].properties.P16_POP75P;
				
				var part_p_75P_com_99 = (p_75P_com_99 / pop_com_s_99) * 100;
				var part_p_75P_epci_99 = (p_75P_epci_99 / pop_epci_s_99) * 100;
				var part_p_75P_dep_99 = (p_75P_dep_99 / pop_dep_s_99) * 100;
				var part_p_75P_fac_99 = (p_75P_fac_99 / pop_fac_s_99) * 100;
				var part_p_75P_fra_99 = (p_75P_fra_99 / pop_fra_s_99) * 100;
				var part_p_75P_com_10 = (p_75P_com_10 / pop_com_s_10) * 100;
				var part_p_75P_epci_10 = (p_75P_epci_10 / pop_epci_s_10) * 100;
				var part_p_75P_dep_10 = (p_75P_dep_10 / pop_dep_s_10) * 100;
				var part_p_75P_fac_10 = (p_75P_fac_10 / pop_fac_s_10) * 100;
				var part_p_75P_fra_10 = (p_75P_fra_10 / pop_fra_s_10) * 100;
				var part_p_75P_com_16 = (p_75P_com_16 / pop_com_s_16) * 100;
				var part_p_75P_epci_16 = (p_75P_epci_16 / pop_epci_s_16) * 100;
				var part_p_75P_dep_16 = (p_75P_dep_16 / pop_dep_s_16) * 100;
				var part_p_75P_fac_16 = (p_75P_fac_16 / pop_fac_s_16) * 100;
				var part_p_75P_fra_16 = (p_75P_fra_16 / pop_fra_s_16) * 100;
	
				var anneechoisie = document.getElementById("selecteur");
				var anneestruct = anneechoisie.options[anneechoisie.selectedIndex].value;
	
				switch (anneestruct) {
				
				case '1999' : 
					barChartData.datasets[0].data = [part_moins_15_com_99.toFixed(2),part_moins_15_epci_99.toFixed(2),part_moins_15_dep_99.toFixed(2),part_moins_15_fac_99.toFixed(2),part_moins_15_fra_99.toFixed(2)];
					barChartData.datasets[1].data = [part_p_1529_com_99.toFixed(2),part_p_1529_epci_99.toFixed(2),part_p_1529_dep_99.toFixed(2),part_p_1529_fac_99.toFixed(2),part_p_1529_fra_99.toFixed(2)];
					barChartData.datasets[2].data = [part_p_3044_com_99.toFixed(2),part_p_3044_epci_99.toFixed(2),part_p_3044_dep_99.toFixed(2),part_p_3044_fac_99.toFixed(2),part_p_3044_fra_99.toFixed(2)];
					barChartData.datasets[3].data = [part_p_4559_com_99.toFixed(2),part_p_4559_epci_99.toFixed(2),part_p_4559_dep_99.toFixed(2),part_p_4559_fac_99.toFixed(2),part_p_4559_fra_99.toFixed(2)];
					barChartData.datasets[4].data = [part_p_6074_com_99.toFixed(2),part_p_6074_epci_99.toFixed(2),part_p_6074_dep_99.toFixed(2),part_p_6074_fac_99.toFixed(2),part_p_6074_fra_99.toFixed(2)];
					barChartData.datasets[5].data = [part_p_75P_com_99.toFixed(2),part_p_75P_epci_99.toFixed(2),part_p_75P_dep_99.toFixed(2),part_p_75P_fac_99.toFixed(2),part_p_75P_fra_99.toFixed(2)];
				window.myBar.options.title.text = 'Structure par âge de la population en 1999 (part en %)';
				break;
				
				case '2010' : 
					barChartData.datasets[0].data = [part_moins_15_com_10.toFixed(2),part_moins_15_epci_10.toFixed(2),part_moins_15_dep_10.toFixed(2),part_moins_15_fac_10.toFixed(2),part_moins_15_fra_10.toFixed(2)];
					barChartData.datasets[1].data = [part_p_1529_com_10.toFixed(2),part_p_1529_epci_10.toFixed(2),part_p_1529_dep_10.toFixed(2),part_p_1529_fac_10.toFixed(2),part_p_1529_fra_10.toFixed(2)];
					barChartData.datasets[2].data = [part_p_3044_com_10.toFixed(2),part_p_3044_epci_10.toFixed(2),part_p_3044_dep_10.toFixed(2),part_p_3044_fac_10.toFixed(2),part_p_3044_fra_10.toFixed(2)];
					barChartData.datasets[3].data = [part_p_4559_com_10.toFixed(2),part_p_4559_epci_10.toFixed(2),part_p_4559_dep_10.toFixed(2),part_p_4559_fac_10.toFixed(2),part_p_4559_fra_10.toFixed(2)];
					barChartData.datasets[4].data = [part_p_6074_com_10.toFixed(2),part_p_6074_epci_10.toFixed(2),part_p_6074_dep_10.toFixed(2),part_p_6074_fac_10.toFixed(2),part_p_6074_fra_10.toFixed(2)];
					barChartData.datasets[5].data = [part_p_75P_com_10.toFixed(2),part_p_75P_epci_10.toFixed(2),part_p_75P_dep_10.toFixed(2),part_p_75P_fac_10.toFixed(2),part_p_75P_fra_10.toFixed(2)];
				window.myBar.options.title.text = 'Structure par âge de la population en 2010 (part en %)';
				break;
						
				case '2016' : 
				barChartData.datasets[0].data = [part_moins_15_com_16.toFixed(2),part_moins_15_epci_16.toFixed(2),part_moins_15_dep_16.toFixed(2),part_moins_15_fac_16.toFixed(2),part_moins_15_fra_16.toFixed(2)];
					barChartData.datasets[1].data = [part_p_1529_com_16.toFixed(2),part_p_1529_epci_16.toFixed(2),part_p_1529_dep_16.toFixed(2),part_p_1529_fac_16.toFixed(2),part_p_1529_fra_16.toFixed(2)];
					barChartData.datasets[2].data = [part_p_3044_com_16.toFixed(2),part_p_3044_epci_16.toFixed(2),part_p_3044_dep_16.toFixed(2),part_p_3044_fac_16.toFixed(2),part_p_3044_fra_16.toFixed(2)];
					barChartData.datasets[3].data = [part_p_4559_com_16.toFixed(2),part_p_4559_epci_16.toFixed(2),part_p_4559_dep_16.toFixed(2),part_p_4559_fac_16.toFixed(2),part_p_4559_fra_16.toFixed(2)];
					barChartData.datasets[4].data = [part_p_6074_com_16.toFixed(2),part_p_6074_epci_16.toFixed(2),part_p_6074_dep_16.toFixed(2),part_p_6074_fac_16.toFixed(2),part_p_6074_fra_16.toFixed(2)];
					barChartData.datasets[5].data = [part_p_75P_com_16.toFixed(2),part_p_75P_epci_16.toFixed(2),part_p_75P_dep_16.toFixed(2),part_p_75P_fac_16.toFixed(2),part_p_75P_fra_16.toFixed(2)];
				window.myBar.options.title.text = 'Structure par âge de la population en 2016 (part en %)';
				break;
				
			}



				barChartData.labels = [nomcom,['',epci],depart,['',facade],'France'];
				window.myBar.update();
		
				//window.myBar.options.title.text = 'Structure par âge de la population (part en %)';
				window.myBar.update();

			break;
			
			
			
			
			
			
			
			case '3': // Part de l'emploi présentiel
			
				////////////// COMMUNE
			
				var nouvelleData = [json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_1999,json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_2009,json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_2014]; 
			
				////////////// EPCI

				var emp_t_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_1999;
				var emp_r_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_2009;
				var emp_r_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_2014;
				var prt_em_epci99 = (emp_r_epci_99/emp_t_epci_99)*100;
				var prt_em_epci09 = (emp_r_epci_09/emp_t_epci_09)*100;
				var prt_em_epci14 = (emp_r_epci_14/emp_t_epci_14)*100;
				var epci_graphe = [prt_em_epci99.toFixed(2),prt_em_epci09.toFixed(2),prt_em_epci14.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var emp_t_depart_99 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_depart_09 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_depart_14 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_depart_99 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_1999;
				var emp_r_depart_09 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_2009;
				var emp_r_depart_14 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_2014;
				var prt_em_depart99 = (emp_r_depart_99/emp_t_depart_99)*100;
				var prt_em_depart09 = (emp_r_depart_09/emp_t_depart_09)*100;
				var prt_em_depart14 = (emp_r_depart_14/emp_t_depart_14)*100;
				var depart_data = [prt_em_depart99.toFixed(2),prt_em_depart09.toFixed(2),prt_em_depart14.toFixed(2)]; 
				
				////////////// FACADE LITTORALE 
				
				var emp_t_facade_99 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_facade_09 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_facade_14 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_facade_99 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_1999;
				var emp_r_facade_09 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_2009;
				var emp_r_facade_14 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_2014;
				var prt_em_facade99 = (emp_r_facade_99/emp_t_facade_99)*100;
				var prt_em_facade09 = (emp_r_facade_09/emp_t_facade_09)*100;
				var prt_em_facade14 = (emp_r_facade_14/emp_t_facade_14)*100;
				var facade_data = [prt_em_facade99.toFixed(2),prt_em_facade09.toFixed(2),prt_em_facade14.toFixed(2)]; 
				
				
				////////////// FRANCE
				
				var emp_t_fra_99 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fra_09 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fra_14 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_fra_99 = france_data_t.features[0].properties.Nb_emploi_résidentiel_1999;
				var emp_r_fra_09 = france_data_t.features[0].properties.Nb_emploi_résidentiel_2009;
				var emp_r_fra_14 = france_data_t.features[0].properties.Nb_emploi_résidentiel_2014;
				var prt_em_fra99 = (emp_r_fra_99/emp_t_fra_99)*100;
				var prt_em_fra09 = (emp_r_fra_09/emp_t_fra_09)*100;
				var prt_em_fra14 = (emp_r_fra_14/emp_t_fra_14)*100;
				var fra_data = [prt_em_fra99.toFixed(2),prt_em_fra09.toFixed(2),prt_em_fra14.toFixed(2)]; 
				
				barChartData.datasets[0].data = nouvelleData;  
				barChartData.datasets[1].data = epci_graphe;
				barChartData.datasets[2].data = depart_data;
				barChartData.datasets[3].data = facade_data;
				barChartData.datasets[4].data = fra_data;
				barChartData.labels = ['1999', '2009', '2014'];
				window.myBar.update();
		
				window.myBar.options.title.text = 'Part des emplois de la sphère résidentielle dans l\'emploi total (%)';
				barChartData.datasets[0].label = nomcom;
				barChartData.datasets[1].label = "Moyenne " + epci;
				barChartData.datasets[2].label = "Moyenne " + depart;
				window.myBar.update();
			
			
			break;
			
			
			
			
			
			
			
			case '4': // Nombre d'emplois au lieu de travail
				////////////// COMMUNE
			
				var pop_com99 = json_donnees_finales.features[indexcom_d].properties.Pop_1999;
				var pop_com10 = json_donnees_finales.features[indexcom_d].properties.Pop_2010;
				var pop_com15 = json_donnees_finales.features[indexcom_d].properties.Pop_2015;
				var emp_t_com_99 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_com_09 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_com_14 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_com99 = (emp_t_com_99/pop_com99);
				var em_ph_com09 = (emp_t_com_09/pop_com10);
				var em_ph_com14 = (emp_t_com_14/pop_com15);
				var nouvelleData = [em_ph_com99.toFixed(2),em_ph_com09.toFixed(2),em_ph_com14.toFixed(2)]; 

				////////////// EPCI

				var pop_epci99 = epci_data.features[indexepci].properties.Pop_1999;
				var pop_epci10 = epci_data.features[indexepci].properties.Pop_2010;
				var pop_epci15 = epci_data.features[indexepci].properties.Pop_2015;
				var emp_t_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_epci99 = (emp_t_epci_99/pop_epci99);
				var em_ph_epci09 = (emp_t_epci_09/pop_epci10);
				var em_ph_epci14 = (emp_t_epci_14/pop_epci15);
				var epci_graphe = [em_ph_epci99.toFixed(2),em_ph_epci09.toFixed(2),em_ph_epci14.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var pop_dep99 = dep_data_t.features[indexdep].properties.Pop_1999;
				var pop_dep10 = dep_data_t.features[indexdep].properties.Pop_2010;
				var pop_dep15 = dep_data_t.features[indexdep].properties.Pop_2015;
				var emp_t_dep_99 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_dep_09 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_dep_14 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_dep99 = (emp_t_dep_99/pop_dep99);
				var em_ph_dep09 = (emp_t_dep_09/pop_dep10);
				var em_ph_dep14 = (emp_t_dep_14/pop_dep15);
				var depart_data = [em_ph_dep99.toFixed(2),em_ph_dep09.toFixed(2),em_ph_dep14.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var pop_fac99 = facade_data_t.features[indexfac].properties.Pop_1999;
				var pop_fac10 = facade_data_t.features[indexfac].properties.Pop_2010;
				var pop_fac15 = facade_data_t.features[indexfac].properties.Pop_2015;
				var emp_t_fac_99 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fac_09 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fac_14 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_fac99 = (emp_t_fac_99/pop_fac99);
				var em_ph_fac09 = (emp_t_fac_09/pop_fac10);
				var em_ph_fac14 = (emp_t_fac_14/pop_fac15);
				var facade_data = [em_ph_fac99.toFixed(2),em_ph_fac09.toFixed(2),em_ph_fac14.toFixed(2)];
				
				
				////////////// FRANCE
				
				var pop_fra99 = france_data_t.features[0].properties.Pop_1999;
				var pop_fra10 = france_data_t.features[0].properties.Pop_2010;
				var pop_fra15 = france_data_t.features[0].properties.Pop_2015;
				var emp_t_fra_99 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fra_09 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fra_14 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_fra99 = (emp_t_fra_99/pop_fra99);
				var em_ph_fra09 = (emp_t_fra_09/pop_fra10);
				var em_ph_fra14 = (emp_t_fra_14/pop_fra15);
				var fra_data = [em_ph_fra99.toFixed(2),em_ph_fra09.toFixed(2),em_ph_fra14.toFixed(2)];
				
				barChartData.datasets[0].data = nouvelleData; 
				barChartData.datasets[1].data = epci_graphe;
				barChartData.datasets[2].data = depart_data;
				barChartData.datasets[3].data = facade_data;
				barChartData.datasets[4].data = fra_data;
				barChartData.labels = ['1999', '2009', '2014'];
				window.myBar.update();
		
				window.myBar.options.title.text = 'Nombre d\'emplois au lieu de travail (emplois/hab)';
				barChartData.datasets[0].label = nomcom;
				barChartData.datasets[1].label = "Moyenne " + epci;
				barChartData.datasets[2].label = "Moyenne " + depart;
				window.myBar.update();
						
			
			
			break;
			
			
			
			
			
			
			
			case '5': // Artificialisation
				
				////////////// COMMUNE
			
				var artif_com00 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2000;
				var artif_com06 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2006;
				var artif_com12 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2012;
				var surf_com = json_donnees_finales.features[indexcom_d].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_com00 = (artif_com00/surf_com)*100;
				var prct_artif_com06 = (artif_com06/surf_com)*100;
				var prct_artif_com12 = (artif_com12/surf_com)*100;
				var nouvelleData = [prct_artif_com00.toFixed(2),prct_artif_com06.toFixed(2),prct_artif_com12.toFixed(2)]; 

				////////////// EPCI

				var artif_epci00 = epci_data.features[indexepci].properties.SURF_ARTIF_2000;
				var artif_epci06 = epci_data.features[indexepci].properties.SURF_ARTIF_2006;
				var artif_epci12 = epci_data.features[indexepci].properties.SURF_ARTIF_2012;
				var surf_epci = epci_data.features[indexepci].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_epci00 = (artif_epci00/surf_epci)*100;
				var prct_artif_epci06 = (artif_epci06/surf_epci)*100;
				var prct_artif_epci12 = (artif_epci12/surf_epci)*100;
				var epci_graphe = [prct_artif_epci00.toFixed(2),prct_artif_epci06.toFixed(2),prct_artif_epci12.toFixed(2)]; // Valeur d'évolution de la population de la commune

				
				////////////// DEPARTEMENT
				
				var artif_dep00 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2000;
				var artif_dep06 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2006;
				var artif_dep12 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2012;
				var surf_dep = dep_data_t.features[indexdep].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_dep00 = (artif_dep00/surf_dep)*100;
				var prct_artif_dep06 = (artif_dep06/surf_dep)*100;
				var prct_artif_dep12 = (artif_dep12/surf_dep)*100;
				var depart_data = [prct_artif_dep00.toFixed(2),prct_artif_dep06.toFixed(2),prct_artif_dep12.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var artif_fac00 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2000;
				var artif_fac06 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2006;
				var artif_fac12 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2012;
				var surf_fac = facade_data_t.features[indexfac].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_fac00 = (artif_fac00/surf_fac)*100;
				var prct_artif_fac06 = (artif_fac06/surf_fac)*100;
				var prct_artif_fac12 = (artif_fac12/surf_fac)*100;
				var facade_data = [prct_artif_fac00.toFixed(2),prct_artif_fac06.toFixed(2),prct_artif_fac12.toFixed(2)];
				
				
				////////////// FRANCE
				
				var artif_fra00 = france_data_t.features[0].properties.SURF_ARTIF_2000;
				var artif_fra06 = france_data_t.features[0].properties.SURF_ARTIF_2006;
				var artif_fra12 = france_data_t.features[0].properties.SURF_ARTIF_2012;
				var surf_fra = france_data_t.features[0].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_fra00 = (artif_fra00/surf_fra)*100;
				var prct_artif_fra06 = (artif_fra06/surf_fra)*100;
				var prct_artif_fra12 = (artif_fra12/surf_fra)*100;
				var fra_data = [prct_artif_fra00.toFixed(2),prct_artif_fra06.toFixed(2),prct_artif_fra12.toFixed(2)];
				
				barChartData.datasets[0].data = nouvelleData; 
				barChartData.datasets[1].data = epci_graphe;
				barChartData.datasets[2].data = depart_data;
				barChartData.datasets[3].data = facade_data;
				barChartData.datasets[4].data = fra_data;
				barChartData.labels = ['2000', '2006', '2012'];
				window.myBar.update();
		
				window.myBar.options.title.text = 'Part des espaces artificialisés sur le territoire communal (%)';
				barChartData.datasets[0].label = nomcom;
				barChartData.datasets[1].label = "Moyenne " + epci;
				barChartData.datasets[2].label = "Moyenne " + depart;
				window.myBar.update();
			
			break;
			
			
			
			
			
			
			
			case '6': // Part des résidences secondaires
			
				////////////// COMMUNE
			
				var nb_log_com99 = sec_com.features[indexcom_r].properties.NB_LOG_1999;
				var nb_log_com11 = sec_com.features[indexcom_r].properties.NB_LOG_2011;
				var nb_log_com16 = sec_com.features[indexcom_r].properties.NB_LOG_2016;
				var nb_sec_com99 = sec_com.features[indexcom_r].properties.NB_SEC_1999;
				var nb_sec_com11 = sec_com.features[indexcom_r].properties.NB_SEC_2011;
				var nb_sec_com16 = sec_com.features[indexcom_r].properties.NB_SEC_2016;	
				var prct_sec_com_99 = (nb_sec_com99 / nb_log_com99 ) * 100;
				var prct_sec_com_11 = (nb_sec_com11 / nb_log_com11 ) * 100;
				var prct_sec_com_16 = (nb_sec_com16 / nb_log_com16 ) * 100;
				var nouvelleData = [prct_sec_com_99.toFixed(2),prct_sec_com_11.toFixed(2),prct_sec_com_16.toFixed(2)];

				////////////// EPCI

				var nb_log_epci99 = sec_epci.features[indexepci_r].properties.NB_LOG_1999;
				var nb_log_epci11 = sec_epci.features[indexepci_r].properties.NB_LOG_2011;
				var nb_log_epci16 = sec_epci.features[indexepci_r].properties.NB_LOG_2016;
				var nb_sec_epci99 = sec_epci.features[indexepci_r].properties.NB_SEC_1999;
				var nb_sec_epci11 = sec_epci.features[indexepci_r].properties.NB_SEC_2011;
				var nb_sec_epci16 = sec_epci.features[indexepci_r].properties.NB_SEC_2016;	
				var prct_sec_epci_99 = (nb_sec_epci99 / nb_log_epci99 ) * 100;
				var prct_sec_epci_11 = (nb_sec_epci11 / nb_log_epci11 ) * 100;
				var prct_sec_epci_16 = (nb_sec_epci16 / nb_log_epci16 ) * 100;
				var epci_graphe = [prct_sec_epci_99.toFixed(2),prct_sec_epci_11.toFixed(2),prct_sec_epci_16.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var nb_log_dep99 = sec_dep.features[indexdep_r].properties.NB_LOG_1999;
				var nb_log_dep11 = sec_dep.features[indexdep_r].properties.NB_LOG_2011;
				var nb_log_dep16 = sec_dep.features[indexdep_r].properties.NB_LOG_2016;
				var nb_sec_dep99 = sec_dep.features[indexdep_r].properties.NB_SEC_1999;
				var nb_sec_dep11 = sec_dep.features[indexdep_r].properties.NB_SEC_2011;
				var nb_sec_dep16 = sec_dep.features[indexdep_r].properties.NB_SEC_2016;	
				var prct_sec_dep_99 = (nb_sec_dep99 / nb_log_dep99 ) * 100;
				var prct_sec_dep_11 = (nb_sec_dep11 / nb_log_dep11 ) * 100;
				var prct_sec_dep_16 = (nb_sec_dep16 / nb_log_dep16 ) * 100;
				var depart_data = [prct_sec_dep_99.toFixed(2),prct_sec_dep_11.toFixed(2),prct_sec_dep_16.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var nb_log_fac99 = sec_fac.features[indexfac_r].properties.NB_LOG_1999;
				var nb_log_fac11 = sec_fac.features[indexfac_r].properties.NB_LOG_2011;
				var nb_log_fac16 = sec_fac.features[indexfac_r].properties.NB_LOG_2016;
				var nb_sec_fac99 = sec_fac.features[indexfac_r].properties.NB_SEC_1999;
				var nb_sec_fac11 = sec_fac.features[indexfac_r].properties.NB_SEC_2011;
				var nb_sec_fac16 = sec_fac.features[indexfac_r].properties.NB_SEC_2016;	
				var prct_sec_fac_99 = (nb_sec_fac99 / nb_log_fac99 ) * 100;
				var prct_sec_fac_11 = (nb_sec_fac11 / nb_log_fac11 ) * 100;
				var prct_sec_fac_16 = (nb_sec_fac16 / nb_log_fac16 ) * 100;
				var facade_data = [prct_sec_fac_99.toFixed(2),prct_sec_fac_11.toFixed(2),prct_sec_fac_16.toFixed(2)];
				
				
				////////////// FRANCE
				
				var nb_log_fra99 = sec_fra.features[0].properties.NB_LOG_1999;
				var nb_log_fra11 = sec_fra.features[0].properties.NB_LOG_2011;
				var nb_log_fra16 = sec_fra.features[0].properties.NB_LOG_2016;
				var nb_sec_fra99 = sec_fra.features[0].properties.NB_SEC_1999;
				var nb_sec_fra11 = sec_fra.features[0].properties.NB_SEC_2011;
				var nb_sec_fra16 = sec_fra.features[0].properties.NB_SEC_2016;	
				var prct_sec_fra_99 = (nb_sec_fra99 / nb_log_fra99 ) * 100;
				var prct_sec_fra_11 = (nb_sec_fra11 / nb_log_fra11 ) * 100;
				var prct_sec_fra_16 = (nb_sec_fra16 / nb_log_fra16 ) * 100;
				var fra_data = [prct_sec_fra_99.toFixed(2),prct_sec_fra_11.toFixed(2),prct_sec_fra_16.toFixed(2)];
				
				barChartData.datasets[0].data = nouvelleData; 
				barChartData.datasets[1].data = epci_graphe;
				barChartData.datasets[2].data = depart_data;
				barChartData.datasets[3].data = facade_data;
				barChartData.datasets[4].data = fra_data;
				barChartData.labels = ['1999', '2011', '2016'];
				window.myBar.update();
		
				window.myBar.options.title.text = 'Part des résidences secondaires dans le total des logements (%)';
				barChartData.datasets[0].label = nomcom;
				barChartData.datasets[1].label = "Moyenne " + epci;
				barChartData.datasets[2].label = "Moyenne " + depart;
				window.myBar.update();
						
			
			
			break;
			
			
			
			
			
			
			
			
			case '7': // Composition parc de logements
			
					while (barChartData.datasets.length > 0 ){
						barChartData.datasets.pop(); 
					}
			
			
				barChartData.datasets.push({label : ' Maison avant 1991 ', backgroundColor: window.chartColors.green, stack : 'Stack 1', data : [1,1,1,2,1]});
				barChartData.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [3,1,2,2,1]});
				barChartData.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.blue, stack : 'Stack 1', data : [3,1,2,3,1]});
				barChartData.datasets.push({label : ' Appartement avant 1991 ', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.grey, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData.datasets.push({label : ' Autre avant 1991 ', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,4,3]});
				barChartData.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.grey, stack : 'Stack 1', data : [3,1,2,2,3]});
				barChartData.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,2,2]});


				////////////// Maison avant 1991

				var m_av_91_com = json_donnees_finales.features[indexcom_d].properties.MAISON_AVT91;
				var m_av_91_epci = epci_data.features[indexepci].properties.MAISON_AVT91;
				var m_av_91_dep = dep_data_t.features[indexdep].properties.MAISON_AVT91;
				var m_av_91_fac = facade_data_t.features[indexfac].properties.MAISON_AVT91;
				var m_av_91_fra = france_data_t.features[0].properties.MAISON_AVT91;


				////////////// Maison 1991 - 2005

				var m_9105_com = json_donnees_finales.features[indexcom_d].properties.MAISON_9105;
				var m_9105_epci = epci_data.features[indexepci].properties.MAISON_9105;
				var m_9105_dep = dep_data_t.features[indexdep].properties.MAISON_9105;
				var m_9105_fac = facade_data_t.features[indexfac].properties.MAISON_9105;
				var m_9105_fra = france_data_t.features[0].properties.MAISON_9105;

				////////////// Maison 2006 - 2013
	
				var m_0613_com = json_donnees_finales.features[indexcom_d].properties.MAISON_0613;
				var m_0613_epci = epci_data.features[indexepci].properties.MAISON_0613;
				var m_0613_dep = dep_data_t.features[indexdep].properties.MAISON_0613;
				var m_0613_fac = facade_data_t.features[indexfac].properties.MAISON_0613;
				var m_0613_fra = france_data_t.features[0].properties.MAISON_0613;
				
				////////////// Appartement avant 1991

				var ap_av_91_com = json_donnees_finales.features[indexcom_d].properties.APPART_AVT91;
				var ap_av_91_epci = epci_data.features[indexepci].properties.APPART_AVT91;
				var ap_av_91_dep = dep_data_t.features[indexdep].properties.APPART_AVT91;
				var ap_av_91_fac = facade_data_t.features[indexfac].properties.APPART_AVT91;
				var ap_av_91_fra = france_data_t.features[0].properties.APPART_AVT91;

				////////////// Appartement 1991 - 2005

				var ap_9105_com = json_donnees_finales.features[indexcom_d].properties.APPART_9105;
				var ap_9105_epci = epci_data.features[indexepci].properties.APPART_9105;
				var ap_9105_dep = dep_data_t.features[indexdep].properties.APPART_9105;
				var ap_9105_fac = facade_data_t.features[indexfac].properties.APPART_9105;
				var ap_9105_fra = france_data_t.features[0].properties.APPART_9105;


				////////////// Appartement 2006 - 2013
				
				var ap_0613_com = json_donnees_finales.features[indexcom_d].properties.APPART_0613;
				var ap_0613_epci = epci_data.features[indexepci].properties.APPART_0613;
				var ap_0613_dep = dep_data_t.features[indexdep].properties.APPART_0613;
				var ap_0613_fac = facade_data_t.features[indexfac].properties.APPART_0613;
				var ap_0613_fra = france_data_t.features[0].properties.APPART_0613;		
				
				
				////////////// Autre avant 1991
				
				var au_av_91_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_AVT91;
				var au_av_91_epci = epci_data.features[indexepci].properties.AUTRE_AVT91;
				var au_av_91_dep = dep_data_t.features[indexdep].properties.AUTRE_AVT91;
				var au_av_91_fac = facade_data_t.features[indexfac].properties.AUTRE_AVT91;
				var au_av_91_fra = france_data_t.features[0].properties.AUTRE_AVT91;
				
				
				////////////// Autre 1991 - 2005

				var au_9105_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_9105;
				var au_9105_epci = epci_data.features[indexepci].properties.AUTRE_9105;
				var au_9105_dep = dep_data_t.features[indexdep].properties.AUTRE_9105;
				var au_9105_fac = facade_data_t.features[indexfac].properties.AUTRE_9105;
				var au_9105_fra = france_data_t.features[0].properties.AUTRE_9105;


				////////////// Autre 2006 - 2013		

				var au_0613_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_0613;
				var au_0613_epci = epci_data.features[indexepci].properties.AUTRE_0613;
				var au_0613_dep = dep_data_t.features[indexdep].properties.AUTRE_0613;
				var au_0613_fac = facade_data_t.features[indexfac].properties.AUTRE_0613;
				var au_0613_fra = france_data_t.features[0].properties.AUTRE_0613;

				///////////// Nombre de logements 
				
				var nb_log_com = m_av_91_com + m_9105_com + m_0613_com + ap_av_91_com + ap_9105_com + ap_0613_com, au_av_91_com, au_9105_com, au_0613_com;
				var nb_log_epci = m_av_91_epci + m_9105_epci + m_0613_epci + ap_av_91_epci + ap_9105_epci + ap_0613_epci, au_av_91_epci, au_9105_epci, au_0613_epci;
				var nb_log_dep = m_av_91_dep + m_9105_dep + m_0613_dep + ap_av_91_dep + ap_9105_dep + ap_0613_dep, au_av_91_dep, au_9105_dep, au_0613_dep;
				var nb_log_fac = m_av_91_fac + m_9105_fac + m_0613_fac + ap_av_91_fac + ap_9105_fac + ap_0613_fac, au_av_91_fac, au_9105_fac, au_0613_fac;
				var nb_log_fra = m_av_91_fra + m_9105_fra + m_0613_fra + ap_av_91_fra + ap_9105_fra + ap_0613_fra, au_av_91_fra, au_9105_fra, au_0613_fra;

				//////////// Pourcentages maison avant 91 
				
				var p_m_av_91_com = (m_av_91_com / nb_log_com) * 100;
				var p_m_av_91_epci = (m_av_91_epci / nb_log_epci) * 100;
				var p_m_av_91_dep = (m_av_91_dep / nb_log_dep) * 100;
				var p_m_av_91_fac = (m_av_91_fac / nb_log_fac) * 100;
				var p_m_av_91_fra = (m_av_91_fra / nb_log_fra) * 100;
				
				barChartData.datasets[0].data = [p_m_av_91_com.toFixed(2),p_m_av_91_epci.toFixed(2),p_m_av_91_dep.toFixed(2),p_m_av_91_fac.toFixed(2),p_m_av_91_fra.toFixed(2)];

				//////////// Pourcentages maison 1991 - 2005 
				
				var p_m_9105_com = (m_9105_com / nb_log_com) * 100;
				var p_m_9105_epci = (m_9105_epci / nb_log_epci) * 100;
				var p_m_9105_dep = (m_9105_dep / nb_log_dep) * 100;
				var p_m_9105_fac = (m_9105_fac / nb_log_fac) * 100;
				var p_m_9105_fra = (m_9105_fra / nb_log_fra) * 100;
				
				barChartData.datasets[1].data = [p_m_9105_com.toFixed(2),p_m_9105_epci.toFixed(2),p_m_9105_dep.toFixed(2),p_m_9105_fac.toFixed(2),p_m_9105_fra.toFixed(2)];

				//////////// Pourcentages maison 2006 - 2013
				
				var p_m_0613_com = (m_0613_com / nb_log_com) * 100;
				var p_m_0613_epci = (m_0613_epci / nb_log_epci) * 100;
				var p_m_0613_dep = (m_0613_dep / nb_log_dep) * 100;
				var p_m_0613_fac = (m_0613_fac / nb_log_fac) * 100;
				var p_m_0613_fra = (m_0613_fra / nb_log_fra) * 100;
				
				barChartData.datasets[2].data = [p_m_0613_com.toFixed(2),p_m_0613_epci.toFixed(2),p_m_0613_dep.toFixed(2),p_m_0613_fac.toFixed(2),p_m_0613_fra.toFixed(2)];

				//////////// Pourcentages appartement avant 1991

				var p_ap_av_91_com = (ap_av_91_com / nb_log_com) * 100;
				var p_ap_av_91_epci = (ap_av_91_epci / nb_log_epci) * 100;
				var p_ap_av_91_dep = (ap_av_91_dep / nb_log_dep) * 100;
				var p_ap_av_91_fac = (ap_av_91_fac / nb_log_fac) * 100;
				var p_ap_av_91_fra = (ap_av_91_fra / nb_log_fra) * 100;
				
				barChartData.datasets[3].data = [p_ap_av_91_com.toFixed(2),p_ap_av_91_epci.toFixed(2),p_ap_av_91_dep.toFixed(2),p_ap_av_91_fac.toFixed(2),p_ap_av_91_fra.toFixed(2)];

				//////////// Pourcentages appartement 1991 - 2005 
				
				var p_ap_9105_com = (ap_9105_com / nb_log_com) * 100;
				var p_ap_9105_epci = (ap_9105_epci / nb_log_epci) * 100;
				var p_ap_9105_dep = (ap_9105_dep / nb_log_dep) * 100;
				var p_ap_9105_fac = (ap_9105_fac / nb_log_fac) * 100;
				var p_ap_9105_fra = (ap_9105_fra / nb_log_fra) * 100;
				
				barChartData.datasets[4].data = [p_ap_9105_com.toFixed(2),p_ap_9105_epci.toFixed(2),p_ap_9105_dep.toFixed(2),p_ap_9105_fac.toFixed(2),p_ap_9105_fra.toFixed(2)];

				//////////// Pourcentages appartement 2006 - 2013
				
				var p_ap_0613_com = (ap_0613_com / nb_log_com) * 100;
				var p_ap_0613_epci = (ap_0613_epci / nb_log_epci) * 100;
				var p_ap_0613_dep = (ap_0613_dep / nb_log_dep) * 100;
				var p_ap_0613_fac = (ap_0613_fac / nb_log_fac) * 100;
				var p_ap_0613_fra = (ap_0613_fra / nb_log_fra) * 100;
				
				barChartData.datasets[5].data = [p_ap_0613_com.toFixed(2),p_ap_0613_epci.toFixed(2),p_ap_0613_dep.toFixed(2),p_ap_0613_fac.toFixed(2),p_ap_0613_fra.toFixed(2)];

				//////////// Pourcentages autres avant 91 
				
				var p_au_av_91_com = (au_av_91_com / nb_log_com) * 100;
				var p_au_av_91_epci = (au_av_91_epci / nb_log_epci) * 100;
				var p_au_av_91_dep = (au_av_91_dep / nb_log_dep) * 100;
				var p_au_av_91_fac = (au_av_91_fac / nb_log_fac) * 100;
				var p_au_av_91_fra = (au_av_91_fra / nb_log_fra) * 100;
				
				barChartData.datasets[6].data = [p_au_av_91_com.toFixed(2),p_au_av_91_epci.toFixed(2),p_au_av_91_dep.toFixed(2),p_au_av_91_fac.toFixed(2),p_au_av_91_fra.toFixed(2)];

				//////////// Pourcentages autres 1991 - 2005 
				
				var p_au_9105_com = (au_9105_com / nb_log_com) * 100;
				var p_au_9105_epci = (au_9105_epci / nb_log_epci) * 100;
				var p_au_9105_dep = (au_9105_dep / nb_log_dep) * 100;
				var p_au_9105_fac = (au_9105_fac / nb_log_fac) * 100;
				var p_au_9105_fra = (au_9105_fra / nb_log_fra) * 100;
				
				barChartData.datasets[7].data = [p_au_9105_com.toFixed(2),p_au_9105_epci.toFixed(2),p_au_9105_dep.toFixed(2),p_au_9105_fac.toFixed(2),p_au_9105_fra.toFixed(2)];

				//////////// Pourcentages autres 2006 - 2013
				
				var p_au_0613_com = (au_0613_com / nb_log_com) * 100;
				var p_au_0613_epci = (au_0613_epci / nb_log_epci) * 100;
				var p_au_0613_dep = (au_0613_dep / nb_log_dep) * 100;
				var p_au_0613_fac = (au_0613_fac / nb_log_fac) * 100;
				var p_au_0613_fra = (au_0613_fra / nb_log_fra) * 100;
				
				barChartData.datasets[8].data = [p_au_0613_com.toFixed(2),p_au_0613_epci.toFixed(2),p_au_0613_dep.toFixed(2),p_au_0613_fac.toFixed(2),p_au_0613_fra.toFixed(2)];

				barChartData.datasets[0].backgroundColor = "#21618c";
				barChartData.datasets[1].backgroundColor = "#3498db";
				barChartData.datasets[2].backgroundColor = "#85c1e9";
				
				barChartData.datasets[3].backgroundColor = "#e74c3c";
				barChartData.datasets[4].backgroundColor = "#ec7063";
				barChartData.datasets[5].backgroundColor = "#f5b7b1";
				
				barChartData.datasets[6].backgroundColor = "#186a3b";
				barChartData.datasets[7].backgroundColor = "#2ecc71";
				barChartData.datasets[8].backgroundColor = "#82e0aa";

				barChartData.labels = [nomcom, ['',epci], depart, ['',facade], 'France'];
				window.myBar.update();
		
				window.myBar.options.title.text = 'Composition du parc de logements en 2016 (parts en %)';
				window.myBar.update();
						
						
			
			break;
			
			
			
			
			
			
			
			case '8': // Part des impôts ménages
			
				////////////// COMMUNE
			
				var fnb_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_0203);
				var fb_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.FB_0203);
				var th_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.TH_0203);
				var tp_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.TP_0203);
				
				var fnb_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_0910);
				var fb_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.FB_0910);
				var th_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.TH_0910);
				var tp_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.TP_0910);
				
				var fnb_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_1112);
				var fb_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.FB_1112);
				var th_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.TH_1112);
				var cfe_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.CFE_1112);
				var cvae_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.CVAE_1112);
				var ifer_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.IFER_1112);
				var tscom_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.TSCOM_1112);
				
				var fnb_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_1516);
				var fb_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.FB_1516);
				var th_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.TH_1516);
				var cfe_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.CFE_1516);
				var cvae_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.CVAE_1516);
				var ifer_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.IFER_1516);
				var tscom_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.TSCOM_1516);
				
				var part_m_com_02 = ((th_com_02 + fb_com_02)/(th_com_02 + fb_com_02 + fnb_com_02 + tp_com_02)) * 100
				var part_m_com_09 = ((th_com_09 + fb_com_09)/(th_com_09 + fb_com_09 + fnb_com_09 + tp_com_09)) * 100				
				var part_m_com_11 = ((th_com_11 + fb_com_11)/(th_com_11 + fb_com_11 + fnb_com_11 + cfe_com_11 + cvae_com_11 + ifer_com_11 + tscom_com_11)) * 100
				var part_m_com_15 = ((th_com_15 + fb_com_15)/(th_com_15 + fb_com_15 + fnb_com_15 + cfe_com_15 + cvae_com_15 + ifer_com_15 + tscom_com_15)) * 100				

				var nouvelleData = [part_m_com_02.toFixed(2),part_m_com_09.toFixed(2),part_m_com_11.toFixed(2),part_m_com_15.toFixed(2)]; 

				////////////// EPCI

				var fnb_epci_02 = Number(epci_data.features[indexepci].properties.FNB_0203);
				var fb_epci_02 = Number(epci_data.features[indexepci].properties.FB_0203);
				var th_epci_02 = Number(epci_data.features[indexepci].properties.TH_0203);
				var tp_epci_02 = Number(epci_data.features[indexepci].properties.TP_0203);
				
				var fnb_epci_09 = Number(epci_data.features[indexepci].properties.FNB_0910);
				var fb_epci_09 = Number(epci_data.features[indexepci].properties.FB_0910);
				var th_epci_09 = Number(epci_data.features[indexepci].properties.TH_0910);
				var tp_epci_09 = Number(epci_data.features[indexepci].properties.TP_0910);
				
				var fnb_epci_11 = Number(epci_data.features[indexepci].properties.FNB_1112);
				var fb_epci_11 = Number(epci_data.features[indexepci].properties.FB_1112);
				var th_epci_11 = Number(epci_data.features[indexepci].properties.TH_1112);
				var cfe_epci_11 = Number(epci_data.features[indexepci].properties.CFE_1112);
				var cvae_epci_11 = Number(epci_data.features[indexepci].properties.CVAE_1112);
				var ifer_epci_11 = Number(epci_data.features[indexepci].properties.IFER_1112);
				var tsepci_epci_11 = Number(epci_data.features[indexepci].properties.TSCOM_1112);
				
				var fnb_epci_15 = Number(epci_data.features[indexepci].properties.FNB_1516);
				var fb_epci_15 = Number(epci_data.features[indexepci].properties.FB_1516);
				var th_epci_15 = Number(epci_data.features[indexepci].properties.TH_1516);
				var cfe_epci_15 = Number(epci_data.features[indexepci].properties.CFE_1516);
				var cvae_epci_15 = Number(epci_data.features[indexepci].properties.CVAE_1516);
				var ifer_epci_15 = Number(epci_data.features[indexepci].properties.IFER_1516);
				var tsepci_epci_15 = Number(epci_data.features[indexepci].properties.TSCOM_1516);
				
				var part_m_epci_02 = ((th_epci_02 + fb_epci_02)/(th_epci_02 + fb_epci_02 + fnb_epci_02 + tp_epci_02)) * 100
				var part_m_epci_09 = ((th_epci_09 + fb_epci_09)/(th_epci_09 + fb_epci_09 + fnb_epci_09 + tp_epci_09)) * 100				
				var part_m_epci_11 = ((th_epci_11 + fb_epci_11)/(th_epci_11 + fb_epci_11 + fnb_epci_11 + cfe_epci_11 + cvae_epci_11 + ifer_epci_11 + tsepci_epci_11)) * 100
				var part_m_epci_15 = ((th_epci_15 + fb_epci_15)/(th_epci_15 + fb_epci_15 + fnb_epci_15 + cfe_epci_15 + cvae_epci_15 + ifer_epci_15 + tsepci_epci_15)) * 100				

				var epci_graphe = [part_m_epci_02.toFixed(2),part_m_epci_09.toFixed(2),part_m_epci_11.toFixed(2),part_m_epci_15.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var fnb_dep_02 = Number(dep_data_t.features[indexdep].properties.FNB_0203);
				var fb_dep_02 = Number(dep_data_t.features[indexdep].properties.FB_0203);
				var th_dep_02 = Number(dep_data_t.features[indexdep].properties.TH_0203);
				var tp_dep_02 = Number(dep_data_t.features[indexdep].properties.TP_0203);
				
				var fnb_dep_09 = Number(dep_data_t.features[indexdep].properties.FNB_0910);
				var fb_dep_09 = Number(dep_data_t.features[indexdep].properties.FB_0910);
				var th_dep_09 = Number(dep_data_t.features[indexdep].properties.TH_0910);
				var tp_dep_09 = Number(dep_data_t.features[indexdep].properties.TP_0910);
				
				var fnb_dep_11 = Number(dep_data_t.features[indexdep].properties.FNB_1112);
				var fb_dep_11 = Number(dep_data_t.features[indexdep].properties.FB_1112);
				var th_dep_11 = Number(dep_data_t.features[indexdep].properties.TH_1112);
				var cfe_dep_11 = Number(dep_data_t.features[indexdep].properties.CFE_1112);
				var cvae_dep_11 = Number(dep_data_t.features[indexdep].properties.CVAE_1112);
				var ifer_dep_11 = Number(dep_data_t.features[indexdep].properties.IFER_1112);
				var tsdep_dep_11 = Number(dep_data_t.features[indexdep].properties.TSCOM_1112);
				
				var fnb_dep_15 = Number(dep_data_t.features[indexdep].properties.FNB_1516);
				var fb_dep_15 = Number(dep_data_t.features[indexdep].properties.FB_1516);
				var th_dep_15 = Number(dep_data_t.features[indexdep].properties.TH_1516);
				var cfe_dep_15 = Number(dep_data_t.features[indexdep].properties.CFE_1516);
				var cvae_dep_15 = Number(dep_data_t.features[indexdep].properties.CVAE_1516);
				var ifer_dep_15 = Number(dep_data_t.features[indexdep].properties.IFER_1516);
				var tsdep_dep_15 = Number(dep_data_t.features[indexdep].properties.TSCOM_1516);
				
				var part_m_dep_02 = ((th_dep_02 + fb_dep_02)/(th_dep_02 + fb_dep_02 + fnb_dep_02 + tp_dep_02)) * 100
				var part_m_dep_09 = ((th_dep_09 + fb_dep_09)/(th_dep_09 + fb_dep_09 + fnb_dep_09 + tp_dep_09)) * 100				
				var part_m_dep_11 = ((th_dep_11 + fb_dep_11)/(th_dep_11 + fb_dep_11 + fnb_dep_11 + cfe_dep_11 + cvae_dep_11 + ifer_dep_11 + tsdep_dep_11)) * 100
				var part_m_dep_15 = ((th_dep_15 + fb_dep_15)/(th_dep_15 + fb_dep_15 + fnb_dep_15 + cfe_dep_15 + cvae_dep_15 + ifer_dep_15 + tsdep_dep_15)) * 100				

				var depart_data = [part_m_dep_02.toFixed(2),part_m_dep_09.toFixed(2),part_m_dep_11.toFixed(2),part_m_dep_15.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var fnb_facade_02 = Number(facade_data_t.features[indexfac].properties.FNB_0203);
				var fb_facade_02 = Number(facade_data_t.features[indexfac].properties.FB_0203);
				var th_facade_02 = Number(facade_data_t.features[indexfac].properties.TH_0203);
				var tp_facade_02 = Number(facade_data_t.features[indexfac].properties.TP_0203);
				
				var fnb_facade_09 = Number(facade_data_t.features[indexfac].properties.FNB_0910);
				var fb_facade_09 = Number(facade_data_t.features[indexfac].properties.FB_0910);
				var th_facade_09 = Number(facade_data_t.features[indexfac].properties.TH_0910);
				var tp_facade_09 = Number(facade_data_t.features[indexfac].properties.TP_0910);
				
				var fnb_facade_11 = Number(facade_data_t.features[indexfac].properties.FNB_1112);
				var fb_facade_11 = Number(facade_data_t.features[indexfac].properties.FB_1112);
				var th_facade_11 = Number(facade_data_t.features[indexfac].properties.TH_1112);
				var cfe_facade_11 = Number(facade_data_t.features[indexfac].properties.CFE_1112);
				var cvae_facade_11 = Number(facade_data_t.features[indexfac].properties.CVAE_1112);
				var ifer_facade_11 = Number(facade_data_t.features[indexfac].properties.IFER_1112);
				var tsfacade_facade_11 = Number(facade_data_t.features[indexfac].properties.TSCOM_1112);
				
				var fnb_facade_15 = Number(facade_data_t.features[indexfac].properties.FNB_1516);
				var fb_facade_15 = Number(facade_data_t.features[indexfac].properties.FB_1516);
				var th_facade_15 = Number(facade_data_t.features[indexfac].properties.TH_1516);
				var cfe_facade_15 = Number(facade_data_t.features[indexfac].properties.CFE_1516);
				var cvae_facade_15 = Number(facade_data_t.features[indexfac].properties.CVAE_1516);
				var ifer_facade_15 = Number(facade_data_t.features[indexfac].properties.IFER_1516);
				var tsfacade_facade_15 = Number(facade_data_t.features[indexfac].properties.TSCOM_1516);
				
				var part_m_facade_02 = ((th_facade_02 + fb_facade_02)/(th_facade_02 + fb_facade_02 + fnb_facade_02 + tp_facade_02)) * 100
				var part_m_facade_09 = ((th_facade_09 + fb_facade_09)/(th_facade_09 + fb_facade_09 + fnb_facade_09 + tp_facade_09)) * 100				
				var part_m_facade_11 = ((th_facade_11 + fb_facade_11)/(th_facade_11 + fb_facade_11 + fnb_facade_11 + cfe_facade_11 + cvae_facade_11 + ifer_facade_11 + tsfacade_facade_11)) * 100
				var part_m_facade_15 = ((th_facade_15 + fb_facade_15)/(th_facade_15 + fb_facade_15 + fnb_facade_15 + cfe_facade_15 + cvae_facade_15 + ifer_facade_15 + tsfacade_facade_15)) * 100				

				var facade_data = [part_m_facade_02.toFixed(2),part_m_facade_09.toFixed(2),part_m_facade_11.toFixed(2),part_m_facade_15.toFixed(2)];
				
				
				////////////// FRANCE
				
				var fnb_france_02 = Number(france_data_t.features[0].properties.FNB_0203);
				var fb_france_02 = Number(france_data_t.features[0].properties.FB_0203);
				var th_france_02 = Number(france_data_t.features[0].properties.TH_0203);
				var tp_france_02 = Number(france_data_t.features[0].properties.TP_0203);
				
				var fnb_france_09 = Number(france_data_t.features[0].properties.FNB_0910);
				var fb_france_09 = Number(france_data_t.features[0].properties.FB_0910);
				var th_france_09 = Number(france_data_t.features[0].properties.TH_0910);
				var tp_france_09 = Number(france_data_t.features[0].properties.TP_0910);
				
				var fnb_france_11 = Number(france_data_t.features[0].properties.FNB_1112);
				var fb_france_11 = Number(france_data_t.features[0].properties.FB_1112);
				var th_france_11 = Number(france_data_t.features[0].properties.TH_1112);
				var cfe_france_11 = Number(france_data_t.features[0].properties.CFE_1112);
				var cvae_france_11 = Number(france_data_t.features[0].properties.CVAE_1112);
				var ifer_france_11 = Number(france_data_t.features[0].properties.IFER_1112);
				var tsfrance_france_11 = Number(france_data_t.features[0].properties.TSCOM_1112);
				
				var fnb_france_15 = Number(france_data_t.features[0].properties.FNB_1516);
				var fb_france_15 = Number(france_data_t.features[0].properties.FB_1516);
				var th_france_15 = Number(france_data_t.features[0].properties.TH_1516);
				var cfe_france_15 = Number(france_data_t.features[0].properties.CFE_1516);
				var cvae_france_15 = Number(france_data_t.features[0].properties.CVAE_1516);
				var ifer_france_15 = Number(france_data_t.features[0].properties.IFER_1516);
				var tsfrance_france_15 = Number(france_data_t.features[0].properties.TSCOM_1516);
				
				var part_m_france_02 = ((th_france_02 + fb_france_02)/(th_france_02 + fb_france_02 + fnb_france_02 + tp_france_02)) * 100
				var part_m_france_09 = ((th_france_09 + fb_france_09)/(th_france_09 + fb_france_09 + fnb_france_09 + tp_france_09)) * 100				
				var part_m_france_11 = ((th_france_11 + fb_france_11)/(th_france_11 + fb_france_11 + fnb_france_11 + cfe_france_11 + cvae_france_11 + ifer_france_11 + tsfrance_france_11)) * 100
				var part_m_france_15 = ((th_france_15 + fb_france_15)/(th_france_15 + fb_france_15 + fnb_france_15 + cfe_france_15 + cvae_france_15 + ifer_france_15 + tsfrance_france_15)) * 100				

				var fra_data = [part_m_france_02.toFixed(2),part_m_france_09.toFixed(2),part_m_france_11.toFixed(2),part_m_france_15.toFixed(2)];
				
				barChartData.datasets[0].data = nouvelleData; // Remplacement des données de base par les données de population 
				barChartData.datasets[1].data = epci_graphe;
				barChartData.datasets[2].data = depart_data;
				barChartData.datasets[3].data = facade_data;
				barChartData.datasets[4].data = fra_data;
				barChartData.labels = ['2002-03', '2009-10', '2011-12', '2015-16'];
				window.myBar.update();
		
				window.myBar.options.title.text = 'Part du produit des impôts ménages dans le produit total des impôts locaux du bloc communal (%)';
				barChartData.datasets[0].label = nomcom;
				barChartData.datasets[1].label = "Moyenne " + epci;
				barChartData.datasets[2].label = "Moyenne " + depart;
				window.myBar.update();
						
						
			
			
			break;
			
			
			case '9': // Part des recettes fiscales dans le produit total de fonctionnement
			
				////////////// COMMUNE
			
				var fisc_com02 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_0203);
				var fisc_com09 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_0910);
				var fisc_com15 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_1516);
				var fonct_com02 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_0203);
				var fonct_com09 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_0910);
				var fonct_com15 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_1516);
				
				var part_fisc_com02 = (fisc_com02 / fonct_com02 ) * 100;
				var part_fisc_com09 = (fisc_com09 / fonct_com09 ) * 100;
				var part_fisc_com15 = (fisc_com15 / fonct_com15 ) * 100;
				
				var nouvelleData = [part_fisc_com02.toFixed(2),part_fisc_com09.toFixed(2),part_fisc_com15.toFixed(2)]; 

				////////////// EPCI

				var fisc_epci02 = Number(epci_data.features[indexepci].properties.FISC_0203);
				var fisc_epci09 = Number(epci_data.features[indexepci].properties.FISC_0910);
				var fisc_epci15 = Number(epci_data.features[indexepci].properties.FISC_1516);
				var fonct_epci02 = Number(epci_data.features[indexepci].properties.P_FCT_0203);
				var fonct_epci09 = Number(epci_data.features[indexepci].properties.P_FCT_0910);
				var fonct_epci15 = Number(epci_data.features[indexepci].properties.P_FCT_1516);
				
				var part_fisc_epci02 = (fisc_epci02 / fonct_epci02 ) * 100;
				var part_fisc_epci09 = (fisc_epci09 / fonct_epci09 ) * 100;
				var part_fisc_epci15 = (fisc_epci15 / fonct_epci15 ) * 100;
				
				var epci_graphe = [part_fisc_epci02.toFixed(2),part_fisc_epci09.toFixed(2),part_fisc_epci15.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var fisc_depart02 = Number(dep_data_t.features[indexdep].properties.FISC_0203);
				var fisc_depart09 = Number(dep_data_t.features[indexdep].properties.FISC_0910);
				var fisc_depart15 = Number(dep_data_t.features[indexdep].properties.FISC_1516);
				var fonct_depart02 = Number(dep_data_t.features[indexdep].properties.P_FCT_0203);
				var fonct_depart09 = Number(dep_data_t.features[indexdep].properties.P_FCT_0910);
				var fonct_depart15 = Number(dep_data_t.features[indexdep].properties.P_FCT_1516);
				
				var part_fisc_depart02 = (fisc_depart02 / fonct_depart02 ) * 100;
				var part_fisc_depart09 = (fisc_depart09 / fonct_depart09 ) * 100;
				var part_fisc_depart15 = (fisc_depart15 / fonct_depart15 ) * 100;
				
				var depart_data = [part_fisc_depart02.toFixed(2),part_fisc_depart09.toFixed(2),part_fisc_depart15.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var fisc_facade02 = Number(facade_data_t.features[indexfac].properties.FISC_0203);
				var fisc_facade09 = Number(facade_data_t.features[indexfac].properties.FISC_0910);
				var fisc_facade15 = Number(facade_data_t.features[indexfac].properties.FISC_1516);
				var fonct_facade02 = Number(facade_data_t.features[indexfac].properties.P_FCT_0203);
				var fonct_facade09 = Number(facade_data_t.features[indexfac].properties.P_FCT_0910);
				var fonct_facade15 = Number(facade_data_t.features[indexfac].properties.P_FCT_1516);
				
				var part_fisc_facade02 = (fisc_facade02 / fonct_facade02 ) * 100;
				var part_fisc_facade09 = (fisc_facade09 / fonct_facade09 ) * 100;
				var part_fisc_facade15 = (fisc_facade15 / fonct_facade15 ) * 100;
				
				var facade_data = [part_fisc_facade02.toFixed(2),part_fisc_facade09.toFixed(2),part_fisc_facade15.toFixed(2)];
				
				
				////////////// FRANCE
				
				var fisc_france02 = Number(france_data_t.features[0].properties.FISC_0203);
				var fisc_france09 = Number(france_data_t.features[0].properties.FISC_0910);
				var fisc_france15 = Number(france_data_t.features[0].properties.FISC_1516);
				var fonct_france02 = Number(france_data_t.features[0].properties.P_FCT_0203);
				var fonct_france09 = Number(france_data_t.features[0].properties.P_FCT_0910);
				var fonct_france15 = Number(france_data_t.features[0].properties.P_FCT_1516);
				
				var part_fisc_france02 = (fisc_france02 / fonct_france02 ) * 100;
				var part_fisc_france09 = (fisc_france09 / fonct_france09 ) * 100;
				var part_fisc_france15 = (fisc_france15 / fonct_france15 ) * 100;
				
				var fra_data = [part_fisc_france02.toFixed(2),part_fisc_france09.toFixed(2),part_fisc_france15.toFixed(2)];
				
				barChartData.datasets[0].data = nouvelleData; 
				barChartData.datasets[1].data = epci_graphe;
				barChartData.datasets[2].data = depart_data;
				barChartData.datasets[3].data = facade_data;
				barChartData.datasets[4].data = fra_data;
				barChartData.labels = ['2002-03', '2009-10', '2015-16'];
				window.myBar.update();
		
				window.myBar.options.title.text = 'Part des recettes fiscales dans le produit total de fonctionnement (%)';
				barChartData.datasets[0].label = nomcom;
				barChartData.datasets[1].label = "Moyenne " + epci;
				barChartData.datasets[2].label = "Moyenne " + depart;
				window.myBar.update();
						
			
			
			break;
			
			
			
		}	
		
	}
	
		function graphe2(choix) {	

		document.getElementById("selecteur2").style.visibility = "hidden";
		
		while (barChartData2.datasets.length > 0){
			barChartData2.datasets.pop(); 
		}
		
		barChartData2.datasets.push({label : nomcom, backgroundColor: window.chartColors.red, stack : 'Stack 0', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData2.datasets.push({label : 'Moyenne ' + epci, backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData2.datasets.push({label : 'Moyenne ' + depart, backgroundColor: window.chartColors.yellow, stack : 'Stack 2', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData2.datasets.push({label : 'Moyenne ' + facade, backgroundColor: window.chartColors.blue, stack : 'Stack 3', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData2.datasets.push({label : 'Moyenne France', backgroundColor: window.chartColors.green, stack : 'Stack 4', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});

		window.myBar2.options.legend.display = true;
		window.myBar2.update();


		var valeur_graphe2 = document.getElementById("graphique2"); 
		var choixUti2 = valeur_graphe2.options[valeur_graphe2.selectedIndex].value; // Récupération du choix de l'utilisateur

		switch (choixUti2) { // Calcul des données des graphiques en fonction du choix de l'utilisateur graphique 1
			case '1': // Cas n°1 : données de population 

				////////////// COMMUNE
			
				var pop_com99 = json_donnees_finales.features[indexcom_d].properties.Pop_1999;
				var pop_com10 = json_donnees_finales.features[indexcom_d].properties.Pop_2010;
				var pop_com15 = json_donnees_finales.features[indexcom_d].properties.Pop_2015;
				var evolpop9910 = (((pop_com10-pop_com99)/pop_com99)*100)/11;
				var evolpop1015 = (((pop_com15-pop_com10)/pop_com10)*100)/5;
				var nouvelleData = [evolpop9910.toFixed(2),evolpop1015.toFixed(2)]; // Valeur d'évolution de la population de la commune

				////////////// EPCI

				var pop_epci99 = epci_data.features[indexepci].properties.Pop_1999;
				var pop_epci10 = epci_data.features[indexepci].properties.Pop_2010;
				var pop_epci15 = epci_data.features[indexepci].properties.Pop_2015;
				var evolpopepci9910 = (((pop_epci10-pop_epci99)/pop_epci99)*100)/11;
				var evolpopepci1015 = (((pop_epci15-pop_epci10)/pop_epci10)*100)/5;
				var epci_graphe = [evolpopepci9910.toFixed(2),evolpopepci1015.toFixed(2)]; // Valeur d'évolution de la population de la commune

				
				////////////// DEPARTEMENT
				
				var pop_depart99 = dep_data_t.features[indexdep].properties.Pop_1999;
				var pop_depart10 = dep_data_t.features[indexdep].properties.Pop_2010;
				var pop_depart15 = dep_data_t.features[indexdep].properties.Pop_2015;
				var evolpopdepart9910 = (((pop_depart10-pop_depart99)/pop_depart99)*100)/11;
				var evolpopdepart1015 = (((pop_depart15-pop_depart10)/pop_depart10)*100)/5;
				var depart_data = [evolpopdepart9910.toFixed(2),evolpopdepart1015.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var pop_facade99 = facade_data_t.features[indexfac].properties.Pop_1999;
				var pop_facade10 = facade_data_t.features[indexfac].properties.Pop_2010;
				var pop_facade15 = facade_data_t.features[indexfac].properties.Pop_2015;
				var evolpopfacade9910 = (((pop_facade10-pop_facade99)/pop_facade99)*100)/11;
				var evolpopfacade1015 = (((pop_facade15-pop_facade10)/pop_facade10)*100)/5;
				var facade_data = [evolpopfacade9910.toFixed(2),evolpopfacade1015.toFixed(2)];
				
				
				////////////// FRANCE
				
				var pop_fra99 = france_data_t.features[0].properties.Pop_1999;
				var pop_fra10 = france_data_t.features[0].properties.Pop_2010;
				var pop_fra15 = france_data_t.features[0].properties.Pop_2015;
				var evolpopfra9910 = (((pop_fra10-pop_fra99)/pop_fra99)*100)/11;
				var evolpopfra1015 = (((pop_fra15-pop_fra10)/pop_fra10)*100)/5;
				var fra_data = [evolpopfra9910.toFixed(2),evolpopfra1015.toFixed(2)];
				
				barChartData2.datasets[0].data = nouvelleData; // Remplacement des données de base par les données de population 
				barChartData2.datasets[1].data = epci_graphe;
				barChartData2.datasets[2].data = depart_data;
				barChartData2.datasets[3].data = facade_data;
				barChartData2.datasets[4].data = fra_data;
				barChartData2.labels = ['1999 - 2010', '2010 - 2015'];
				window.myBar2.update();
		
				window.myBar2.options.title.text = 'Taux d\'évolution annuel de la population (%)';
				barChartData2.datasets[0].label = nomcom;
				barChartData2.datasets[1].label = "Moyenne " + epci;
				barChartData2.datasets[2].label = "Moyenne " + depart;
				window.myBar2.update();
				
				
			break;
			
			
			
			
			
			case '2': // Cas n°2 : Structure des âges
			
				while (barChartData2.datasets.length > 0 ){
					barChartData2.datasets.pop(); 
				}
				
				document.getElementById("selecteur2").style.visibility = "visible";
				
				barChartData2.datasets.push({label : ' -15 ans', backgroundColor: window.chartColors.red, stack : 'Stack 1', data : [1,1,1,5,5,5,5,5,5,5,5,5]});
				barChartData2.datasets.push({label : ' 15 - 29 ans', backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData2.datasets.push({label : ' 30 - 44 ans', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData2.datasets.push({label : ' 45 - 59 ans', backgroundColor: window.chartColors.blue, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData2.datasets.push({label : ' 60 - 74 ans', backgroundColor: window.chartColors.green, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData2.datasets.push({label : ' 75 ans et plus', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				
				//////////////// Populations
				
				var pop_com_s_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP;
				var pop_com_s_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP;
				var pop_com_s_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP;
				var pop_epci_s_99 = epci_data.features[indexepci].properties.P99_POP;
				var pop_epci_s_10 = epci_data.features[indexepci].properties.P10_POP;
				var pop_epci_s_16 = epci_data.features[indexepci].properties.P16_POP;
				var pop_dep_s_99 = dep_data_t.features[indexdep].properties.P99_POP;
				var pop_dep_s_10 = dep_data_t.features[indexdep].properties.P10_POP;
				var pop_dep_s_16 = dep_data_t.features[indexdep].properties.P16_POP;
				var pop_fac_s_99 = facade_data_t.features[indexfac].properties.P99_POP;
				var pop_fac_s_10 = facade_data_t.features[indexfac].properties.P10_POP;
				var pop_fac_s_16 = facade_data_t.features[indexfac].properties.P16_POP;
				var pop_fra_s_99 = france_data_t.features[0].properties.P99_POP;
				var pop_fra_s_10 = france_data_t.features[0].properties.P10_POP;
				var pop_fra_s_16 = france_data_t.features[0].properties.P16_POP;
				
				
				
				////////////// Moins de 15 ans 
				
				var moins_15_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP0014;
				var moins_15_epci_99 = epci_data.features[indexepci].properties.P99_POP0014;
				var moins_15_dep_99 = dep_data_t.features[indexdep].properties.P99_POP0014;
				var moins_15_fac_99 = facade_data_t.features[indexfac].properties.P99_POP0014;
				var moins_15_fra_99 = france_data_t.features[0].properties.P99_POP0014;
				var moins_15_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP0014;
				var moins_15_epci_10 = epci_data.features[indexepci].properties.P10_POP0014;
				var moins_15_dep_10 = dep_data_t.features[indexdep].properties.P10_POP0014;
				var moins_15_fac_10 = facade_data_t.features[indexfac].properties.P10_POP0014;
				var moins_15_fra_10 = france_data_t.features[0].properties.P10_POP0014;
				var moins_15_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP0014;
				var moins_15_epci_16 = epci_data.features[indexepci].properties.P16_POP0014;
				var moins_15_dep_16 = dep_data_t.features[indexdep].properties.P16_POP0014;
				var moins_15_fac_16 = facade_data_t.features[indexfac].properties.P16_POP0014;
				var moins_15_fra_16 = france_data_t.features[0].properties.P16_POP0014;
				
				var part_moins_15_com_99 = (moins_15_com_99 / pop_com_s_99) * 100;
				var part_moins_15_epci_99 = (moins_15_epci_99 / pop_epci_s_99) * 100;
				var part_moins_15_dep_99 = (moins_15_dep_99 / pop_dep_s_99) * 100;
				var part_moins_15_fac_99 = (moins_15_fac_99 / pop_fac_s_99) * 100;
				var part_moins_15_fra_99 = (moins_15_fra_99 / pop_fra_s_99) * 100;
				var part_moins_15_com_10 = (moins_15_com_10 / pop_com_s_10) * 100;
				var part_moins_15_epci_10 = (moins_15_epci_10 / pop_epci_s_10) * 100;
				var part_moins_15_dep_10 = (moins_15_dep_10 / pop_dep_s_10) * 100;
				var part_moins_15_fac_10 = (moins_15_fac_10 / pop_fac_s_10) * 100;
				var part_moins_15_fra_10 = (moins_15_fra_10 / pop_fra_s_10) * 100;
				var part_moins_15_com_16 = (moins_15_com_16 / pop_com_s_16) * 100;
				var part_moins_15_epci_16 = (moins_15_epci_16 / pop_epci_s_16) * 100;
				var part_moins_15_dep_16 = (moins_15_dep_16 / pop_dep_s_16) * 100;
				var part_moins_15_fac_16 = (moins_15_fac_16 / pop_fac_s_16) * 100;
				var part_moins_15_fra_16 = (moins_15_fra_16 / pop_fra_s_16) * 100;

				////////////// 15 à 29 ans

				var p_1529_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP1529;
				var p_1529_epci_99 = epci_data.features[indexepci].properties.P99_POP1529;
				var p_1529_dep_99 = dep_data_t.features[indexdep].properties.P99_POP1529;
				var p_1529_fac_99 = facade_data_t.features[indexfac].properties.P99_POP1529;
				var p_1529_fra_99 = france_data_t.features[0].properties.P99_POP1529;
				var p_1529_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP1529;
				var p_1529_epci_10 = epci_data.features[indexepci].properties.P10_POP1529;
				var p_1529_dep_10 = dep_data_t.features[indexdep].properties.P10_POP1529;
				var p_1529_fac_10 = facade_data_t.features[indexfac].properties.P10_POP1529;
				var p_1529_fra_10 = france_data_t.features[0].properties.P10_POP1529;
				var p_1529_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP1529;
				var p_1529_epci_16 = epci_data.features[indexepci].properties.P16_POP1529;
				var p_1529_dep_16 = dep_data_t.features[indexdep].properties.P16_POP1529;
				var p_1529_fac_16 = facade_data_t.features[indexfac].properties.P16_POP1529;
				var p_1529_fra_16 = france_data_t.features[0].properties.P16_POP1529;

				var part_p_1529_com_99 = (p_1529_com_99 / pop_com_s_99) * 100;
				var part_p_1529_epci_99 = (p_1529_epci_99 / pop_epci_s_99) * 100;
				var part_p_1529_dep_99 = (p_1529_dep_99 / pop_dep_s_99) * 100;
				var part_p_1529_fac_99 = (p_1529_fac_99 / pop_fac_s_99) * 100;
				var part_p_1529_fra_99 = (p_1529_fra_99 / pop_fra_s_99) * 100;
				var part_p_1529_com_10 = (p_1529_com_10 / pop_com_s_10) * 100;
				var part_p_1529_epci_10 = (p_1529_epci_10 / pop_epci_s_10) * 100;
				var part_p_1529_dep_10 = (p_1529_dep_10 / pop_dep_s_10) * 100;
				var part_p_1529_fac_10 = (p_1529_fac_10 / pop_fac_s_10) * 100;
				var part_p_1529_fra_10 = (p_1529_fra_10 / pop_fra_s_10) * 100;
				var part_p_1529_com_16 = (p_1529_com_16 / pop_com_s_16) * 100;
				var part_p_1529_epci_16 = (p_1529_epci_16 / pop_epci_s_16) * 100;
				var part_p_1529_dep_16 = (p_1529_dep_16 / pop_dep_s_16) * 100;
				var part_p_1529_fac_16 = (p_1529_fac_16 / pop_fac_s_16) * 100;
				var part_p_1529_fra_16 = (p_1529_fra_16 / pop_fra_s_16) * 100;
				
				
				
				////////////// 30 à 44 ans
				
				var p_3044_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP3044;
				var p_3044_epci_99 = epci_data.features[indexepci].properties.P99_POP3044;
				var p_3044_dep_99 = dep_data_t.features[indexdep].properties.P99_POP3044;
				var p_3044_fac_99 = facade_data_t.features[indexfac].properties.P99_POP3044;
				var p_3044_fra_99 = france_data_t.features[0].properties.P99_POP3044;
				var p_3044_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP3044;
				var p_3044_epci_10 = epci_data.features[indexepci].properties.P10_POP3044;
				var p_3044_dep_10 = dep_data_t.features[indexdep].properties.P10_POP3044;
				var p_3044_fac_10 = facade_data_t.features[indexfac].properties.P10_POP3044;
				var p_3044_fra_10 = france_data_t.features[0].properties.P10_POP3044;
				var p_3044_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP3044;
				var p_3044_epci_16 = epci_data.features[indexepci].properties.P16_POP3044;
				var p_3044_dep_16 = dep_data_t.features[indexdep].properties.P16_POP3044;
				var p_3044_fac_16 = facade_data_t.features[indexfac].properties.P16_POP3044;
				var p_3044_fra_16 = france_data_t.features[0].properties.P16_POP3044;
				
				var part_p_3044_com_99 = (p_3044_com_99 / pop_com_s_99) * 100;
				var part_p_3044_epci_99 = (p_3044_epci_99 / pop_epci_s_99) * 100;
				var part_p_3044_dep_99 = (p_3044_dep_99 / pop_dep_s_99) * 100;
				var part_p_3044_fac_99 = (p_3044_fac_99 / pop_fac_s_99) * 100;
				var part_p_3044_fra_99 = (p_3044_fra_99 / pop_fra_s_99) * 100;
				var part_p_3044_com_10 = (p_3044_com_10 / pop_com_s_10) * 100;
				var part_p_3044_epci_10 = (p_3044_epci_10 / pop_epci_s_10) * 100;
				var part_p_3044_dep_10 = (p_3044_dep_10 / pop_dep_s_10) * 100;
				var part_p_3044_fac_10 = (p_3044_fac_10 / pop_fac_s_10) * 100;
				var part_p_3044_fra_10 = (p_3044_fra_10 / pop_fra_s_10) * 100;
				var part_p_3044_com_16 = (p_3044_com_16 / pop_com_s_16) * 100;
				var part_p_3044_epci_16 = (p_3044_epci_16 / pop_epci_s_16) * 100;
				var part_p_3044_dep_16 = (p_3044_dep_16 / pop_dep_s_16) * 100;
				var part_p_3044_fac_16 = (p_3044_fac_16 / pop_fac_s_16) * 100;
				var part_p_3044_fra_16 = (p_3044_fra_16 / pop_fra_s_16) * 100;
				
				////////////// 45 à 59 ans 
				
				var p_4559_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP4559;
				var p_4559_epci_99 = epci_data.features[indexepci].properties.P99_POP4559;
				var p_4559_dep_99 = dep_data_t.features[indexdep].properties.P99_POP4559;
				var p_4559_fac_99 = facade_data_t.features[indexfac].properties.P99_POP4559;
				var p_4559_fra_99 = france_data_t.features[0].properties.P99_POP4559;
				var p_4559_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP4559;
				var p_4559_epci_10 = epci_data.features[indexepci].properties.P10_POP4559;
				var p_4559_dep_10 = dep_data_t.features[indexdep].properties.P10_POP4559;
				var p_4559_fac_10 = facade_data_t.features[indexfac].properties.P10_POP4559;
				var p_4559_fra_10 = france_data_t.features[0].properties.P10_POP4559;
				var p_4559_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP4559;
				var p_4559_epci_16 = epci_data.features[indexepci].properties.P16_POP4559;
				var p_4559_dep_16 = dep_data_t.features[indexdep].properties.P16_POP4559;
				var p_4559_fac_16 = facade_data_t.features[indexfac].properties.P16_POP4559;
				var p_4559_fra_16 = france_data_t.features[0].properties.P16_POP4559;
				
				var part_p_4559_com_99 = (p_4559_com_99 / pop_com_s_99) * 100;
				var part_p_4559_epci_99 = (p_4559_epci_99 / pop_epci_s_99) * 100;
				var part_p_4559_dep_99 = (p_4559_dep_99 / pop_dep_s_99) * 100;
				var part_p_4559_fac_99 = (p_4559_fac_99 / pop_fac_s_99) * 100;
				var part_p_4559_fra_99 = (p_4559_fra_99 / pop_fra_s_99) * 100;
				var part_p_4559_com_10 = (p_4559_com_10 / pop_com_s_10) * 100;
				var part_p_4559_epci_10 = (p_4559_epci_10 / pop_epci_s_10) * 100;
				var part_p_4559_dep_10 = (p_4559_dep_10 / pop_dep_s_10) * 100;
				var part_p_4559_fac_10 = (p_4559_fac_10 / pop_fac_s_10) * 100;
				var part_p_4559_fra_10 = (p_4559_fra_10 / pop_fra_s_10) * 100;
				var part_p_4559_com_16 = (p_4559_com_16 / pop_com_s_16) * 100;
				var part_p_4559_epci_16 = (p_4559_epci_16 / pop_epci_s_16) * 100;
				var part_p_4559_dep_16 = (p_4559_dep_16 / pop_dep_s_16) * 100;
				var part_p_4559_fac_16 = (p_4559_fac_16 / pop_fac_s_16) * 100;
				var part_p_4559_fra_16 = (p_4559_fra_16 / pop_fra_s_16) * 100;
				
				
				////////////// 60 à 74 ans
				
				var p_6074_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP6074;
				var p_6074_epci_99 = epci_data.features[indexepci].properties.P99_POP6074;
				var p_6074_dep_99 = dep_data_t.features[indexdep].properties.P99_POP6074;
				var p_6074_fac_99 = facade_data_t.features[indexfac].properties.P99_POP6074;
				var p_6074_fra_99 = france_data_t.features[0].properties.P99_POP6074;
				var p_6074_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP6074;
				var p_6074_epci_10 = epci_data.features[indexepci].properties.P10_POP6074;
				var p_6074_dep_10 = dep_data_t.features[indexdep].properties.P10_POP6074;
				var p_6074_fac_10 = facade_data_t.features[indexfac].properties.P10_POP6074;
				var p_6074_fra_10 = france_data_t.features[0].properties.P10_POP6074;
				var p_6074_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP6074;
				var p_6074_epci_16 = epci_data.features[indexepci].properties.P16_POP6074;
				var p_6074_dep_16 = dep_data_t.features[indexdep].properties.P16_POP6074;
				var p_6074_fac_16 = facade_data_t.features[indexfac].properties.P16_POP6074;
				var p_6074_fra_16 = france_data_t.features[0].properties.P16_POP6074;

				var part_p_6074_com_99 = (p_6074_com_99 / pop_com_s_99) * 100;
				var part_p_6074_epci_99 = (p_6074_epci_99 / pop_epci_s_99) * 100;
				var part_p_6074_dep_99 = (p_6074_dep_99 / pop_dep_s_99) * 100;
				var part_p_6074_fac_99 = (p_6074_fac_99 / pop_fac_s_99) * 100;
				var part_p_6074_fra_99 = (p_6074_fra_99 / pop_fra_s_99) * 100;
				var part_p_6074_com_10 = (p_6074_com_10 / pop_com_s_10) * 100;
				var part_p_6074_epci_10 = (p_6074_epci_10 / pop_epci_s_10) * 100;
				var part_p_6074_dep_10 = (p_6074_dep_10 / pop_dep_s_10) * 100;
				var part_p_6074_fac_10 = (p_6074_fac_10 / pop_fac_s_10) * 100;
				var part_p_6074_fra_10 = (p_6074_fra_10 / pop_fra_s_10) * 100;
				var part_p_6074_com_16 = (p_6074_com_16 / pop_com_s_16) * 100;
				var part_p_6074_epci_16 = (p_6074_epci_16 / pop_epci_s_16) * 100;
				var part_p_6074_dep_16 = (p_6074_dep_16 / pop_dep_s_16) * 100;
				var part_p_6074_fac_16 = (p_6074_fac_16 / pop_fac_s_16) * 100;
				var part_p_6074_fra_16 = (p_6074_fra_16 / pop_fra_s_16) * 100;
				
				////////////// 75 ans et plus
				
				var p_75P_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP75P;
				var p_75P_epci_99 = epci_data.features[indexepci].properties.P99_POP75P;
				var p_75P_dep_99 = dep_data_t.features[indexdep].properties.P99_POP75P;
				var p_75P_fac_99 = facade_data_t.features[indexfac].properties.P99_POP75P;
				var p_75P_fra_99 = france_data_t.features[0].properties.P99_POP75P;
				var p_75P_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP75P;
				var p_75P_epci_10 = epci_data.features[indexepci].properties.P10_POP75P;
				var p_75P_dep_10 = dep_data_t.features[indexdep].properties.P10_POP75P;
				var p_75P_fac_10 = facade_data_t.features[indexfac].properties.P10_POP75P;
				var p_75P_fra_10 = france_data_t.features[0].properties.P10_POP75P;
				var p_75P_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP75P;
				var p_75P_epci_16 = epci_data.features[indexepci].properties.P16_POP75P;
				var p_75P_dep_16 = dep_data_t.features[indexdep].properties.P16_POP75P;
				var p_75P_fac_16 = facade_data_t.features[indexfac].properties.P16_POP75P;
				var p_75P_fra_16 = france_data_t.features[0].properties.P16_POP75P;
				
				var part_p_75P_com_99 = (p_75P_com_99 / pop_com_s_99) * 100;
				var part_p_75P_epci_99 = (p_75P_epci_99 / pop_epci_s_99) * 100;
				var part_p_75P_dep_99 = (p_75P_dep_99 / pop_dep_s_99) * 100;
				var part_p_75P_fac_99 = (p_75P_fac_99 / pop_fac_s_99) * 100;
				var part_p_75P_fra_99 = (p_75P_fra_99 / pop_fra_s_99) * 100;
				var part_p_75P_com_10 = (p_75P_com_10 / pop_com_s_10) * 100;
				var part_p_75P_epci_10 = (p_75P_epci_10 / pop_epci_s_10) * 100;
				var part_p_75P_dep_10 = (p_75P_dep_10 / pop_dep_s_10) * 100;
				var part_p_75P_fac_10 = (p_75P_fac_10 / pop_fac_s_10) * 100;
				var part_p_75P_fra_10 = (p_75P_fra_10 / pop_fra_s_10) * 100;
				var part_p_75P_com_16 = (p_75P_com_16 / pop_com_s_16) * 100;
				var part_p_75P_epci_16 = (p_75P_epci_16 / pop_epci_s_16) * 100;
				var part_p_75P_dep_16 = (p_75P_dep_16 / pop_dep_s_16) * 100;
				var part_p_75P_fac_16 = (p_75P_fac_16 / pop_fac_s_16) * 100;
				var part_p_75P_fra_16 = (p_75P_fra_16 / pop_fra_s_16) * 100;
	
				var anneechoisie = document.getElementById("selecteur2");
				var anneestruct = anneechoisie.options[anneechoisie.selectedIndex].value;
	
				switch (anneestruct) {
				
				case '1999' : 
					barChartData2.datasets[0].data = [part_moins_15_com_99.toFixed(2),part_moins_15_epci_99.toFixed(2),part_moins_15_dep_99.toFixed(2),part_moins_15_fac_99.toFixed(2),part_moins_15_fra_99.toFixed(2)];
					barChartData2.datasets[1].data = [part_p_1529_com_99.toFixed(2),part_p_1529_epci_99.toFixed(2),part_p_1529_dep_99.toFixed(2),part_p_1529_fac_99.toFixed(2),part_p_1529_fra_99.toFixed(2)];
					barChartData2.datasets[2].data = [part_p_3044_com_99.toFixed(2),part_p_3044_epci_99.toFixed(2),part_p_3044_dep_99.toFixed(2),part_p_3044_fac_99.toFixed(2),part_p_3044_fra_99.toFixed(2)];
					barChartData2.datasets[3].data = [part_p_4559_com_99.toFixed(2),part_p_4559_epci_99.toFixed(2),part_p_4559_dep_99.toFixed(2),part_p_4559_fac_99.toFixed(2),part_p_4559_fra_99.toFixed(2)];
					barChartData2.datasets[4].data = [part_p_6074_com_99.toFixed(2),part_p_6074_epci_99.toFixed(2),part_p_6074_dep_99.toFixed(2),part_p_6074_fac_99.toFixed(2),part_p_6074_fra_99.toFixed(2)];
					barChartData2.datasets[5].data = [part_p_75P_com_99.toFixed(2),part_p_75P_epci_99.toFixed(2),part_p_75P_dep_99.toFixed(2),part_p_75P_fac_99.toFixed(2),part_p_75P_fra_99.toFixed(2)];
					window.myBar2.options.title.text = 'Structure par âge de la population en 1999 (part en %)';
				break;
				
				case '2010' : 
					barChartData2.datasets[0].data = [part_moins_15_com_10.toFixed(2),part_moins_15_epci_10.toFixed(2),part_moins_15_dep_10.toFixed(2),part_moins_15_fac_10.toFixed(2),part_moins_15_fra_10.toFixed(2)];
					barChartData2.datasets[1].data = [part_p_1529_com_10.toFixed(2),part_p_1529_epci_10.toFixed(2),part_p_1529_dep_10.toFixed(2),part_p_1529_fac_10.toFixed(2),part_p_1529_fra_10.toFixed(2)];
					barChartData2.datasets[2].data = [part_p_3044_com_10.toFixed(2),part_p_3044_epci_10.toFixed(2),part_p_3044_dep_10.toFixed(2),part_p_3044_fac_10.toFixed(2),part_p_3044_fra_10.toFixed(2)];
					barChartData2.datasets[3].data = [part_p_4559_com_10.toFixed(2),part_p_4559_epci_10.toFixed(2),part_p_4559_dep_10.toFixed(2),part_p_4559_fac_10.toFixed(2),part_p_4559_fra_10.toFixed(2)];
					barChartData2.datasets[4].data = [part_p_6074_com_10.toFixed(2),part_p_6074_epci_10.toFixed(2),part_p_6074_dep_10.toFixed(2),part_p_6074_fac_10.toFixed(2),part_p_6074_fra_10.toFixed(2)];
					barChartData2.datasets[5].data = [part_p_75P_com_10.toFixed(2),part_p_75P_epci_10.toFixed(2),part_p_75P_dep_10.toFixed(2),part_p_75P_fac_10.toFixed(2),part_p_75P_fra_10.toFixed(2)];
				window.myBar2.options.title.text = 'Structure par âge de la population en 2010 (part en %)';
				break;
						
				case '2016' : 
				barChartData2.datasets[0].data = [part_moins_15_com_16.toFixed(2),part_moins_15_epci_16.toFixed(2),part_moins_15_dep_16.toFixed(2),part_moins_15_fac_16.toFixed(2),part_moins_15_fra_16.toFixed(2)];
					barChartData2.datasets[1].data = [part_p_1529_com_16.toFixed(2),part_p_1529_epci_16.toFixed(2),part_p_1529_dep_16.toFixed(2),part_p_1529_fac_16.toFixed(2),part_p_1529_fra_16.toFixed(2)];
					barChartData2.datasets[2].data = [part_p_3044_com_16.toFixed(2),part_p_3044_epci_16.toFixed(2),part_p_3044_dep_16.toFixed(2),part_p_3044_fac_16.toFixed(2),part_p_3044_fra_16.toFixed(2)];
					barChartData2.datasets[3].data = [part_p_4559_com_16.toFixed(2),part_p_4559_epci_16.toFixed(2),part_p_4559_dep_16.toFixed(2),part_p_4559_fac_16.toFixed(2),part_p_4559_fra_16.toFixed(2)];
					barChartData2.datasets[4].data = [part_p_6074_com_16.toFixed(2),part_p_6074_epci_16.toFixed(2),part_p_6074_dep_16.toFixed(2),part_p_6074_fac_16.toFixed(2),part_p_6074_fra_16.toFixed(2)];
					barChartData2.datasets[5].data = [part_p_75P_com_16.toFixed(2),part_p_75P_epci_16.toFixed(2),part_p_75P_dep_16.toFixed(2),part_p_75P_fac_16.toFixed(2),part_p_75P_fra_16.toFixed(2)];
				window.myBar2.options.title.text = 'Structure par âge de la population en 2016 (part en %)';
				break;
				
			}



				barChartData2.labels = [nomcom,['',epci],depart,['',facade],'France'];
				window.myBar2.update();
		
				//window.myBar2.options.title.text = 'Structure par âge de la population (part en %)';
				window.myBar2.update();

			break;
			
			
			
			
			
			
			
			case '3': // Part de l'emploi présentiel
			
				////////////// COMMUNE
			
				var nouvelleData = [json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_1999,json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_2009,json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_2014]; 
			
				////////////// EPCI

				var emp_t_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_1999;
				var emp_r_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_2009;
				var emp_r_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_2014;
				var prt_em_epci99 = (emp_r_epci_99/emp_t_epci_99)*100;
				var prt_em_epci09 = (emp_r_epci_09/emp_t_epci_09)*100;
				var prt_em_epci14 = (emp_r_epci_14/emp_t_epci_14)*100;
				var epci_graphe = [prt_em_epci99.toFixed(2),prt_em_epci09.toFixed(2),prt_em_epci14.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var emp_t_depart_99 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_depart_09 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_depart_14 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_depart_99 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_1999;
				var emp_r_depart_09 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_2009;
				var emp_r_depart_14 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_2014;
				var prt_em_depart99 = (emp_r_depart_99/emp_t_depart_99)*100;
				var prt_em_depart09 = (emp_r_depart_09/emp_t_depart_09)*100;
				var prt_em_depart14 = (emp_r_depart_14/emp_t_depart_14)*100;
				var depart_data = [prt_em_depart99.toFixed(2),prt_em_depart09.toFixed(2),prt_em_depart14.toFixed(2)]; 
				
				////////////// FACADE LITTORALE 
				
				var emp_t_facade_99 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_facade_09 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_facade_14 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_facade_99 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_1999;
				var emp_r_facade_09 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_2009;
				var emp_r_facade_14 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_2014;
				var prt_em_facade99 = (emp_r_facade_99/emp_t_facade_99)*100;
				var prt_em_facade09 = (emp_r_facade_09/emp_t_facade_09)*100;
				var prt_em_facade14 = (emp_r_facade_14/emp_t_facade_14)*100;
				var facade_data = [prt_em_facade99.toFixed(2),prt_em_facade09.toFixed(2),prt_em_facade14.toFixed(2)]; 
				
				
				////////////// FRANCE
				
				var emp_t_fra_99 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fra_09 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fra_14 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_fra_99 = france_data_t.features[0].properties.Nb_emploi_résidentiel_1999;
				var emp_r_fra_09 = france_data_t.features[0].properties.Nb_emploi_résidentiel_2009;
				var emp_r_fra_14 = france_data_t.features[0].properties.Nb_emploi_résidentiel_2014;
				var prt_em_fra99 = (emp_r_fra_99/emp_t_fra_99)*100;
				var prt_em_fra09 = (emp_r_fra_09/emp_t_fra_09)*100;
				var prt_em_fra14 = (emp_r_fra_14/emp_t_fra_14)*100;
				var fra_data = [prt_em_fra99.toFixed(2),prt_em_fra09.toFixed(2),prt_em_fra14.toFixed(2)]; 
				
				barChartData2.datasets[0].data = nouvelleData;  
				barChartData2.datasets[1].data = epci_graphe;
				barChartData2.datasets[2].data = depart_data;
				barChartData2.datasets[3].data = facade_data;
				barChartData2.datasets[4].data = fra_data;
				barChartData2.labels = ['1999', '2009', '2014'];
				window.myBar2.update();
		
				window.myBar2.options.title.text = 'Part des emplois de la sphère résidentielle dans l\'emploi total (%)';
				barChartData2.datasets[0].label = nomcom;
				barChartData2.datasets[1].label = "Moyenne " + epci;
				barChartData2.datasets[2].label = "Moyenne " + depart;
				window.myBar2.update();
			
			
			break;
			
			
			
			
			
			
			
			case '4': // Nombre d'emplois au lieu de travail
				////////////// COMMUNE
			
				var pop_com99 = json_donnees_finales.features[indexcom_d].properties.Pop_1999;
				var pop_com10 = json_donnees_finales.features[indexcom_d].properties.Pop_2010;
				var pop_com15 = json_donnees_finales.features[indexcom_d].properties.Pop_2015;
				var emp_t_com_99 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_com_09 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_com_14 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_com99 = (emp_t_com_99/pop_com99);
				var em_ph_com09 = (emp_t_com_09/pop_com10);
				var em_ph_com14 = (emp_t_com_14/pop_com15);
				var nouvelleData = [em_ph_com99.toFixed(2),em_ph_com09.toFixed(2),em_ph_com14.toFixed(2)]; 

				////////////// EPCI

				var pop_epci99 = epci_data.features[indexepci].properties.Pop_1999;
				var pop_epci10 = epci_data.features[indexepci].properties.Pop_2010;
				var pop_epci15 = epci_data.features[indexepci].properties.Pop_2015;
				var emp_t_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_epci99 = (emp_t_epci_99/pop_epci99);
				var em_ph_epci09 = (emp_t_epci_09/pop_epci10);
				var em_ph_epci14 = (emp_t_epci_14/pop_epci15);
				var epci_graphe = [em_ph_epci99.toFixed(2),em_ph_epci09.toFixed(2),em_ph_epci14.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var pop_dep99 = dep_data_t.features[indexdep].properties.Pop_1999;
				var pop_dep10 = dep_data_t.features[indexdep].properties.Pop_2010;
				var pop_dep15 = dep_data_t.features[indexdep].properties.Pop_2015;
				var emp_t_dep_99 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_dep_09 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_dep_14 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_dep99 = (emp_t_dep_99/pop_dep99);
				var em_ph_dep09 = (emp_t_dep_09/pop_dep10);
				var em_ph_dep14 = (emp_t_dep_14/pop_dep15);
				var depart_data = [em_ph_dep99.toFixed(2),em_ph_dep09.toFixed(2),em_ph_dep14.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var pop_fac99 = facade_data_t.features[indexfac].properties.Pop_1999;
				var pop_fac10 = facade_data_t.features[indexfac].properties.Pop_2010;
				var pop_fac15 = facade_data_t.features[indexfac].properties.Pop_2015;
				var emp_t_fac_99 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fac_09 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fac_14 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_fac99 = (emp_t_fac_99/pop_fac99);
				var em_ph_fac09 = (emp_t_fac_09/pop_fac10);
				var em_ph_fac14 = (emp_t_fac_14/pop_fac15);
				var facade_data = [em_ph_fac99.toFixed(2),em_ph_fac09.toFixed(2),em_ph_fac14.toFixed(2)];
				
				
				////////////// FRANCE
				
				var pop_fra99 = france_data_t.features[0].properties.Pop_1999;
				var pop_fra10 = france_data_t.features[0].properties.Pop_2010;
				var pop_fra15 = france_data_t.features[0].properties.Pop_2015;
				var emp_t_fra_99 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fra_09 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fra_14 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_fra99 = (emp_t_fra_99/pop_fra99);
				var em_ph_fra09 = (emp_t_fra_09/pop_fra10);
				var em_ph_fra14 = (emp_t_fra_14/pop_fra15);
				var fra_data = [em_ph_fra99.toFixed(2),em_ph_fra09.toFixed(2),em_ph_fra14.toFixed(2)];
				
				barChartData2.datasets[0].data = nouvelleData; 
				barChartData2.datasets[1].data = epci_graphe;
				barChartData2.datasets[2].data = depart_data;
				barChartData2.datasets[3].data = facade_data;
				barChartData2.datasets[4].data = fra_data;
				barChartData2.labels = ['1999', '2009', '2014'];
				window.myBar2.update();
		
				window.myBar2.options.title.text = 'Nombre d\'emplois au lieu de travail (emplois/hab)';
				barChartData2.datasets[0].label = nomcom;
				barChartData2.datasets[1].label = "Moyenne " + epci;
				barChartData2.datasets[2].label = "Moyenne " + depart;
				window.myBar2.update();
						
			
			
			break;
			
			
			
			
			
			
			
			case '5': // Artificialisation
				
				////////////// COMMUNE
			
				var artif_com00 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2000;
				var artif_com06 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2006;
				var artif_com12 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2012;
				var surf_com = json_donnees_finales.features[indexcom_d].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_com00 = (artif_com00/surf_com)*100;
				var prct_artif_com06 = (artif_com06/surf_com)*100;
				var prct_artif_com12 = (artif_com12/surf_com)*100;
				var nouvelleData = [prct_artif_com00.toFixed(2),prct_artif_com06.toFixed(2),prct_artif_com12.toFixed(2)]; 

				////////////// EPCI

				var artif_epci00 = epci_data.features[indexepci].properties.SURF_ARTIF_2000;
				var artif_epci06 = epci_data.features[indexepci].properties.SURF_ARTIF_2006;
				var artif_epci12 = epci_data.features[indexepci].properties.SURF_ARTIF_2012;
				var surf_epci = epci_data.features[indexepci].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_epci00 = (artif_epci00/surf_epci)*100;
				var prct_artif_epci06 = (artif_epci06/surf_epci)*100;
				var prct_artif_epci12 = (artif_epci12/surf_epci)*100;
				var epci_graphe = [prct_artif_epci00.toFixed(2),prct_artif_epci06.toFixed(2),prct_artif_epci12.toFixed(2)]; // Valeur d'évolution de la population de la commune

				
				////////////// DEPARTEMENT
				
				var artif_dep00 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2000;
				var artif_dep06 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2006;
				var artif_dep12 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2012;
				var surf_dep = dep_data_t.features[indexdep].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_dep00 = (artif_dep00/surf_dep)*100;
				var prct_artif_dep06 = (artif_dep06/surf_dep)*100;
				var prct_artif_dep12 = (artif_dep12/surf_dep)*100;
				var depart_data = [prct_artif_dep00.toFixed(2),prct_artif_dep06.toFixed(2),prct_artif_dep12.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var artif_fac00 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2000;
				var artif_fac06 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2006;
				var artif_fac12 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2012;
				var surf_fac = facade_data_t.features[indexfac].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_fac00 = (artif_fac00/surf_fac)*100;
				var prct_artif_fac06 = (artif_fac06/surf_fac)*100;
				var prct_artif_fac12 = (artif_fac12/surf_fac)*100;
				var facade_data = [prct_artif_fac00.toFixed(2),prct_artif_fac06.toFixed(2),prct_artif_fac12.toFixed(2)];
				
				
				////////////// FRANCE
				
				var artif_fra00 = france_data_t.features[0].properties.SURF_ARTIF_2000;
				var artif_fra06 = france_data_t.features[0].properties.SURF_ARTIF_2006;
				var artif_fra12 = france_data_t.features[0].properties.SURF_ARTIF_2012;
				var surf_fra = france_data_t.features[0].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_fra00 = (artif_fra00/surf_fra)*100;
				var prct_artif_fra06 = (artif_fra06/surf_fra)*100;
				var prct_artif_fra12 = (artif_fra12/surf_fra)*100;
				var fra_data = [prct_artif_fra00.toFixed(2),prct_artif_fra06.toFixed(2),prct_artif_fra12.toFixed(2)];
				
				barChartData2.datasets[0].data = nouvelleData; 
				barChartData2.datasets[1].data = epci_graphe;
				barChartData2.datasets[2].data = depart_data;
				barChartData2.datasets[3].data = facade_data;
				barChartData2.datasets[4].data = fra_data;
				barChartData2.labels = ['2000', '2006', '2012'];
				window.myBar2.update();
		
				window.myBar2.options.title.text = 'Part des espaces artificialisés sur le territoire communal (%)';
				barChartData2.datasets[0].label = nomcom;
				barChartData2.datasets[1].label = "Moyenne " + epci;
				barChartData2.datasets[2].label = "Moyenne " + depart;
				window.myBar2.update();
			
			break;
			
			
			
			
			
			
			
			case '6': // Part des résidences secondaires
			
				////////////// COMMUNE
			
				var nb_log_com99 = sec_com.features[indexcom_r].properties.NB_LOG_1999;
				var nb_log_com11 = sec_com.features[indexcom_r].properties.NB_LOG_2011;
				var nb_log_com16 = sec_com.features[indexcom_r].properties.NB_LOG_2016;
				var nb_sec_com99 = sec_com.features[indexcom_r].properties.NB_SEC_1999;
				var nb_sec_com11 = sec_com.features[indexcom_r].properties.NB_SEC_2011;
				var nb_sec_com16 = sec_com.features[indexcom_r].properties.NB_SEC_2016;	
				var prct_sec_com_99 = (nb_sec_com99 / nb_log_com99 ) * 100;
				var prct_sec_com_11 = (nb_sec_com11 / nb_log_com11 ) * 100;
				var prct_sec_com_16 = (nb_sec_com16 / nb_log_com16 ) * 100;
				var nouvelleData = [prct_sec_com_99.toFixed(2),prct_sec_com_11.toFixed(2),prct_sec_com_16.toFixed(2)];

				////////////// EPCI

				var nb_log_epci99 = sec_epci.features[indexepci_r].properties.NB_LOG_1999;
				var nb_log_epci11 = sec_epci.features[indexepci_r].properties.NB_LOG_2011;
				var nb_log_epci16 = sec_epci.features[indexepci_r].properties.NB_LOG_2016;
				var nb_sec_epci99 = sec_epci.features[indexepci_r].properties.NB_SEC_1999;
				var nb_sec_epci11 = sec_epci.features[indexepci_r].properties.NB_SEC_2011;
				var nb_sec_epci16 = sec_epci.features[indexepci_r].properties.NB_SEC_2016;	
				var prct_sec_epci_99 = (nb_sec_epci99 / nb_log_epci99 ) * 100;
				var prct_sec_epci_11 = (nb_sec_epci11 / nb_log_epci11 ) * 100;
				var prct_sec_epci_16 = (nb_sec_epci16 / nb_log_epci16 ) * 100;
				var epci_graphe = [prct_sec_epci_99.toFixed(2),prct_sec_epci_11.toFixed(2),prct_sec_epci_16.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var nb_log_dep99 = sec_dep.features[indexdep_r].properties.NB_LOG_1999;
				var nb_log_dep11 = sec_dep.features[indexdep_r].properties.NB_LOG_2011;
				var nb_log_dep16 = sec_dep.features[indexdep_r].properties.NB_LOG_2016;
				var nb_sec_dep99 = sec_dep.features[indexdep_r].properties.NB_SEC_1999;
				var nb_sec_dep11 = sec_dep.features[indexdep_r].properties.NB_SEC_2011;
				var nb_sec_dep16 = sec_dep.features[indexdep_r].properties.NB_SEC_2016;	
				var prct_sec_dep_99 = (nb_sec_dep99 / nb_log_dep99 ) * 100;
				var prct_sec_dep_11 = (nb_sec_dep11 / nb_log_dep11 ) * 100;
				var prct_sec_dep_16 = (nb_sec_dep16 / nb_log_dep16 ) * 100;
				var depart_data = [prct_sec_dep_99.toFixed(2),prct_sec_dep_11.toFixed(2),prct_sec_dep_16.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var nb_log_fac99 = sec_fac.features[indexfac_r].properties.NB_LOG_1999;
				var nb_log_fac11 = sec_fac.features[indexfac_r].properties.NB_LOG_2011;
				var nb_log_fac16 = sec_fac.features[indexfac_r].properties.NB_LOG_2016;
				var nb_sec_fac99 = sec_fac.features[indexfac_r].properties.NB_SEC_1999;
				var nb_sec_fac11 = sec_fac.features[indexfac_r].properties.NB_SEC_2011;
				var nb_sec_fac16 = sec_fac.features[indexfac_r].properties.NB_SEC_2016;	
				var prct_sec_fac_99 = (nb_sec_fac99 / nb_log_fac99 ) * 100;
				var prct_sec_fac_11 = (nb_sec_fac11 / nb_log_fac11 ) * 100;
				var prct_sec_fac_16 = (nb_sec_fac16 / nb_log_fac16 ) * 100;
				var facade_data = [prct_sec_fac_99.toFixed(2),prct_sec_fac_11.toFixed(2),prct_sec_fac_16.toFixed(2)];
				
				
				////////////// FRANCE
				
				var nb_log_fra99 = sec_fra.features[0].properties.NB_LOG_1999;
				var nb_log_fra11 = sec_fra.features[0].properties.NB_LOG_2011;
				var nb_log_fra16 = sec_fra.features[0].properties.NB_LOG_2016;
				var nb_sec_fra99 = sec_fra.features[0].properties.NB_SEC_1999;
				var nb_sec_fra11 = sec_fra.features[0].properties.NB_SEC_2011;
				var nb_sec_fra16 = sec_fra.features[0].properties.NB_SEC_2016;	
				var prct_sec_fra_99 = (nb_sec_fra99 / nb_log_fra99 ) * 100;
				var prct_sec_fra_11 = (nb_sec_fra11 / nb_log_fra11 ) * 100;
				var prct_sec_fra_16 = (nb_sec_fra16 / nb_log_fra16 ) * 100;
				var fra_data = [prct_sec_fra_99.toFixed(2),prct_sec_fra_11.toFixed(2),prct_sec_fra_16.toFixed(2)];
				
				barChartData2.datasets[0].data = nouvelleData; 
				barChartData2.datasets[1].data = epci_graphe;
				barChartData2.datasets[2].data = depart_data;
				barChartData2.datasets[3].data = facade_data;
				barChartData2.datasets[4].data = fra_data;
				barChartData2.labels = ['1999', '2011', '2016'];
				window.myBar2.update();
		
				window.myBar2.options.title.text = 'Part des résidences secondaires dans le total des logements (%)';
				barChartData2.datasets[0].label = nomcom;
				barChartData2.datasets[1].label = "Moyenne " + epci;
				barChartData2.datasets[2].label = "Moyenne " + depart;
				window.myBar2.update();
						
			
			
			break;
			
			
			
			
			
			
			
			
			case '7': // Composition parc de logements
			
					while (barChartData2.datasets.length > 0 ){
						barChartData2.datasets.pop(); 
					}
			
			
				barChartData2.datasets.push({label : ' Maison avant 1991 ', backgroundColor: window.chartColors.green, stack : 'Stack 1', data : [1,1,1,2,1]});
				barChartData2.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [3,1,2,2,1]});
				barChartData2.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.blue, stack : 'Stack 1', data : [3,1,2,3,1]});
				barChartData2.datasets.push({label : ' Appartement avant 1991 ', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData2.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.grey, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData2.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData2.datasets.push({label : ' Autre avant 1991 ', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,4,3]});
				barChartData2.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.grey, stack : 'Stack 1', data : [3,1,2,2,3]});
				barChartData2.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,2,2]});


				////////////// Maison avant 1991

				var m_av_91_com = json_donnees_finales.features[indexcom_d].properties.MAISON_AVT91;
				var m_av_91_epci = epci_data.features[indexepci].properties.MAISON_AVT91;
				var m_av_91_dep = dep_data_t.features[indexdep].properties.MAISON_AVT91;
				var m_av_91_fac = facade_data_t.features[indexfac].properties.MAISON_AVT91;
				var m_av_91_fra = france_data_t.features[0].properties.MAISON_AVT91;


				////////////// Maison 1991 - 2005

				var m_9105_com = json_donnees_finales.features[indexcom_d].properties.MAISON_9105;
				var m_9105_epci = epci_data.features[indexepci].properties.MAISON_9105;
				var m_9105_dep = dep_data_t.features[indexdep].properties.MAISON_9105;
				var m_9105_fac = facade_data_t.features[indexfac].properties.MAISON_9105;
				var m_9105_fra = france_data_t.features[0].properties.MAISON_9105;

				////////////// Maison 2006 - 2013
	
				var m_0613_com = json_donnees_finales.features[indexcom_d].properties.MAISON_0613;
				var m_0613_epci = epci_data.features[indexepci].properties.MAISON_0613;
				var m_0613_dep = dep_data_t.features[indexdep].properties.MAISON_0613;
				var m_0613_fac = facade_data_t.features[indexfac].properties.MAISON_0613;
				var m_0613_fra = france_data_t.features[0].properties.MAISON_0613;
				
				////////////// Appartement avant 1991

				var ap_av_91_com = json_donnees_finales.features[indexcom_d].properties.APPART_AVT91;
				var ap_av_91_epci = epci_data.features[indexepci].properties.APPART_AVT91;
				var ap_av_91_dep = dep_data_t.features[indexdep].properties.APPART_AVT91;
				var ap_av_91_fac = facade_data_t.features[indexfac].properties.APPART_AVT91;
				var ap_av_91_fra = france_data_t.features[0].properties.APPART_AVT91;

				////////////// Appartement 1991 - 2005

				var ap_9105_com = json_donnees_finales.features[indexcom_d].properties.APPART_9105;
				var ap_9105_epci = epci_data.features[indexepci].properties.APPART_9105;
				var ap_9105_dep = dep_data_t.features[indexdep].properties.APPART_9105;
				var ap_9105_fac = facade_data_t.features[indexfac].properties.APPART_9105;
				var ap_9105_fra = france_data_t.features[0].properties.APPART_9105;


				////////////// Appartement 2006 - 2013
				
				var ap_0613_com = json_donnees_finales.features[indexcom_d].properties.APPART_0613;
				var ap_0613_epci = epci_data.features[indexepci].properties.APPART_0613;
				var ap_0613_dep = dep_data_t.features[indexdep].properties.APPART_0613;
				var ap_0613_fac = facade_data_t.features[indexfac].properties.APPART_0613;
				var ap_0613_fra = france_data_t.features[0].properties.APPART_0613;		
				
				
				////////////// Autre avant 1991
				
				var au_av_91_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_AVT91;
				var au_av_91_epci = epci_data.features[indexepci].properties.AUTRE_AVT91;
				var au_av_91_dep = dep_data_t.features[indexdep].properties.AUTRE_AVT91;
				var au_av_91_fac = facade_data_t.features[indexfac].properties.AUTRE_AVT91;
				var au_av_91_fra = france_data_t.features[0].properties.AUTRE_AVT91;
				
				
				////////////// Autre 1991 - 2005

				var au_9105_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_9105;
				var au_9105_epci = epci_data.features[indexepci].properties.AUTRE_9105;
				var au_9105_dep = dep_data_t.features[indexdep].properties.AUTRE_9105;
				var au_9105_fac = facade_data_t.features[indexfac].properties.AUTRE_9105;
				var au_9105_fra = france_data_t.features[0].properties.AUTRE_9105;


				////////////// Autre 2006 - 2013		

				var au_0613_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_0613;
				var au_0613_epci = epci_data.features[indexepci].properties.AUTRE_0613;
				var au_0613_dep = dep_data_t.features[indexdep].properties.AUTRE_0613;
				var au_0613_fac = facade_data_t.features[indexfac].properties.AUTRE_0613;
				var au_0613_fra = france_data_t.features[0].properties.AUTRE_0613;

				///////////// Nombre de logements 
				
				var nb_log_com = m_av_91_com + m_9105_com + m_0613_com + ap_av_91_com + ap_9105_com + ap_0613_com, au_av_91_com, au_9105_com, au_0613_com;
				var nb_log_epci = m_av_91_epci + m_9105_epci + m_0613_epci + ap_av_91_epci + ap_9105_epci + ap_0613_epci, au_av_91_epci, au_9105_epci, au_0613_epci;
				var nb_log_dep = m_av_91_dep + m_9105_dep + m_0613_dep + ap_av_91_dep + ap_9105_dep + ap_0613_dep, au_av_91_dep, au_9105_dep, au_0613_dep;
				var nb_log_fac = m_av_91_fac + m_9105_fac + m_0613_fac + ap_av_91_fac + ap_9105_fac + ap_0613_fac, au_av_91_fac, au_9105_fac, au_0613_fac;
				var nb_log_fra = m_av_91_fra + m_9105_fra + m_0613_fra + ap_av_91_fra + ap_9105_fra + ap_0613_fra, au_av_91_fra, au_9105_fra, au_0613_fra;

				//////////// Pourcentages maison avant 91 
				
				var p_m_av_91_com = (m_av_91_com / nb_log_com) * 100;
				var p_m_av_91_epci = (m_av_91_epci / nb_log_epci) * 100;
				var p_m_av_91_dep = (m_av_91_dep / nb_log_dep) * 100;
				var p_m_av_91_fac = (m_av_91_fac / nb_log_fac) * 100;
				var p_m_av_91_fra = (m_av_91_fra / nb_log_fra) * 100;
				
				barChartData2.datasets[0].data = [p_m_av_91_com.toFixed(2),p_m_av_91_epci.toFixed(2),p_m_av_91_dep.toFixed(2),p_m_av_91_fac.toFixed(2),p_m_av_91_fra.toFixed(2)];

				//////////// Pourcentages maison 1991 - 2005 
				
				var p_m_9105_com = (m_9105_com / nb_log_com) * 100;
				var p_m_9105_epci = (m_9105_epci / nb_log_epci) * 100;
				var p_m_9105_dep = (m_9105_dep / nb_log_dep) * 100;
				var p_m_9105_fac = (m_9105_fac / nb_log_fac) * 100;
				var p_m_9105_fra = (m_9105_fra / nb_log_fra) * 100;
				
				barChartData2.datasets[1].data = [p_m_9105_com.toFixed(2),p_m_9105_epci.toFixed(2),p_m_9105_dep.toFixed(2),p_m_9105_fac.toFixed(2),p_m_9105_fra.toFixed(2)];

				//////////// Pourcentages maison 2006 - 2013
				
				var p_m_0613_com = (m_0613_com / nb_log_com) * 100;
				var p_m_0613_epci = (m_0613_epci / nb_log_epci) * 100;
				var p_m_0613_dep = (m_0613_dep / nb_log_dep) * 100;
				var p_m_0613_fac = (m_0613_fac / nb_log_fac) * 100;
				var p_m_0613_fra = (m_0613_fra / nb_log_fra) * 100;
				
				barChartData2.datasets[2].data = [p_m_0613_com.toFixed(2),p_m_0613_epci.toFixed(2),p_m_0613_dep.toFixed(2),p_m_0613_fac.toFixed(2),p_m_0613_fra.toFixed(2)];

				//////////// Pourcentages appartement avant 1991

				var p_ap_av_91_com = (ap_av_91_com / nb_log_com) * 100;
				var p_ap_av_91_epci = (ap_av_91_epci / nb_log_epci) * 100;
				var p_ap_av_91_dep = (ap_av_91_dep / nb_log_dep) * 100;
				var p_ap_av_91_fac = (ap_av_91_fac / nb_log_fac) * 100;
				var p_ap_av_91_fra = (ap_av_91_fra / nb_log_fra) * 100;
				
				barChartData2.datasets[3].data = [p_ap_av_91_com.toFixed(2),p_ap_av_91_epci.toFixed(2),p_ap_av_91_dep.toFixed(2),p_ap_av_91_fac.toFixed(2),p_ap_av_91_fra.toFixed(2)];

				//////////// Pourcentages appartement 1991 - 2005 
				
				var p_ap_9105_com = (ap_9105_com / nb_log_com) * 100;
				var p_ap_9105_epci = (ap_9105_epci / nb_log_epci) * 100;
				var p_ap_9105_dep = (ap_9105_dep / nb_log_dep) * 100;
				var p_ap_9105_fac = (ap_9105_fac / nb_log_fac) * 100;
				var p_ap_9105_fra = (ap_9105_fra / nb_log_fra) * 100;
				
				barChartData2.datasets[4].data = [p_ap_9105_com.toFixed(2),p_ap_9105_epci.toFixed(2),p_ap_9105_dep.toFixed(2),p_ap_9105_fac.toFixed(2),p_ap_9105_fra.toFixed(2)];

				//////////// Pourcentages appartement 2006 - 2013
				
				var p_ap_0613_com = (ap_0613_com / nb_log_com) * 100;
				var p_ap_0613_epci = (ap_0613_epci / nb_log_epci) * 100;
				var p_ap_0613_dep = (ap_0613_dep / nb_log_dep) * 100;
				var p_ap_0613_fac = (ap_0613_fac / nb_log_fac) * 100;
				var p_ap_0613_fra = (ap_0613_fra / nb_log_fra) * 100;
				
				barChartData2.datasets[5].data = [p_ap_0613_com.toFixed(2),p_ap_0613_epci.toFixed(2),p_ap_0613_dep.toFixed(2),p_ap_0613_fac.toFixed(2),p_ap_0613_fra.toFixed(2)];

				//////////// Pourcentages autres avant 91 
				
				var p_au_av_91_com = (au_av_91_com / nb_log_com) * 100;
				var p_au_av_91_epci = (au_av_91_epci / nb_log_epci) * 100;
				var p_au_av_91_dep = (au_av_91_dep / nb_log_dep) * 100;
				var p_au_av_91_fac = (au_av_91_fac / nb_log_fac) * 100;
				var p_au_av_91_fra = (au_av_91_fra / nb_log_fra) * 100;
				
				barChartData2.datasets[6].data = [p_au_av_91_com.toFixed(2),p_au_av_91_epci.toFixed(2),p_au_av_91_dep.toFixed(2),p_au_av_91_fac.toFixed(2),p_au_av_91_fra.toFixed(2)];

				//////////// Pourcentages autres 1991 - 2005 
				
				var p_au_9105_com = (au_9105_com / nb_log_com) * 100;
				var p_au_9105_epci = (au_9105_epci / nb_log_epci) * 100;
				var p_au_9105_dep = (au_9105_dep / nb_log_dep) * 100;
				var p_au_9105_fac = (au_9105_fac / nb_log_fac) * 100;
				var p_au_9105_fra = (au_9105_fra / nb_log_fra) * 100;
				
				barChartData2.datasets[7].data = [p_au_9105_com.toFixed(2),p_au_9105_epci.toFixed(2),p_au_9105_dep.toFixed(2),p_au_9105_fac.toFixed(2),p_au_9105_fra.toFixed(2)];

				//////////// Pourcentages autres 2006 - 2013
				
				var p_au_0613_com = (au_0613_com / nb_log_com) * 100;
				var p_au_0613_epci = (au_0613_epci / nb_log_epci) * 100;
				var p_au_0613_dep = (au_0613_dep / nb_log_dep) * 100;
				var p_au_0613_fac = (au_0613_fac / nb_log_fac) * 100;
				var p_au_0613_fra = (au_0613_fra / nb_log_fra) * 100;
				
				barChartData2.datasets[8].data = [p_au_0613_com.toFixed(2),p_au_0613_epci.toFixed(2),p_au_0613_dep.toFixed(2),p_au_0613_fac.toFixed(2),p_au_0613_fra.toFixed(2)];

				barChartData2.datasets[0].backgroundColor = "#21618c";
				barChartData2.datasets[1].backgroundColor = "#3498db";
				barChartData2.datasets[2].backgroundColor = "#85c1e9";
				
				barChartData2.datasets[3].backgroundColor = "#e74c3c";
				barChartData2.datasets[4].backgroundColor = "#ec7063";
				barChartData2.datasets[5].backgroundColor = "#f5b7b1";
				
				barChartData2.datasets[6].backgroundColor = "#186a3b";
				barChartData2.datasets[7].backgroundColor = "#2ecc71";
				barChartData2.datasets[8].backgroundColor = "#82e0aa";

				barChartData2.labels = [nomcom, ['',epci], depart, ['',facade], 'France'];
				window.myBar2.update();
		
				window.myBar2.options.title.text = 'Composition du parc de logements en 2016 (parts en %)';
				window.myBar2.update();
						
						
			
			break;
			
			
			
			
			
			
			
			case '8': // Part des impôts ménages
			
				////////////// COMMUNE
			
				var fnb_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_0203);
				var fb_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.FB_0203);
				var th_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.TH_0203);
				var tp_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.TP_0203);
				
				var fnb_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_0910);
				var fb_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.FB_0910);
				var th_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.TH_0910);
				var tp_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.TP_0910);
				
				var fnb_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_1112);
				var fb_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.FB_1112);
				var th_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.TH_1112);
				var cfe_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.CFE_1112);
				var cvae_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.CVAE_1112);
				var ifer_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.IFER_1112);
				var tscom_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.TSCOM_1112);
				
				var fnb_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_1516);
				var fb_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.FB_1516);
				var th_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.TH_1516);
				var cfe_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.CFE_1516);
				var cvae_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.CVAE_1516);
				var ifer_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.IFER_1516);
				var tscom_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.TSCOM_1516);
				
				var part_m_com_02 = ((th_com_02 + fb_com_02)/(th_com_02 + fb_com_02 + fnb_com_02 + tp_com_02)) * 100
				var part_m_com_09 = ((th_com_09 + fb_com_09)/(th_com_09 + fb_com_09 + fnb_com_09 + tp_com_09)) * 100				
				var part_m_com_11 = ((th_com_11 + fb_com_11)/(th_com_11 + fb_com_11 + fnb_com_11 + cfe_com_11 + cvae_com_11 + ifer_com_11 + tscom_com_11)) * 100
				var part_m_com_15 = ((th_com_15 + fb_com_15)/(th_com_15 + fb_com_15 + fnb_com_15 + cfe_com_15 + cvae_com_15 + ifer_com_15 + tscom_com_15)) * 100				

				var nouvelleData = [part_m_com_02.toFixed(2),part_m_com_09.toFixed(2),part_m_com_11.toFixed(2),part_m_com_15.toFixed(2)]; 

				////////////// EPCI

				var fnb_epci_02 = Number(epci_data.features[indexepci].properties.FNB_0203);
				var fb_epci_02 = Number(epci_data.features[indexepci].properties.FB_0203);
				var th_epci_02 = Number(epci_data.features[indexepci].properties.TH_0203);
				var tp_epci_02 = Number(epci_data.features[indexepci].properties.TP_0203);
				
				var fnb_epci_09 = Number(epci_data.features[indexepci].properties.FNB_0910);
				var fb_epci_09 = Number(epci_data.features[indexepci].properties.FB_0910);
				var th_epci_09 = Number(epci_data.features[indexepci].properties.TH_0910);
				var tp_epci_09 = Number(epci_data.features[indexepci].properties.TP_0910);
				
				var fnb_epci_11 = Number(epci_data.features[indexepci].properties.FNB_1112);
				var fb_epci_11 = Number(epci_data.features[indexepci].properties.FB_1112);
				var th_epci_11 = Number(epci_data.features[indexepci].properties.TH_1112);
				var cfe_epci_11 = Number(epci_data.features[indexepci].properties.CFE_1112);
				var cvae_epci_11 = Number(epci_data.features[indexepci].properties.CVAE_1112);
				var ifer_epci_11 = Number(epci_data.features[indexepci].properties.IFER_1112);
				var tsepci_epci_11 = Number(epci_data.features[indexepci].properties.TSCOM_1112);
				
				var fnb_epci_15 = Number(epci_data.features[indexepci].properties.FNB_1516);
				var fb_epci_15 = Number(epci_data.features[indexepci].properties.FB_1516);
				var th_epci_15 = Number(epci_data.features[indexepci].properties.TH_1516);
				var cfe_epci_15 = Number(epci_data.features[indexepci].properties.CFE_1516);
				var cvae_epci_15 = Number(epci_data.features[indexepci].properties.CVAE_1516);
				var ifer_epci_15 = Number(epci_data.features[indexepci].properties.IFER_1516);
				var tsepci_epci_15 = Number(epci_data.features[indexepci].properties.TSCOM_1516);
				
				var part_m_epci_02 = ((th_epci_02 + fb_epci_02)/(th_epci_02 + fb_epci_02 + fnb_epci_02 + tp_epci_02)) * 100
				var part_m_epci_09 = ((th_epci_09 + fb_epci_09)/(th_epci_09 + fb_epci_09 + fnb_epci_09 + tp_epci_09)) * 100				
				var part_m_epci_11 = ((th_epci_11 + fb_epci_11)/(th_epci_11 + fb_epci_11 + fnb_epci_11 + cfe_epci_11 + cvae_epci_11 + ifer_epci_11 + tsepci_epci_11)) * 100
				var part_m_epci_15 = ((th_epci_15 + fb_epci_15)/(th_epci_15 + fb_epci_15 + fnb_epci_15 + cfe_epci_15 + cvae_epci_15 + ifer_epci_15 + tsepci_epci_15)) * 100				

				var epci_graphe = [part_m_epci_02.toFixed(2),part_m_epci_09.toFixed(2),part_m_epci_11.toFixed(2),part_m_epci_15.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var fnb_dep_02 = Number(dep_data_t.features[indexdep].properties.FNB_0203);
				var fb_dep_02 = Number(dep_data_t.features[indexdep].properties.FB_0203);
				var th_dep_02 = Number(dep_data_t.features[indexdep].properties.TH_0203);
				var tp_dep_02 = Number(dep_data_t.features[indexdep].properties.TP_0203);
				
				var fnb_dep_09 = Number(dep_data_t.features[indexdep].properties.FNB_0910);
				var fb_dep_09 = Number(dep_data_t.features[indexdep].properties.FB_0910);
				var th_dep_09 = Number(dep_data_t.features[indexdep].properties.TH_0910);
				var tp_dep_09 = Number(dep_data_t.features[indexdep].properties.TP_0910);
				
				var fnb_dep_11 = Number(dep_data_t.features[indexdep].properties.FNB_1112);
				var fb_dep_11 = Number(dep_data_t.features[indexdep].properties.FB_1112);
				var th_dep_11 = Number(dep_data_t.features[indexdep].properties.TH_1112);
				var cfe_dep_11 = Number(dep_data_t.features[indexdep].properties.CFE_1112);
				var cvae_dep_11 = Number(dep_data_t.features[indexdep].properties.CVAE_1112);
				var ifer_dep_11 = Number(dep_data_t.features[indexdep].properties.IFER_1112);
				var tsdep_dep_11 = Number(dep_data_t.features[indexdep].properties.TSCOM_1112);
				
				var fnb_dep_15 = Number(dep_data_t.features[indexdep].properties.FNB_1516);
				var fb_dep_15 = Number(dep_data_t.features[indexdep].properties.FB_1516);
				var th_dep_15 = Number(dep_data_t.features[indexdep].properties.TH_1516);
				var cfe_dep_15 = Number(dep_data_t.features[indexdep].properties.CFE_1516);
				var cvae_dep_15 = Number(dep_data_t.features[indexdep].properties.CVAE_1516);
				var ifer_dep_15 = Number(dep_data_t.features[indexdep].properties.IFER_1516);
				var tsdep_dep_15 = Number(dep_data_t.features[indexdep].properties.TSCOM_1516);
				
				var part_m_dep_02 = ((th_dep_02 + fb_dep_02)/(th_dep_02 + fb_dep_02 + fnb_dep_02 + tp_dep_02)) * 100
				var part_m_dep_09 = ((th_dep_09 + fb_dep_09)/(th_dep_09 + fb_dep_09 + fnb_dep_09 + tp_dep_09)) * 100				
				var part_m_dep_11 = ((th_dep_11 + fb_dep_11)/(th_dep_11 + fb_dep_11 + fnb_dep_11 + cfe_dep_11 + cvae_dep_11 + ifer_dep_11 + tsdep_dep_11)) * 100
				var part_m_dep_15 = ((th_dep_15 + fb_dep_15)/(th_dep_15 + fb_dep_15 + fnb_dep_15 + cfe_dep_15 + cvae_dep_15 + ifer_dep_15 + tsdep_dep_15)) * 100				

				var depart_data = [part_m_dep_02.toFixed(2),part_m_dep_09.toFixed(2),part_m_dep_11.toFixed(2),part_m_dep_15.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var fnb_facade_02 = Number(facade_data_t.features[indexfac].properties.FNB_0203);
				var fb_facade_02 = Number(facade_data_t.features[indexfac].properties.FB_0203);
				var th_facade_02 = Number(facade_data_t.features[indexfac].properties.TH_0203);
				var tp_facade_02 = Number(facade_data_t.features[indexfac].properties.TP_0203);
				
				var fnb_facade_09 = Number(facade_data_t.features[indexfac].properties.FNB_0910);
				var fb_facade_09 = Number(facade_data_t.features[indexfac].properties.FB_0910);
				var th_facade_09 = Number(facade_data_t.features[indexfac].properties.TH_0910);
				var tp_facade_09 = Number(facade_data_t.features[indexfac].properties.TP_0910);
				
				var fnb_facade_11 = Number(facade_data_t.features[indexfac].properties.FNB_1112);
				var fb_facade_11 = Number(facade_data_t.features[indexfac].properties.FB_1112);
				var th_facade_11 = Number(facade_data_t.features[indexfac].properties.TH_1112);
				var cfe_facade_11 = Number(facade_data_t.features[indexfac].properties.CFE_1112);
				var cvae_facade_11 = Number(facade_data_t.features[indexfac].properties.CVAE_1112);
				var ifer_facade_11 = Number(facade_data_t.features[indexfac].properties.IFER_1112);
				var tsfacade_facade_11 = Number(facade_data_t.features[indexfac].properties.TSCOM_1112);
				
				var fnb_facade_15 = Number(facade_data_t.features[indexfac].properties.FNB_1516);
				var fb_facade_15 = Number(facade_data_t.features[indexfac].properties.FB_1516);
				var th_facade_15 = Number(facade_data_t.features[indexfac].properties.TH_1516);
				var cfe_facade_15 = Number(facade_data_t.features[indexfac].properties.CFE_1516);
				var cvae_facade_15 = Number(facade_data_t.features[indexfac].properties.CVAE_1516);
				var ifer_facade_15 = Number(facade_data_t.features[indexfac].properties.IFER_1516);
				var tsfacade_facade_15 = Number(facade_data_t.features[indexfac].properties.TSCOM_1516);
				
				var part_m_facade_02 = ((th_facade_02 + fb_facade_02)/(th_facade_02 + fb_facade_02 + fnb_facade_02 + tp_facade_02)) * 100
				var part_m_facade_09 = ((th_facade_09 + fb_facade_09)/(th_facade_09 + fb_facade_09 + fnb_facade_09 + tp_facade_09)) * 100				
				var part_m_facade_11 = ((th_facade_11 + fb_facade_11)/(th_facade_11 + fb_facade_11 + fnb_facade_11 + cfe_facade_11 + cvae_facade_11 + ifer_facade_11 + tsfacade_facade_11)) * 100
				var part_m_facade_15 = ((th_facade_15 + fb_facade_15)/(th_facade_15 + fb_facade_15 + fnb_facade_15 + cfe_facade_15 + cvae_facade_15 + ifer_facade_15 + tsfacade_facade_15)) * 100				

				var facade_data = [part_m_facade_02.toFixed(2),part_m_facade_09.toFixed(2),part_m_facade_11.toFixed(2),part_m_facade_15.toFixed(2)];
				
				
				////////////// FRANCE
				
				var fnb_france_02 = Number(france_data_t.features[0].properties.FNB_0203);
				var fb_france_02 = Number(france_data_t.features[0].properties.FB_0203);
				var th_france_02 = Number(france_data_t.features[0].properties.TH_0203);
				var tp_france_02 = Number(france_data_t.features[0].properties.TP_0203);
				
				var fnb_france_09 = Number(france_data_t.features[0].properties.FNB_0910);
				var fb_france_09 = Number(france_data_t.features[0].properties.FB_0910);
				var th_france_09 = Number(france_data_t.features[0].properties.TH_0910);
				var tp_france_09 = Number(france_data_t.features[0].properties.TP_0910);
				
				var fnb_france_11 = Number(france_data_t.features[0].properties.FNB_1112);
				var fb_france_11 = Number(france_data_t.features[0].properties.FB_1112);
				var th_france_11 = Number(france_data_t.features[0].properties.TH_1112);
				var cfe_france_11 = Number(france_data_t.features[0].properties.CFE_1112);
				var cvae_france_11 = Number(france_data_t.features[0].properties.CVAE_1112);
				var ifer_france_11 = Number(france_data_t.features[0].properties.IFER_1112);
				var tsfrance_france_11 = Number(france_data_t.features[0].properties.TSCOM_1112);
				
				var fnb_france_15 = Number(france_data_t.features[0].properties.FNB_1516);
				var fb_france_15 = Number(france_data_t.features[0].properties.FB_1516);
				var th_france_15 = Number(france_data_t.features[0].properties.TH_1516);
				var cfe_france_15 = Number(france_data_t.features[0].properties.CFE_1516);
				var cvae_france_15 = Number(france_data_t.features[0].properties.CVAE_1516);
				var ifer_france_15 = Number(france_data_t.features[0].properties.IFER_1516);
				var tsfrance_france_15 = Number(france_data_t.features[0].properties.TSCOM_1516);
				
				var part_m_france_02 = ((th_france_02 + fb_france_02)/(th_france_02 + fb_france_02 + fnb_france_02 + tp_france_02)) * 100
				var part_m_france_09 = ((th_france_09 + fb_france_09)/(th_france_09 + fb_france_09 + fnb_france_09 + tp_france_09)) * 100				
				var part_m_france_11 = ((th_france_11 + fb_france_11)/(th_france_11 + fb_france_11 + fnb_france_11 + cfe_france_11 + cvae_france_11 + ifer_france_11 + tsfrance_france_11)) * 100
				var part_m_france_15 = ((th_france_15 + fb_france_15)/(th_france_15 + fb_france_15 + fnb_france_15 + cfe_france_15 + cvae_france_15 + ifer_france_15 + tsfrance_france_15)) * 100				

				var fra_data = [part_m_france_02.toFixed(2),part_m_france_09.toFixed(2),part_m_france_11.toFixed(2),part_m_france_15.toFixed(2)];
				
				barChartData2.datasets[0].data = nouvelleData; // Remplacement des données de base par les données de population 
				barChartData2.datasets[1].data = epci_graphe;
				barChartData2.datasets[2].data = depart_data;
				barChartData2.datasets[3].data = facade_data;
				barChartData2.datasets[4].data = fra_data;
				barChartData2.labels = ['2002-03', '2009-10', '2011-12', '2015-16'];
				window.myBar2.update();
		
				window.myBar2.options.title.text = 'Part du produit des impôts ménages dans le produit total des impôts locaux du bloc communal (%)';
				barChartData2.datasets[0].label = nomcom;
				barChartData2.datasets[1].label = "Moyenne " + epci;
				barChartData2.datasets[2].label = "Moyenne " + depart;
				window.myBar2.update();
						
						
			
			
			break;
			
			
			case '9': // Part des recettes fiscales dans le produit total de fonctionnement
			
				////////////// COMMUNE
			
				var fisc_com02 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_0203);
				var fisc_com09 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_0910);
				var fisc_com15 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_1516);
				var fonct_com02 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_0203);
				var fonct_com09 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_0910);
				var fonct_com15 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_1516);
				
				var part_fisc_com02 = (fisc_com02 / fonct_com02 ) * 100;
				var part_fisc_com09 = (fisc_com09 / fonct_com09 ) * 100;
				var part_fisc_com15 = (fisc_com15 / fonct_com15 ) * 100;
				
				var nouvelleData = [part_fisc_com02.toFixed(2),part_fisc_com09.toFixed(2),part_fisc_com15.toFixed(2)]; 

				////////////// EPCI

				var fisc_epci02 = Number(epci_data.features[indexepci].properties.FISC_0203);
				var fisc_epci09 = Number(epci_data.features[indexepci].properties.FISC_0910);
				var fisc_epci15 = Number(epci_data.features[indexepci].properties.FISC_1516);
				var fonct_epci02 = Number(epci_data.features[indexepci].properties.P_FCT_0203);
				var fonct_epci09 = Number(epci_data.features[indexepci].properties.P_FCT_0910);
				var fonct_epci15 = Number(epci_data.features[indexepci].properties.P_FCT_1516);
				
				var part_fisc_epci02 = (fisc_epci02 / fonct_epci02 ) * 100;
				var part_fisc_epci09 = (fisc_epci09 / fonct_epci09 ) * 100;
				var part_fisc_epci15 = (fisc_epci15 / fonct_epci15 ) * 100;
				
				var epci_graphe = [part_fisc_epci02.toFixed(2),part_fisc_epci09.toFixed(2),part_fisc_epci15.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var fisc_depart02 = Number(dep_data_t.features[indexdep].properties.FISC_0203);
				var fisc_depart09 = Number(dep_data_t.features[indexdep].properties.FISC_0910);
				var fisc_depart15 = Number(dep_data_t.features[indexdep].properties.FISC_1516);
				var fonct_depart02 = Number(dep_data_t.features[indexdep].properties.P_FCT_0203);
				var fonct_depart09 = Number(dep_data_t.features[indexdep].properties.P_FCT_0910);
				var fonct_depart15 = Number(dep_data_t.features[indexdep].properties.P_FCT_1516);
				
				var part_fisc_depart02 = (fisc_depart02 / fonct_depart02 ) * 100;
				var part_fisc_depart09 = (fisc_depart09 / fonct_depart09 ) * 100;
				var part_fisc_depart15 = (fisc_depart15 / fonct_depart15 ) * 100;
				
				var depart_data = [part_fisc_depart02.toFixed(2),part_fisc_depart09.toFixed(2),part_fisc_depart15.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var fisc_facade02 = Number(facade_data_t.features[indexfac].properties.FISC_0203);
				var fisc_facade09 = Number(facade_data_t.features[indexfac].properties.FISC_0910);
				var fisc_facade15 = Number(facade_data_t.features[indexfac].properties.FISC_1516);
				var fonct_facade02 = Number(facade_data_t.features[indexfac].properties.P_FCT_0203);
				var fonct_facade09 = Number(facade_data_t.features[indexfac].properties.P_FCT_0910);
				var fonct_facade15 = Number(facade_data_t.features[indexfac].properties.P_FCT_1516);
				
				var part_fisc_facade02 = (fisc_facade02 / fonct_facade02 ) * 100;
				var part_fisc_facade09 = (fisc_facade09 / fonct_facade09 ) * 100;
				var part_fisc_facade15 = (fisc_facade15 / fonct_facade15 ) * 100;
				
				var facade_data = [part_fisc_facade02.toFixed(2),part_fisc_facade09.toFixed(2),part_fisc_facade15.toFixed(2)];
				
				
				////////////// FRANCE
				
				var fisc_france02 = Number(france_data_t.features[0].properties.FISC_0203);
				var fisc_france09 = Number(france_data_t.features[0].properties.FISC_0910);
				var fisc_france15 = Number(france_data_t.features[0].properties.FISC_1516);
				var fonct_france02 = Number(france_data_t.features[0].properties.P_FCT_0203);
				var fonct_france09 = Number(france_data_t.features[0].properties.P_FCT_0910);
				var fonct_france15 = Number(france_data_t.features[0].properties.P_FCT_1516);
				
				var part_fisc_france02 = (fisc_france02 / fonct_france02 ) * 100;
				var part_fisc_france09 = (fisc_france09 / fonct_france09 ) * 100;
				var part_fisc_france15 = (fisc_france15 / fonct_france15 ) * 100;
				
				var fra_data = [part_fisc_france02.toFixed(2),part_fisc_france09.toFixed(2),part_fisc_france15.toFixed(2)];
				
				barChartData2.datasets[0].data = nouvelleData; 
				barChartData2.datasets[1].data = epci_graphe;
				barChartData2.datasets[2].data = depart_data;
				barChartData2.datasets[3].data = facade_data;
				barChartData2.datasets[4].data = fra_data;
				barChartData2.labels = ['2002-03', '2009-10', '2015-16'];
				window.myBar2.update();
		
				window.myBar2.options.title.text = 'Part des recettes fiscales dans le produit total de fonctionnement (%)';
				barChartData2.datasets[0].label = nomcom;
				barChartData2.datasets[1].label = "Moyenne " + epci;
				barChartData2.datasets[2].label = "Moyenne " + depart;
				window.myBar2.update();
						
			
			
			break;
			
			
			
		}	
		
	}
	
		function graphe3(choix) {	

		document.getElementById("selecteur3").style.visibility = "hidden";
		
		while (barChartData3.datasets.length > 0){
			barChartData3.datasets.pop(); 
		}
		
		barChartData3.datasets.push({label : nomcom, backgroundColor: window.chartColors.red, stack : 'Stack 0', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData3.datasets.push({label : 'Moyenne ' + epci, backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData3.datasets.push({label : 'Moyenne ' + depart, backgroundColor: window.chartColors.yellow, stack : 'Stack 2', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData3.datasets.push({label : 'Moyenne ' + facade, backgroundColor: window.chartColors.blue, stack : 'Stack 3', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData3.datasets.push({label : 'Moyenne France', backgroundColor: window.chartColors.green, stack : 'Stack 4', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});

		window.myBar3.options.legend.display = true;
		window.myBar3.update();


		var valeur_graphe3 = document.getElementById("graphique3"); 
		var choixUti3 = valeur_graphe3.options[valeur_graphe3.selectedIndex].value; // Récupération du choix de l'utilisateur

		switch (choixUti3) { // Calcul des données des graphiques en fonction du choix de l'utilisateur graphique 1
			case '1': // Cas n°1 : données de population 

				////////////// COMMUNE
			
				var pop_com99 = json_donnees_finales.features[indexcom_d].properties.Pop_1999;
				var pop_com10 = json_donnees_finales.features[indexcom_d].properties.Pop_2010;
				var pop_com15 = json_donnees_finales.features[indexcom_d].properties.Pop_2015;
				var evolpop9910 = (((pop_com10-pop_com99)/pop_com99)*100)/11;
				var evolpop1015 = (((pop_com15-pop_com10)/pop_com10)*100)/5;
				var nouvelleData = [evolpop9910.toFixed(2),evolpop1015.toFixed(2)]; // Valeur d'évolution de la population de la commune

				////////////// EPCI

				var pop_epci99 = epci_data.features[indexepci].properties.Pop_1999;
				var pop_epci10 = epci_data.features[indexepci].properties.Pop_2010;
				var pop_epci15 = epci_data.features[indexepci].properties.Pop_2015;
				var evolpopepci9910 = (((pop_epci10-pop_epci99)/pop_epci99)*100)/11;
				var evolpopepci1015 = (((pop_epci15-pop_epci10)/pop_epci10)*100)/5;
				var epci_graphe = [evolpopepci9910.toFixed(2),evolpopepci1015.toFixed(2)]; // Valeur d'évolution de la population de la commune

				
				////////////// DEPARTEMENT
				
				var pop_depart99 = dep_data_t.features[indexdep].properties.Pop_1999;
				var pop_depart10 = dep_data_t.features[indexdep].properties.Pop_2010;
				var pop_depart15 = dep_data_t.features[indexdep].properties.Pop_2015;
				var evolpopdepart9910 = (((pop_depart10-pop_depart99)/pop_depart99)*100)/11;
				var evolpopdepart1015 = (((pop_depart15-pop_depart10)/pop_depart10)*100)/5;
				var depart_data = [evolpopdepart9910.toFixed(2),evolpopdepart1015.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var pop_facade99 = facade_data_t.features[indexfac].properties.Pop_1999;
				var pop_facade10 = facade_data_t.features[indexfac].properties.Pop_2010;
				var pop_facade15 = facade_data_t.features[indexfac].properties.Pop_2015;
				var evolpopfacade9910 = (((pop_facade10-pop_facade99)/pop_facade99)*100)/11;
				var evolpopfacade1015 = (((pop_facade15-pop_facade10)/pop_facade10)*100)/5;
				var facade_data = [evolpopfacade9910.toFixed(2),evolpopfacade1015.toFixed(2)];
				
				
				////////////// FRANCE
				
				var pop_fra99 = france_data_t.features[0].properties.Pop_1999;
				var pop_fra10 = france_data_t.features[0].properties.Pop_2010;
				var pop_fra15 = france_data_t.features[0].properties.Pop_2015;
				var evolpopfra9910 = (((pop_fra10-pop_fra99)/pop_fra99)*100)/11;
				var evolpopfra1015 = (((pop_fra15-pop_fra10)/pop_fra10)*100)/5;
				var fra_data = [evolpopfra9910.toFixed(2),evolpopfra1015.toFixed(2)];
				
				barChartData3.datasets[0].data = nouvelleData; // Remplacement des données de base par les données de population 
				barChartData3.datasets[1].data = epci_graphe;
				barChartData3.datasets[2].data = depart_data;
				barChartData3.datasets[3].data = facade_data;
				barChartData3.datasets[4].data = fra_data;
				barChartData3.labels = ['1999 - 2010', '2010 - 2015'];
				window.myBar3.update();
		
				window.myBar3.options.title.text = 'Taux d\'évolution annuel de la population (%)';
				barChartData3.datasets[0].label = nomcom;
				barChartData3.datasets[1].label = "Moyenne " + epci;
				barChartData3.datasets[2].label = "Moyenne " + depart;
				window.myBar3.update();
				
				
			break;
			
			
			
			
			
			case '2': // Cas n°2 : Structure des âges
			
				while (barChartData3.datasets.length > 0 ){
					barChartData3.datasets.pop(); 
				}
				
				document.getElementById("selecteur3").style.visibility = "visible";
				
				barChartData3.datasets.push({label : ' -15 ans', backgroundColor: window.chartColors.red, stack : 'Stack 1', data : [1,1,1,5,5,5,5,5,5,5,5,5]});
				barChartData3.datasets.push({label : ' 15 - 29 ans', backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData3.datasets.push({label : ' 30 - 44 ans', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData3.datasets.push({label : ' 45 - 59 ans', backgroundColor: window.chartColors.blue, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData3.datasets.push({label : ' 60 - 74 ans', backgroundColor: window.chartColors.green, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData3.datasets.push({label : ' 75 ans et plus', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				
				//////////////// Populations
				
				var pop_com_s_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP;
				var pop_com_s_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP;
				var pop_com_s_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP;
				var pop_epci_s_99 = epci_data.features[indexepci].properties.P99_POP;
				var pop_epci_s_10 = epci_data.features[indexepci].properties.P10_POP;
				var pop_epci_s_16 = epci_data.features[indexepci].properties.P16_POP;
				var pop_dep_s_99 = dep_data_t.features[indexdep].properties.P99_POP;
				var pop_dep_s_10 = dep_data_t.features[indexdep].properties.P10_POP;
				var pop_dep_s_16 = dep_data_t.features[indexdep].properties.P16_POP;
				var pop_fac_s_99 = facade_data_t.features[indexfac].properties.P99_POP;
				var pop_fac_s_10 = facade_data_t.features[indexfac].properties.P10_POP;
				var pop_fac_s_16 = facade_data_t.features[indexfac].properties.P16_POP;
				var pop_fra_s_99 = france_data_t.features[0].properties.P99_POP;
				var pop_fra_s_10 = france_data_t.features[0].properties.P10_POP;
				var pop_fra_s_16 = france_data_t.features[0].properties.P16_POP;
				
				
				
				////////////// Moins de 15 ans 
				
				var moins_15_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP0014;
				var moins_15_epci_99 = epci_data.features[indexepci].properties.P99_POP0014;
				var moins_15_dep_99 = dep_data_t.features[indexdep].properties.P99_POP0014;
				var moins_15_fac_99 = facade_data_t.features[indexfac].properties.P99_POP0014;
				var moins_15_fra_99 = france_data_t.features[0].properties.P99_POP0014;
				var moins_15_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP0014;
				var moins_15_epci_10 = epci_data.features[indexepci].properties.P10_POP0014;
				var moins_15_dep_10 = dep_data_t.features[indexdep].properties.P10_POP0014;
				var moins_15_fac_10 = facade_data_t.features[indexfac].properties.P10_POP0014;
				var moins_15_fra_10 = france_data_t.features[0].properties.P10_POP0014;
				var moins_15_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP0014;
				var moins_15_epci_16 = epci_data.features[indexepci].properties.P16_POP0014;
				var moins_15_dep_16 = dep_data_t.features[indexdep].properties.P16_POP0014;
				var moins_15_fac_16 = facade_data_t.features[indexfac].properties.P16_POP0014;
				var moins_15_fra_16 = france_data_t.features[0].properties.P16_POP0014;
				
				var part_moins_15_com_99 = (moins_15_com_99 / pop_com_s_99) * 100;
				var part_moins_15_epci_99 = (moins_15_epci_99 / pop_epci_s_99) * 100;
				var part_moins_15_dep_99 = (moins_15_dep_99 / pop_dep_s_99) * 100;
				var part_moins_15_fac_99 = (moins_15_fac_99 / pop_fac_s_99) * 100;
				var part_moins_15_fra_99 = (moins_15_fra_99 / pop_fra_s_99) * 100;
				var part_moins_15_com_10 = (moins_15_com_10 / pop_com_s_10) * 100;
				var part_moins_15_epci_10 = (moins_15_epci_10 / pop_epci_s_10) * 100;
				var part_moins_15_dep_10 = (moins_15_dep_10 / pop_dep_s_10) * 100;
				var part_moins_15_fac_10 = (moins_15_fac_10 / pop_fac_s_10) * 100;
				var part_moins_15_fra_10 = (moins_15_fra_10 / pop_fra_s_10) * 100;
				var part_moins_15_com_16 = (moins_15_com_16 / pop_com_s_16) * 100;
				var part_moins_15_epci_16 = (moins_15_epci_16 / pop_epci_s_16) * 100;
				var part_moins_15_dep_16 = (moins_15_dep_16 / pop_dep_s_16) * 100;
				var part_moins_15_fac_16 = (moins_15_fac_16 / pop_fac_s_16) * 100;
				var part_moins_15_fra_16 = (moins_15_fra_16 / pop_fra_s_16) * 100;

				////////////// 15 à 29 ans

				var p_1529_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP1529;
				var p_1529_epci_99 = epci_data.features[indexepci].properties.P99_POP1529;
				var p_1529_dep_99 = dep_data_t.features[indexdep].properties.P99_POP1529;
				var p_1529_fac_99 = facade_data_t.features[indexfac].properties.P99_POP1529;
				var p_1529_fra_99 = france_data_t.features[0].properties.P99_POP1529;
				var p_1529_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP1529;
				var p_1529_epci_10 = epci_data.features[indexepci].properties.P10_POP1529;
				var p_1529_dep_10 = dep_data_t.features[indexdep].properties.P10_POP1529;
				var p_1529_fac_10 = facade_data_t.features[indexfac].properties.P10_POP1529;
				var p_1529_fra_10 = france_data_t.features[0].properties.P10_POP1529;
				var p_1529_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP1529;
				var p_1529_epci_16 = epci_data.features[indexepci].properties.P16_POP1529;
				var p_1529_dep_16 = dep_data_t.features[indexdep].properties.P16_POP1529;
				var p_1529_fac_16 = facade_data_t.features[indexfac].properties.P16_POP1529;
				var p_1529_fra_16 = france_data_t.features[0].properties.P16_POP1529;

				var part_p_1529_com_99 = (p_1529_com_99 / pop_com_s_99) * 100;
				var part_p_1529_epci_99 = (p_1529_epci_99 / pop_epci_s_99) * 100;
				var part_p_1529_dep_99 = (p_1529_dep_99 / pop_dep_s_99) * 100;
				var part_p_1529_fac_99 = (p_1529_fac_99 / pop_fac_s_99) * 100;
				var part_p_1529_fra_99 = (p_1529_fra_99 / pop_fra_s_99) * 100;
				var part_p_1529_com_10 = (p_1529_com_10 / pop_com_s_10) * 100;
				var part_p_1529_epci_10 = (p_1529_epci_10 / pop_epci_s_10) * 100;
				var part_p_1529_dep_10 = (p_1529_dep_10 / pop_dep_s_10) * 100;
				var part_p_1529_fac_10 = (p_1529_fac_10 / pop_fac_s_10) * 100;
				var part_p_1529_fra_10 = (p_1529_fra_10 / pop_fra_s_10) * 100;
				var part_p_1529_com_16 = (p_1529_com_16 / pop_com_s_16) * 100;
				var part_p_1529_epci_16 = (p_1529_epci_16 / pop_epci_s_16) * 100;
				var part_p_1529_dep_16 = (p_1529_dep_16 / pop_dep_s_16) * 100;
				var part_p_1529_fac_16 = (p_1529_fac_16 / pop_fac_s_16) * 100;
				var part_p_1529_fra_16 = (p_1529_fra_16 / pop_fra_s_16) * 100;
				
				
				
				////////////// 30 à 44 ans
				
				var p_3044_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP3044;
				var p_3044_epci_99 = epci_data.features[indexepci].properties.P99_POP3044;
				var p_3044_dep_99 = dep_data_t.features[indexdep].properties.P99_POP3044;
				var p_3044_fac_99 = facade_data_t.features[indexfac].properties.P99_POP3044;
				var p_3044_fra_99 = france_data_t.features[0].properties.P99_POP3044;
				var p_3044_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP3044;
				var p_3044_epci_10 = epci_data.features[indexepci].properties.P10_POP3044;
				var p_3044_dep_10 = dep_data_t.features[indexdep].properties.P10_POP3044;
				var p_3044_fac_10 = facade_data_t.features[indexfac].properties.P10_POP3044;
				var p_3044_fra_10 = france_data_t.features[0].properties.P10_POP3044;
				var p_3044_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP3044;
				var p_3044_epci_16 = epci_data.features[indexepci].properties.P16_POP3044;
				var p_3044_dep_16 = dep_data_t.features[indexdep].properties.P16_POP3044;
				var p_3044_fac_16 = facade_data_t.features[indexfac].properties.P16_POP3044;
				var p_3044_fra_16 = france_data_t.features[0].properties.P16_POP3044;
				
				var part_p_3044_com_99 = (p_3044_com_99 / pop_com_s_99) * 100;
				var part_p_3044_epci_99 = (p_3044_epci_99 / pop_epci_s_99) * 100;
				var part_p_3044_dep_99 = (p_3044_dep_99 / pop_dep_s_99) * 100;
				var part_p_3044_fac_99 = (p_3044_fac_99 / pop_fac_s_99) * 100;
				var part_p_3044_fra_99 = (p_3044_fra_99 / pop_fra_s_99) * 100;
				var part_p_3044_com_10 = (p_3044_com_10 / pop_com_s_10) * 100;
				var part_p_3044_epci_10 = (p_3044_epci_10 / pop_epci_s_10) * 100;
				var part_p_3044_dep_10 = (p_3044_dep_10 / pop_dep_s_10) * 100;
				var part_p_3044_fac_10 = (p_3044_fac_10 / pop_fac_s_10) * 100;
				var part_p_3044_fra_10 = (p_3044_fra_10 / pop_fra_s_10) * 100;
				var part_p_3044_com_16 = (p_3044_com_16 / pop_com_s_16) * 100;
				var part_p_3044_epci_16 = (p_3044_epci_16 / pop_epci_s_16) * 100;
				var part_p_3044_dep_16 = (p_3044_dep_16 / pop_dep_s_16) * 100;
				var part_p_3044_fac_16 = (p_3044_fac_16 / pop_fac_s_16) * 100;
				var part_p_3044_fra_16 = (p_3044_fra_16 / pop_fra_s_16) * 100;
				
				////////////// 45 à 59 ans 
				
				var p_4559_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP4559;
				var p_4559_epci_99 = epci_data.features[indexepci].properties.P99_POP4559;
				var p_4559_dep_99 = dep_data_t.features[indexdep].properties.P99_POP4559;
				var p_4559_fac_99 = facade_data_t.features[indexfac].properties.P99_POP4559;
				var p_4559_fra_99 = france_data_t.features[0].properties.P99_POP4559;
				var p_4559_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP4559;
				var p_4559_epci_10 = epci_data.features[indexepci].properties.P10_POP4559;
				var p_4559_dep_10 = dep_data_t.features[indexdep].properties.P10_POP4559;
				var p_4559_fac_10 = facade_data_t.features[indexfac].properties.P10_POP4559;
				var p_4559_fra_10 = france_data_t.features[0].properties.P10_POP4559;
				var p_4559_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP4559;
				var p_4559_epci_16 = epci_data.features[indexepci].properties.P16_POP4559;
				var p_4559_dep_16 = dep_data_t.features[indexdep].properties.P16_POP4559;
				var p_4559_fac_16 = facade_data_t.features[indexfac].properties.P16_POP4559;
				var p_4559_fra_16 = france_data_t.features[0].properties.P16_POP4559;
				
				var part_p_4559_com_99 = (p_4559_com_99 / pop_com_s_99) * 100;
				var part_p_4559_epci_99 = (p_4559_epci_99 / pop_epci_s_99) * 100;
				var part_p_4559_dep_99 = (p_4559_dep_99 / pop_dep_s_99) * 100;
				var part_p_4559_fac_99 = (p_4559_fac_99 / pop_fac_s_99) * 100;
				var part_p_4559_fra_99 = (p_4559_fra_99 / pop_fra_s_99) * 100;
				var part_p_4559_com_10 = (p_4559_com_10 / pop_com_s_10) * 100;
				var part_p_4559_epci_10 = (p_4559_epci_10 / pop_epci_s_10) * 100;
				var part_p_4559_dep_10 = (p_4559_dep_10 / pop_dep_s_10) * 100;
				var part_p_4559_fac_10 = (p_4559_fac_10 / pop_fac_s_10) * 100;
				var part_p_4559_fra_10 = (p_4559_fra_10 / pop_fra_s_10) * 100;
				var part_p_4559_com_16 = (p_4559_com_16 / pop_com_s_16) * 100;
				var part_p_4559_epci_16 = (p_4559_epci_16 / pop_epci_s_16) * 100;
				var part_p_4559_dep_16 = (p_4559_dep_16 / pop_dep_s_16) * 100;
				var part_p_4559_fac_16 = (p_4559_fac_16 / pop_fac_s_16) * 100;
				var part_p_4559_fra_16 = (p_4559_fra_16 / pop_fra_s_16) * 100;
				
				
				////////////// 60 à 74 ans
				
				var p_6074_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP6074;
				var p_6074_epci_99 = epci_data.features[indexepci].properties.P99_POP6074;
				var p_6074_dep_99 = dep_data_t.features[indexdep].properties.P99_POP6074;
				var p_6074_fac_99 = facade_data_t.features[indexfac].properties.P99_POP6074;
				var p_6074_fra_99 = france_data_t.features[0].properties.P99_POP6074;
				var p_6074_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP6074;
				var p_6074_epci_10 = epci_data.features[indexepci].properties.P10_POP6074;
				var p_6074_dep_10 = dep_data_t.features[indexdep].properties.P10_POP6074;
				var p_6074_fac_10 = facade_data_t.features[indexfac].properties.P10_POP6074;
				var p_6074_fra_10 = france_data_t.features[0].properties.P10_POP6074;
				var p_6074_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP6074;
				var p_6074_epci_16 = epci_data.features[indexepci].properties.P16_POP6074;
				var p_6074_dep_16 = dep_data_t.features[indexdep].properties.P16_POP6074;
				var p_6074_fac_16 = facade_data_t.features[indexfac].properties.P16_POP6074;
				var p_6074_fra_16 = france_data_t.features[0].properties.P16_POP6074;

				var part_p_6074_com_99 = (p_6074_com_99 / pop_com_s_99) * 100;
				var part_p_6074_epci_99 = (p_6074_epci_99 / pop_epci_s_99) * 100;
				var part_p_6074_dep_99 = (p_6074_dep_99 / pop_dep_s_99) * 100;
				var part_p_6074_fac_99 = (p_6074_fac_99 / pop_fac_s_99) * 100;
				var part_p_6074_fra_99 = (p_6074_fra_99 / pop_fra_s_99) * 100;
				var part_p_6074_com_10 = (p_6074_com_10 / pop_com_s_10) * 100;
				var part_p_6074_epci_10 = (p_6074_epci_10 / pop_epci_s_10) * 100;
				var part_p_6074_dep_10 = (p_6074_dep_10 / pop_dep_s_10) * 100;
				var part_p_6074_fac_10 = (p_6074_fac_10 / pop_fac_s_10) * 100;
				var part_p_6074_fra_10 = (p_6074_fra_10 / pop_fra_s_10) * 100;
				var part_p_6074_com_16 = (p_6074_com_16 / pop_com_s_16) * 100;
				var part_p_6074_epci_16 = (p_6074_epci_16 / pop_epci_s_16) * 100;
				var part_p_6074_dep_16 = (p_6074_dep_16 / pop_dep_s_16) * 100;
				var part_p_6074_fac_16 = (p_6074_fac_16 / pop_fac_s_16) * 100;
				var part_p_6074_fra_16 = (p_6074_fra_16 / pop_fra_s_16) * 100;
				
				////////////// 75 ans et plus
				
				var p_75P_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP75P;
				var p_75P_epci_99 = epci_data.features[indexepci].properties.P99_POP75P;
				var p_75P_dep_99 = dep_data_t.features[indexdep].properties.P99_POP75P;
				var p_75P_fac_99 = facade_data_t.features[indexfac].properties.P99_POP75P;
				var p_75P_fra_99 = france_data_t.features[0].properties.P99_POP75P;
				var p_75P_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP75P;
				var p_75P_epci_10 = epci_data.features[indexepci].properties.P10_POP75P;
				var p_75P_dep_10 = dep_data_t.features[indexdep].properties.P10_POP75P;
				var p_75P_fac_10 = facade_data_t.features[indexfac].properties.P10_POP75P;
				var p_75P_fra_10 = france_data_t.features[0].properties.P10_POP75P;
				var p_75P_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP75P;
				var p_75P_epci_16 = epci_data.features[indexepci].properties.P16_POP75P;
				var p_75P_dep_16 = dep_data_t.features[indexdep].properties.P16_POP75P;
				var p_75P_fac_16 = facade_data_t.features[indexfac].properties.P16_POP75P;
				var p_75P_fra_16 = france_data_t.features[0].properties.P16_POP75P;
				
				var part_p_75P_com_99 = (p_75P_com_99 / pop_com_s_99) * 100;
				var part_p_75P_epci_99 = (p_75P_epci_99 / pop_epci_s_99) * 100;
				var part_p_75P_dep_99 = (p_75P_dep_99 / pop_dep_s_99) * 100;
				var part_p_75P_fac_99 = (p_75P_fac_99 / pop_fac_s_99) * 100;
				var part_p_75P_fra_99 = (p_75P_fra_99 / pop_fra_s_99) * 100;
				var part_p_75P_com_10 = (p_75P_com_10 / pop_com_s_10) * 100;
				var part_p_75P_epci_10 = (p_75P_epci_10 / pop_epci_s_10) * 100;
				var part_p_75P_dep_10 = (p_75P_dep_10 / pop_dep_s_10) * 100;
				var part_p_75P_fac_10 = (p_75P_fac_10 / pop_fac_s_10) * 100;
				var part_p_75P_fra_10 = (p_75P_fra_10 / pop_fra_s_10) * 100;
				var part_p_75P_com_16 = (p_75P_com_16 / pop_com_s_16) * 100;
				var part_p_75P_epci_16 = (p_75P_epci_16 / pop_epci_s_16) * 100;
				var part_p_75P_dep_16 = (p_75P_dep_16 / pop_dep_s_16) * 100;
				var part_p_75P_fac_16 = (p_75P_fac_16 / pop_fac_s_16) * 100;
				var part_p_75P_fra_16 = (p_75P_fra_16 / pop_fra_s_16) * 100;
	
				var anneechoisie = document.getElementById("selecteur3");
				var anneestruct = anneechoisie.options[anneechoisie.selectedIndex].value;
	
				switch (anneestruct) {
				
				case '1999' : 
					barChartData3.datasets[0].data = [part_moins_15_com_99.toFixed(2),part_moins_15_epci_99.toFixed(2),part_moins_15_dep_99.toFixed(2),part_moins_15_fac_99.toFixed(2),part_moins_15_fra_99.toFixed(2)];
					barChartData3.datasets[1].data = [part_p_1529_com_99.toFixed(2),part_p_1529_epci_99.toFixed(2),part_p_1529_dep_99.toFixed(2),part_p_1529_fac_99.toFixed(2),part_p_1529_fra_99.toFixed(2)];
					barChartData3.datasets[2].data = [part_p_3044_com_99.toFixed(2),part_p_3044_epci_99.toFixed(2),part_p_3044_dep_99.toFixed(2),part_p_3044_fac_99.toFixed(2),part_p_3044_fra_99.toFixed(2)];
					barChartData3.datasets[3].data = [part_p_4559_com_99.toFixed(2),part_p_4559_epci_99.toFixed(2),part_p_4559_dep_99.toFixed(2),part_p_4559_fac_99.toFixed(2),part_p_4559_fra_99.toFixed(2)];
					barChartData3.datasets[4].data = [part_p_6074_com_99.toFixed(2),part_p_6074_epci_99.toFixed(2),part_p_6074_dep_99.toFixed(2),part_p_6074_fac_99.toFixed(2),part_p_6074_fra_99.toFixed(2)];
					barChartData3.datasets[5].data = [part_p_75P_com_99.toFixed(2),part_p_75P_epci_99.toFixed(2),part_p_75P_dep_99.toFixed(2),part_p_75P_fac_99.toFixed(2),part_p_75P_fra_99.toFixed(2)];
				window.myBar3.options.title.text = 'Structure par âge de la population en 1999 (part en %)';
				break;
				
				case '2010' : 
					barChartData3.datasets[0].data = [part_moins_15_com_10.toFixed(2),part_moins_15_epci_10.toFixed(2),part_moins_15_dep_10.toFixed(2),part_moins_15_fac_10.toFixed(2),part_moins_15_fra_10.toFixed(2)];
					barChartData3.datasets[1].data = [part_p_1529_com_10.toFixed(2),part_p_1529_epci_10.toFixed(2),part_p_1529_dep_10.toFixed(2),part_p_1529_fac_10.toFixed(2),part_p_1529_fra_10.toFixed(2)];
					barChartData3.datasets[2].data = [part_p_3044_com_10.toFixed(2),part_p_3044_epci_10.toFixed(2),part_p_3044_dep_10.toFixed(2),part_p_3044_fac_10.toFixed(2),part_p_3044_fra_10.toFixed(2)];
					barChartData3.datasets[3].data = [part_p_4559_com_10.toFixed(2),part_p_4559_epci_10.toFixed(2),part_p_4559_dep_10.toFixed(2),part_p_4559_fac_10.toFixed(2),part_p_4559_fra_10.toFixed(2)];
					barChartData3.datasets[4].data = [part_p_6074_com_10.toFixed(2),part_p_6074_epci_10.toFixed(2),part_p_6074_dep_10.toFixed(2),part_p_6074_fac_10.toFixed(2),part_p_6074_fra_10.toFixed(2)];
					barChartData3.datasets[5].data = [part_p_75P_com_10.toFixed(2),part_p_75P_epci_10.toFixed(2),part_p_75P_dep_10.toFixed(2),part_p_75P_fac_10.toFixed(2),part_p_75P_fra_10.toFixed(2)];
				window.myBar3.options.title.text = 'Structure par âge de la population en 2010 (part en %)';
				break;
						
				case '2016' : 
				barChartData3.datasets[0].data = [part_moins_15_com_16.toFixed(2),part_moins_15_epci_16.toFixed(2),part_moins_15_dep_16.toFixed(2),part_moins_15_fac_16.toFixed(2),part_moins_15_fra_16.toFixed(2)];
					barChartData3.datasets[1].data = [part_p_1529_com_16.toFixed(2),part_p_1529_epci_16.toFixed(2),part_p_1529_dep_16.toFixed(2),part_p_1529_fac_16.toFixed(2),part_p_1529_fra_16.toFixed(2)];
					barChartData3.datasets[2].data = [part_p_3044_com_16.toFixed(2),part_p_3044_epci_16.toFixed(2),part_p_3044_dep_16.toFixed(2),part_p_3044_fac_16.toFixed(2),part_p_3044_fra_16.toFixed(2)];
					barChartData3.datasets[3].data = [part_p_4559_com_16.toFixed(2),part_p_4559_epci_16.toFixed(2),part_p_4559_dep_16.toFixed(2),part_p_4559_fac_16.toFixed(2),part_p_4559_fra_16.toFixed(2)];
					barChartData3.datasets[4].data = [part_p_6074_com_16.toFixed(2),part_p_6074_epci_16.toFixed(2),part_p_6074_dep_16.toFixed(2),part_p_6074_fac_16.toFixed(2),part_p_6074_fra_16.toFixed(2)];
					barChartData3.datasets[5].data = [part_p_75P_com_16.toFixed(2),part_p_75P_epci_16.toFixed(2),part_p_75P_dep_16.toFixed(2),part_p_75P_fac_16.toFixed(2),part_p_75P_fra_16.toFixed(2)];
					window.myBar3.options.title.text = 'Structure par âge de la population en 2016 (part en %)';
				break;
				
			}



				barChartData3.labels = [nomcom,['',epci],depart,['',facade],'France'];
				window.myBar3.update();
		
				//window.myBar3.options.title.text = 'Structure par âge de la population (part en %)';
				window.myBar3.update();

			break;
			
			
			
			
			
			
			
			case '3': // Part de l'emploi présentiel
			
				////////////// COMMUNE
			
				var nouvelleData = [json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_1999,json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_2009,json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_2014]; 
			
				////////////// EPCI

				var emp_t_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_1999;
				var emp_r_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_2009;
				var emp_r_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_2014;
				var prt_em_epci99 = (emp_r_epci_99/emp_t_epci_99)*100;
				var prt_em_epci09 = (emp_r_epci_09/emp_t_epci_09)*100;
				var prt_em_epci14 = (emp_r_epci_14/emp_t_epci_14)*100;
				var epci_graphe = [prt_em_epci99.toFixed(2),prt_em_epci09.toFixed(2),prt_em_epci14.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var emp_t_depart_99 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_depart_09 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_depart_14 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_depart_99 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_1999;
				var emp_r_depart_09 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_2009;
				var emp_r_depart_14 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_2014;
				var prt_em_depart99 = (emp_r_depart_99/emp_t_depart_99)*100;
				var prt_em_depart09 = (emp_r_depart_09/emp_t_depart_09)*100;
				var prt_em_depart14 = (emp_r_depart_14/emp_t_depart_14)*100;
				var depart_data = [prt_em_depart99.toFixed(2),prt_em_depart09.toFixed(2),prt_em_depart14.toFixed(2)]; 
				
				////////////// FACADE LITTORALE 
				
				var emp_t_facade_99 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_facade_09 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_facade_14 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_facade_99 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_1999;
				var emp_r_facade_09 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_2009;
				var emp_r_facade_14 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_2014;
				var prt_em_facade99 = (emp_r_facade_99/emp_t_facade_99)*100;
				var prt_em_facade09 = (emp_r_facade_09/emp_t_facade_09)*100;
				var prt_em_facade14 = (emp_r_facade_14/emp_t_facade_14)*100;
				var facade_data = [prt_em_facade99.toFixed(2),prt_em_facade09.toFixed(2),prt_em_facade14.toFixed(2)]; 
				
				
				////////////// FRANCE
				
				var emp_t_fra_99 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fra_09 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fra_14 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_fra_99 = france_data_t.features[0].properties.Nb_emploi_résidentiel_1999;
				var emp_r_fra_09 = france_data_t.features[0].properties.Nb_emploi_résidentiel_2009;
				var emp_r_fra_14 = france_data_t.features[0].properties.Nb_emploi_résidentiel_2014;
				var prt_em_fra99 = (emp_r_fra_99/emp_t_fra_99)*100;
				var prt_em_fra09 = (emp_r_fra_09/emp_t_fra_09)*100;
				var prt_em_fra14 = (emp_r_fra_14/emp_t_fra_14)*100;
				var fra_data = [prt_em_fra99.toFixed(2),prt_em_fra09.toFixed(2),prt_em_fra14.toFixed(2)]; 
				
				barChartData3.datasets[0].data = nouvelleData;  
				barChartData3.datasets[1].data = epci_graphe;
				barChartData3.datasets[2].data = depart_data;
				barChartData3.datasets[3].data = facade_data;
				barChartData3.datasets[4].data = fra_data;
				barChartData3.labels = ['1999', '2009', '2014'];
				window.myBar3.update();
		
				window.myBar3.options.title.text = 'Part des emplois de la sphère résidentielle dans l\'emploi total (%)';
				barChartData3.datasets[0].label = nomcom;
				barChartData3.datasets[1].label = "Moyenne " + epci;
				barChartData3.datasets[2].label = "Moyenne " + depart;
				window.myBar3.update();
			
			
			break;
			
			
			
			
			
			
			
			case '4': // Nombre d'emplois au lieu de travail
				////////////// COMMUNE
			
				var pop_com99 = json_donnees_finales.features[indexcom_d].properties.Pop_1999;
				var pop_com10 = json_donnees_finales.features[indexcom_d].properties.Pop_2010;
				var pop_com15 = json_donnees_finales.features[indexcom_d].properties.Pop_2015;
				var emp_t_com_99 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_com_09 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_com_14 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_com99 = (emp_t_com_99/pop_com99);
				var em_ph_com09 = (emp_t_com_09/pop_com10);
				var em_ph_com14 = (emp_t_com_14/pop_com15);
				var nouvelleData = [em_ph_com99.toFixed(2),em_ph_com09.toFixed(2),em_ph_com14.toFixed(2)]; 

				////////////// EPCI

				var pop_epci99 = epci_data.features[indexepci].properties.Pop_1999;
				var pop_epci10 = epci_data.features[indexepci].properties.Pop_2010;
				var pop_epci15 = epci_data.features[indexepci].properties.Pop_2015;
				var emp_t_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_epci99 = (emp_t_epci_99/pop_epci99);
				var em_ph_epci09 = (emp_t_epci_09/pop_epci10);
				var em_ph_epci14 = (emp_t_epci_14/pop_epci15);
				var epci_graphe = [em_ph_epci99.toFixed(2),em_ph_epci09.toFixed(2),em_ph_epci14.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var pop_dep99 = dep_data_t.features[indexdep].properties.Pop_1999;
				var pop_dep10 = dep_data_t.features[indexdep].properties.Pop_2010;
				var pop_dep15 = dep_data_t.features[indexdep].properties.Pop_2015;
				var emp_t_dep_99 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_dep_09 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_dep_14 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_dep99 = (emp_t_dep_99/pop_dep99);
				var em_ph_dep09 = (emp_t_dep_09/pop_dep10);
				var em_ph_dep14 = (emp_t_dep_14/pop_dep15);
				var depart_data = [em_ph_dep99.toFixed(2),em_ph_dep09.toFixed(2),em_ph_dep14.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var pop_fac99 = facade_data_t.features[indexfac].properties.Pop_1999;
				var pop_fac10 = facade_data_t.features[indexfac].properties.Pop_2010;
				var pop_fac15 = facade_data_t.features[indexfac].properties.Pop_2015;
				var emp_t_fac_99 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fac_09 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fac_14 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_fac99 = (emp_t_fac_99/pop_fac99);
				var em_ph_fac09 = (emp_t_fac_09/pop_fac10);
				var em_ph_fac14 = (emp_t_fac_14/pop_fac15);
				var facade_data = [em_ph_fac99.toFixed(2),em_ph_fac09.toFixed(2),em_ph_fac14.toFixed(2)];
				
				
				////////////// FRANCE
				
				var pop_fra99 = france_data_t.features[0].properties.Pop_1999;
				var pop_fra10 = france_data_t.features[0].properties.Pop_2010;
				var pop_fra15 = france_data_t.features[0].properties.Pop_2015;
				var emp_t_fra_99 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fra_09 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fra_14 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_fra99 = (emp_t_fra_99/pop_fra99);
				var em_ph_fra09 = (emp_t_fra_09/pop_fra10);
				var em_ph_fra14 = (emp_t_fra_14/pop_fra15);
				var fra_data = [em_ph_fra99.toFixed(2),em_ph_fra09.toFixed(2),em_ph_fra14.toFixed(2)];
				
				barChartData3.datasets[0].data = nouvelleData; 
				barChartData3.datasets[1].data = epci_graphe;
				barChartData3.datasets[2].data = depart_data;
				barChartData3.datasets[3].data = facade_data;
				barChartData3.datasets[4].data = fra_data;
				barChartData3.labels = ['1999', '2009', '2014'];
				window.myBar3.update();
		
				window.myBar3.options.title.text = 'Nombre d\'emplois au lieu de travail (emplois/hab)';
				barChartData3.datasets[0].label = nomcom;
				barChartData3.datasets[1].label = "Moyenne " + epci;
				barChartData3.datasets[2].label = "Moyenne " + depart;
				window.myBar3.update();
						
			
			
			break;
			
			
			
			
			
			
			
			case '5': // Artificialisation
				
				////////////// COMMUNE
			
				var artif_com00 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2000;
				var artif_com06 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2006;
				var artif_com12 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2012;
				var surf_com = json_donnees_finales.features[indexcom_d].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_com00 = (artif_com00/surf_com)*100;
				var prct_artif_com06 = (artif_com06/surf_com)*100;
				var prct_artif_com12 = (artif_com12/surf_com)*100;
				var nouvelleData = [prct_artif_com00.toFixed(2),prct_artif_com06.toFixed(2),prct_artif_com12.toFixed(2)]; 

				////////////// EPCI

				var artif_epci00 = epci_data.features[indexepci].properties.SURF_ARTIF_2000;
				var artif_epci06 = epci_data.features[indexepci].properties.SURF_ARTIF_2006;
				var artif_epci12 = epci_data.features[indexepci].properties.SURF_ARTIF_2012;
				var surf_epci = epci_data.features[indexepci].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_epci00 = (artif_epci00/surf_epci)*100;
				var prct_artif_epci06 = (artif_epci06/surf_epci)*100;
				var prct_artif_epci12 = (artif_epci12/surf_epci)*100;
				var epci_graphe = [prct_artif_epci00.toFixed(2),prct_artif_epci06.toFixed(2),prct_artif_epci12.toFixed(2)]; // Valeur d'évolution de la population de la commune

				
				////////////// DEPARTEMENT
				
				var artif_dep00 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2000;
				var artif_dep06 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2006;
				var artif_dep12 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2012;
				var surf_dep = dep_data_t.features[indexdep].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_dep00 = (artif_dep00/surf_dep)*100;
				var prct_artif_dep06 = (artif_dep06/surf_dep)*100;
				var prct_artif_dep12 = (artif_dep12/surf_dep)*100;
				var depart_data = [prct_artif_dep00.toFixed(2),prct_artif_dep06.toFixed(2),prct_artif_dep12.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var artif_fac00 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2000;
				var artif_fac06 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2006;
				var artif_fac12 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2012;
				var surf_fac = facade_data_t.features[indexfac].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_fac00 = (artif_fac00/surf_fac)*100;
				var prct_artif_fac06 = (artif_fac06/surf_fac)*100;
				var prct_artif_fac12 = (artif_fac12/surf_fac)*100;
				var facade_data = [prct_artif_fac00.toFixed(2),prct_artif_fac06.toFixed(2),prct_artif_fac12.toFixed(2)];
				
				
				////////////// FRANCE
				
				var artif_fra00 = france_data_t.features[0].properties.SURF_ARTIF_2000;
				var artif_fra06 = france_data_t.features[0].properties.SURF_ARTIF_2006;
				var artif_fra12 = france_data_t.features[0].properties.SURF_ARTIF_2012;
				var surf_fra = france_data_t.features[0].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_fra00 = (artif_fra00/surf_fra)*100;
				var prct_artif_fra06 = (artif_fra06/surf_fra)*100;
				var prct_artif_fra12 = (artif_fra12/surf_fra)*100;
				var fra_data = [prct_artif_fra00.toFixed(2),prct_artif_fra06.toFixed(2),prct_artif_fra12.toFixed(2)];
				
				barChartData3.datasets[0].data = nouvelleData; 
				barChartData3.datasets[1].data = epci_graphe;
				barChartData3.datasets[2].data = depart_data;
				barChartData3.datasets[3].data = facade_data;
				barChartData3.datasets[4].data = fra_data;
				barChartData3.labels = ['2000', '2006', '2012'];
				window.myBar3.update();
		
				window.myBar3.options.title.text = 'Part des espaces artificialisés sur le territoire communal (%)';
				barChartData3.datasets[0].label = nomcom;
				barChartData3.datasets[1].label = "Moyenne " + epci;
				barChartData3.datasets[2].label = "Moyenne " + depart;
				window.myBar3.update();
			
			break;
			
			
			
			
			
			
			
			case '6': // Part des résidences secondaires
			
				////////////// COMMUNE
			
				var nb_log_com99 = sec_com.features[indexcom_r].properties.NB_LOG_1999;
				var nb_log_com11 = sec_com.features[indexcom_r].properties.NB_LOG_2011;
				var nb_log_com16 = sec_com.features[indexcom_r].properties.NB_LOG_2016;
				var nb_sec_com99 = sec_com.features[indexcom_r].properties.NB_SEC_1999;
				var nb_sec_com11 = sec_com.features[indexcom_r].properties.NB_SEC_2011;
				var nb_sec_com16 = sec_com.features[indexcom_r].properties.NB_SEC_2016;	
				var prct_sec_com_99 = (nb_sec_com99 / nb_log_com99 ) * 100;
				var prct_sec_com_11 = (nb_sec_com11 / nb_log_com11 ) * 100;
				var prct_sec_com_16 = (nb_sec_com16 / nb_log_com16 ) * 100;
				var nouvelleData = [prct_sec_com_99.toFixed(2),prct_sec_com_11.toFixed(2),prct_sec_com_16.toFixed(2)];

				////////////// EPCI

				var nb_log_epci99 = sec_epci.features[indexepci_r].properties.NB_LOG_1999;
				var nb_log_epci11 = sec_epci.features[indexepci_r].properties.NB_LOG_2011;
				var nb_log_epci16 = sec_epci.features[indexepci_r].properties.NB_LOG_2016;
				var nb_sec_epci99 = sec_epci.features[indexepci_r].properties.NB_SEC_1999;
				var nb_sec_epci11 = sec_epci.features[indexepci_r].properties.NB_SEC_2011;
				var nb_sec_epci16 = sec_epci.features[indexepci_r].properties.NB_SEC_2016;	
				var prct_sec_epci_99 = (nb_sec_epci99 / nb_log_epci99 ) * 100;
				var prct_sec_epci_11 = (nb_sec_epci11 / nb_log_epci11 ) * 100;
				var prct_sec_epci_16 = (nb_sec_epci16 / nb_log_epci16 ) * 100;
				var epci_graphe = [prct_sec_epci_99.toFixed(2),prct_sec_epci_11.toFixed(2),prct_sec_epci_16.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var nb_log_dep99 = sec_dep.features[indexdep_r].properties.NB_LOG_1999;
				var nb_log_dep11 = sec_dep.features[indexdep_r].properties.NB_LOG_2011;
				var nb_log_dep16 = sec_dep.features[indexdep_r].properties.NB_LOG_2016;
				var nb_sec_dep99 = sec_dep.features[indexdep_r].properties.NB_SEC_1999;
				var nb_sec_dep11 = sec_dep.features[indexdep_r].properties.NB_SEC_2011;
				var nb_sec_dep16 = sec_dep.features[indexdep_r].properties.NB_SEC_2016;	
				var prct_sec_dep_99 = (nb_sec_dep99 / nb_log_dep99 ) * 100;
				var prct_sec_dep_11 = (nb_sec_dep11 / nb_log_dep11 ) * 100;
				var prct_sec_dep_16 = (nb_sec_dep16 / nb_log_dep16 ) * 100;
				var depart_data = [prct_sec_dep_99.toFixed(2),prct_sec_dep_11.toFixed(2),prct_sec_dep_16.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var nb_log_fac99 = sec_fac.features[indexfac_r].properties.NB_LOG_1999;
				var nb_log_fac11 = sec_fac.features[indexfac_r].properties.NB_LOG_2011;
				var nb_log_fac16 = sec_fac.features[indexfac_r].properties.NB_LOG_2016;
				var nb_sec_fac99 = sec_fac.features[indexfac_r].properties.NB_SEC_1999;
				var nb_sec_fac11 = sec_fac.features[indexfac_r].properties.NB_SEC_2011;
				var nb_sec_fac16 = sec_fac.features[indexfac_r].properties.NB_SEC_2016;	
				var prct_sec_fac_99 = (nb_sec_fac99 / nb_log_fac99 ) * 100;
				var prct_sec_fac_11 = (nb_sec_fac11 / nb_log_fac11 ) * 100;
				var prct_sec_fac_16 = (nb_sec_fac16 / nb_log_fac16 ) * 100;
				var facade_data = [prct_sec_fac_99.toFixed(2),prct_sec_fac_11.toFixed(2),prct_sec_fac_16.toFixed(2)];
				
				
				////////////// FRANCE
				
				var nb_log_fra99 = sec_fra.features[0].properties.NB_LOG_1999;
				var nb_log_fra11 = sec_fra.features[0].properties.NB_LOG_2011;
				var nb_log_fra16 = sec_fra.features[0].properties.NB_LOG_2016;
				var nb_sec_fra99 = sec_fra.features[0].properties.NB_SEC_1999;
				var nb_sec_fra11 = sec_fra.features[0].properties.NB_SEC_2011;
				var nb_sec_fra16 = sec_fra.features[0].properties.NB_SEC_2016;	
				var prct_sec_fra_99 = (nb_sec_fra99 / nb_log_fra99 ) * 100;
				var prct_sec_fra_11 = (nb_sec_fra11 / nb_log_fra11 ) * 100;
				var prct_sec_fra_16 = (nb_sec_fra16 / nb_log_fra16 ) * 100;
				var fra_data = [prct_sec_fra_99.toFixed(2),prct_sec_fra_11.toFixed(2),prct_sec_fra_16.toFixed(2)];
				
				barChartData3.datasets[0].data = nouvelleData; 
				barChartData3.datasets[1].data = epci_graphe;
				barChartData3.datasets[2].data = depart_data;
				barChartData3.datasets[3].data = facade_data;
				barChartData3.datasets[4].data = fra_data;
				barChartData3.labels = ['1999', '2011', '2016'];
				window.myBar3.update();
		
				window.myBar3.options.title.text = 'Part des résidences secondaires dans le total des logements (%)';
				barChartData3.datasets[0].label = nomcom;
				barChartData3.datasets[1].label = "Moyenne " + epci;
				barChartData3.datasets[2].label = "Moyenne " + depart;
				window.myBar3.update();
						
			
			
			break;
			
			
			
			
			
			
			
			
			case '7': // Composition parc de logements
			
					while (barChartData3.datasets.length > 0 ){
						barChartData3.datasets.pop(); 
					}
			
			
				barChartData3.datasets.push({label : ' Maison avant 1991 ', backgroundColor: window.chartColors.green, stack : 'Stack 1', data : [1,1,1,2,1]});
				barChartData3.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [3,1,2,2,1]});
				barChartData3.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.blue, stack : 'Stack 1', data : [3,1,2,3,1]});
				barChartData3.datasets.push({label : ' Appartement avant 1991 ', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData3.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.grey, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData3.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData3.datasets.push({label : ' Autre avant 1991 ', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,4,3]});
				barChartData3.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.grey, stack : 'Stack 1', data : [3,1,2,2,3]});
				barChartData3.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,2,2]});


				////////////// Maison avant 1991

				var m_av_91_com = json_donnees_finales.features[indexcom_d].properties.MAISON_AVT91;
				var m_av_91_epci = epci_data.features[indexepci].properties.MAISON_AVT91;
				var m_av_91_dep = dep_data_t.features[indexdep].properties.MAISON_AVT91;
				var m_av_91_fac = facade_data_t.features[indexfac].properties.MAISON_AVT91;
				var m_av_91_fra = france_data_t.features[0].properties.MAISON_AVT91;


				////////////// Maison 1991 - 2005

				var m_9105_com = json_donnees_finales.features[indexcom_d].properties.MAISON_9105;
				var m_9105_epci = epci_data.features[indexepci].properties.MAISON_9105;
				var m_9105_dep = dep_data_t.features[indexdep].properties.MAISON_9105;
				var m_9105_fac = facade_data_t.features[indexfac].properties.MAISON_9105;
				var m_9105_fra = france_data_t.features[0].properties.MAISON_9105;

				////////////// Maison 2006 - 2013
	
				var m_0613_com = json_donnees_finales.features[indexcom_d].properties.MAISON_0613;
				var m_0613_epci = epci_data.features[indexepci].properties.MAISON_0613;
				var m_0613_dep = dep_data_t.features[indexdep].properties.MAISON_0613;
				var m_0613_fac = facade_data_t.features[indexfac].properties.MAISON_0613;
				var m_0613_fra = france_data_t.features[0].properties.MAISON_0613;
				
				////////////// Appartement avant 1991

				var ap_av_91_com = json_donnees_finales.features[indexcom_d].properties.APPART_AVT91;
				var ap_av_91_epci = epci_data.features[indexepci].properties.APPART_AVT91;
				var ap_av_91_dep = dep_data_t.features[indexdep].properties.APPART_AVT91;
				var ap_av_91_fac = facade_data_t.features[indexfac].properties.APPART_AVT91;
				var ap_av_91_fra = france_data_t.features[0].properties.APPART_AVT91;

				////////////// Appartement 1991 - 2005

				var ap_9105_com = json_donnees_finales.features[indexcom_d].properties.APPART_9105;
				var ap_9105_epci = epci_data.features[indexepci].properties.APPART_9105;
				var ap_9105_dep = dep_data_t.features[indexdep].properties.APPART_9105;
				var ap_9105_fac = facade_data_t.features[indexfac].properties.APPART_9105;
				var ap_9105_fra = france_data_t.features[0].properties.APPART_9105;


				////////////// Appartement 2006 - 2013
				
				var ap_0613_com = json_donnees_finales.features[indexcom_d].properties.APPART_0613;
				var ap_0613_epci = epci_data.features[indexepci].properties.APPART_0613;
				var ap_0613_dep = dep_data_t.features[indexdep].properties.APPART_0613;
				var ap_0613_fac = facade_data_t.features[indexfac].properties.APPART_0613;
				var ap_0613_fra = france_data_t.features[0].properties.APPART_0613;		
				
				
				////////////// Autre avant 1991
				
				var au_av_91_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_AVT91;
				var au_av_91_epci = epci_data.features[indexepci].properties.AUTRE_AVT91;
				var au_av_91_dep = dep_data_t.features[indexdep].properties.AUTRE_AVT91;
				var au_av_91_fac = facade_data_t.features[indexfac].properties.AUTRE_AVT91;
				var au_av_91_fra = france_data_t.features[0].properties.AUTRE_AVT91;
				
				
				////////////// Autre 1991 - 2005

				var au_9105_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_9105;
				var au_9105_epci = epci_data.features[indexepci].properties.AUTRE_9105;
				var au_9105_dep = dep_data_t.features[indexdep].properties.AUTRE_9105;
				var au_9105_fac = facade_data_t.features[indexfac].properties.AUTRE_9105;
				var au_9105_fra = france_data_t.features[0].properties.AUTRE_9105;


				////////////// Autre 2006 - 2013		

				var au_0613_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_0613;
				var au_0613_epci = epci_data.features[indexepci].properties.AUTRE_0613;
				var au_0613_dep = dep_data_t.features[indexdep].properties.AUTRE_0613;
				var au_0613_fac = facade_data_t.features[indexfac].properties.AUTRE_0613;
				var au_0613_fra = france_data_t.features[0].properties.AUTRE_0613;

				///////////// Nombre de logements 
				
				var nb_log_com = m_av_91_com + m_9105_com + m_0613_com + ap_av_91_com + ap_9105_com + ap_0613_com, au_av_91_com, au_9105_com, au_0613_com;
				var nb_log_epci = m_av_91_epci + m_9105_epci + m_0613_epci + ap_av_91_epci + ap_9105_epci + ap_0613_epci, au_av_91_epci, au_9105_epci, au_0613_epci;
				var nb_log_dep = m_av_91_dep + m_9105_dep + m_0613_dep + ap_av_91_dep + ap_9105_dep + ap_0613_dep, au_av_91_dep, au_9105_dep, au_0613_dep;
				var nb_log_fac = m_av_91_fac + m_9105_fac + m_0613_fac + ap_av_91_fac + ap_9105_fac + ap_0613_fac, au_av_91_fac, au_9105_fac, au_0613_fac;
				var nb_log_fra = m_av_91_fra + m_9105_fra + m_0613_fra + ap_av_91_fra + ap_9105_fra + ap_0613_fra, au_av_91_fra, au_9105_fra, au_0613_fra;

				//////////// Pourcentages maison avant 91 
				
				var p_m_av_91_com = (m_av_91_com / nb_log_com) * 100;
				var p_m_av_91_epci = (m_av_91_epci / nb_log_epci) * 100;
				var p_m_av_91_dep = (m_av_91_dep / nb_log_dep) * 100;
				var p_m_av_91_fac = (m_av_91_fac / nb_log_fac) * 100;
				var p_m_av_91_fra = (m_av_91_fra / nb_log_fra) * 100;
				
				barChartData3.datasets[0].data = [p_m_av_91_com.toFixed(2),p_m_av_91_epci.toFixed(2),p_m_av_91_dep.toFixed(2),p_m_av_91_fac.toFixed(2),p_m_av_91_fra.toFixed(2)];

				//////////// Pourcentages maison 1991 - 2005 
				
				var p_m_9105_com = (m_9105_com / nb_log_com) * 100;
				var p_m_9105_epci = (m_9105_epci / nb_log_epci) * 100;
				var p_m_9105_dep = (m_9105_dep / nb_log_dep) * 100;
				var p_m_9105_fac = (m_9105_fac / nb_log_fac) * 100;
				var p_m_9105_fra = (m_9105_fra / nb_log_fra) * 100;
				
				barChartData3.datasets[1].data = [p_m_9105_com.toFixed(2),p_m_9105_epci.toFixed(2),p_m_9105_dep.toFixed(2),p_m_9105_fac.toFixed(2),p_m_9105_fra.toFixed(2)];

				//////////// Pourcentages maison 2006 - 2013
				
				var p_m_0613_com = (m_0613_com / nb_log_com) * 100;
				var p_m_0613_epci = (m_0613_epci / nb_log_epci) * 100;
				var p_m_0613_dep = (m_0613_dep / nb_log_dep) * 100;
				var p_m_0613_fac = (m_0613_fac / nb_log_fac) * 100;
				var p_m_0613_fra = (m_0613_fra / nb_log_fra) * 100;
				
				barChartData3.datasets[2].data = [p_m_0613_com.toFixed(2),p_m_0613_epci.toFixed(2),p_m_0613_dep.toFixed(2),p_m_0613_fac.toFixed(2),p_m_0613_fra.toFixed(2)];

				//////////// Pourcentages appartement avant 1991

				var p_ap_av_91_com = (ap_av_91_com / nb_log_com) * 100;
				var p_ap_av_91_epci = (ap_av_91_epci / nb_log_epci) * 100;
				var p_ap_av_91_dep = (ap_av_91_dep / nb_log_dep) * 100;
				var p_ap_av_91_fac = (ap_av_91_fac / nb_log_fac) * 100;
				var p_ap_av_91_fra = (ap_av_91_fra / nb_log_fra) * 100;
				
				barChartData3.datasets[3].data = [p_ap_av_91_com.toFixed(2),p_ap_av_91_epci.toFixed(2),p_ap_av_91_dep.toFixed(2),p_ap_av_91_fac.toFixed(2),p_ap_av_91_fra.toFixed(2)];

				//////////// Pourcentages appartement 1991 - 2005 
				
				var p_ap_9105_com = (ap_9105_com / nb_log_com) * 100;
				var p_ap_9105_epci = (ap_9105_epci / nb_log_epci) * 100;
				var p_ap_9105_dep = (ap_9105_dep / nb_log_dep) * 100;
				var p_ap_9105_fac = (ap_9105_fac / nb_log_fac) * 100;
				var p_ap_9105_fra = (ap_9105_fra / nb_log_fra) * 100;
				
				barChartData3.datasets[4].data = [p_ap_9105_com.toFixed(2),p_ap_9105_epci.toFixed(2),p_ap_9105_dep.toFixed(2),p_ap_9105_fac.toFixed(2),p_ap_9105_fra.toFixed(2)];

				//////////// Pourcentages appartement 2006 - 2013
				
				var p_ap_0613_com = (ap_0613_com / nb_log_com) * 100;
				var p_ap_0613_epci = (ap_0613_epci / nb_log_epci) * 100;
				var p_ap_0613_dep = (ap_0613_dep / nb_log_dep) * 100;
				var p_ap_0613_fac = (ap_0613_fac / nb_log_fac) * 100;
				var p_ap_0613_fra = (ap_0613_fra / nb_log_fra) * 100;
				
				barChartData3.datasets[5].data = [p_ap_0613_com.toFixed(2),p_ap_0613_epci.toFixed(2),p_ap_0613_dep.toFixed(2),p_ap_0613_fac.toFixed(2),p_ap_0613_fra.toFixed(2)];

				//////////// Pourcentages autres avant 91 
				
				var p_au_av_91_com = (au_av_91_com / nb_log_com) * 100;
				var p_au_av_91_epci = (au_av_91_epci / nb_log_epci) * 100;
				var p_au_av_91_dep = (au_av_91_dep / nb_log_dep) * 100;
				var p_au_av_91_fac = (au_av_91_fac / nb_log_fac) * 100;
				var p_au_av_91_fra = (au_av_91_fra / nb_log_fra) * 100;
				
				barChartData3.datasets[6].data = [p_au_av_91_com.toFixed(2),p_au_av_91_epci.toFixed(2),p_au_av_91_dep.toFixed(2),p_au_av_91_fac.toFixed(2),p_au_av_91_fra.toFixed(2)];

				//////////// Pourcentages autres 1991 - 2005 
				
				var p_au_9105_com = (au_9105_com / nb_log_com) * 100;
				var p_au_9105_epci = (au_9105_epci / nb_log_epci) * 100;
				var p_au_9105_dep = (au_9105_dep / nb_log_dep) * 100;
				var p_au_9105_fac = (au_9105_fac / nb_log_fac) * 100;
				var p_au_9105_fra = (au_9105_fra / nb_log_fra) * 100;
				
				barChartData3.datasets[7].data = [p_au_9105_com.toFixed(2),p_au_9105_epci.toFixed(2),p_au_9105_dep.toFixed(2),p_au_9105_fac.toFixed(2),p_au_9105_fra.toFixed(2)];

				//////////// Pourcentages autres 2006 - 2013
				
				var p_au_0613_com = (au_0613_com / nb_log_com) * 100;
				var p_au_0613_epci = (au_0613_epci / nb_log_epci) * 100;
				var p_au_0613_dep = (au_0613_dep / nb_log_dep) * 100;
				var p_au_0613_fac = (au_0613_fac / nb_log_fac) * 100;
				var p_au_0613_fra = (au_0613_fra / nb_log_fra) * 100;
				
				barChartData3.datasets[8].data = [p_au_0613_com.toFixed(2),p_au_0613_epci.toFixed(2),p_au_0613_dep.toFixed(2),p_au_0613_fac.toFixed(2),p_au_0613_fra.toFixed(2)];

				barChartData3.datasets[0].backgroundColor = "#21618c";
				barChartData3.datasets[1].backgroundColor = "#3498db";
				barChartData3.datasets[2].backgroundColor = "#85c1e9";
				
				barChartData3.datasets[3].backgroundColor = "#e74c3c";
				barChartData3.datasets[4].backgroundColor = "#ec7063";
				barChartData3.datasets[5].backgroundColor = "#f5b7b1";
				
				barChartData3.datasets[6].backgroundColor = "#186a3b";
				barChartData3.datasets[7].backgroundColor = "#2ecc71";
				barChartData3.datasets[8].backgroundColor = "#82e0aa";

				barChartData3.labels = [nomcom, ['',epci], depart, ['',facade], 'France'];
				window.myBar3.update();
		
				window.myBar3.options.title.text = 'Composition du parc de logements en 2016 (parts en %)';
				window.myBar3.update();
						
						
			
			break;
			
			
			
			
			
			
			
			case '8': // Part des impôts ménages
			
				////////////// COMMUNE
			
				var fnb_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_0203);
				var fb_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.FB_0203);
				var th_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.TH_0203);
				var tp_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.TP_0203);
				
				var fnb_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_0910);
				var fb_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.FB_0910);
				var th_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.TH_0910);
				var tp_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.TP_0910);
				
				var fnb_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_1112);
				var fb_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.FB_1112);
				var th_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.TH_1112);
				var cfe_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.CFE_1112);
				var cvae_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.CVAE_1112);
				var ifer_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.IFER_1112);
				var tscom_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.TSCOM_1112);
				
				var fnb_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_1516);
				var fb_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.FB_1516);
				var th_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.TH_1516);
				var cfe_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.CFE_1516);
				var cvae_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.CVAE_1516);
				var ifer_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.IFER_1516);
				var tscom_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.TSCOM_1516);
				
				var part_m_com_02 = ((th_com_02 + fb_com_02)/(th_com_02 + fb_com_02 + fnb_com_02 + tp_com_02)) * 100
				var part_m_com_09 = ((th_com_09 + fb_com_09)/(th_com_09 + fb_com_09 + fnb_com_09 + tp_com_09)) * 100				
				var part_m_com_11 = ((th_com_11 + fb_com_11)/(th_com_11 + fb_com_11 + fnb_com_11 + cfe_com_11 + cvae_com_11 + ifer_com_11 + tscom_com_11)) * 100
				var part_m_com_15 = ((th_com_15 + fb_com_15)/(th_com_15 + fb_com_15 + fnb_com_15 + cfe_com_15 + cvae_com_15 + ifer_com_15 + tscom_com_15)) * 100				

				var nouvelleData = [part_m_com_02.toFixed(2),part_m_com_09.toFixed(2),part_m_com_11.toFixed(2),part_m_com_15.toFixed(2)]; 

				////////////// EPCI

				var fnb_epci_02 = Number(epci_data.features[indexepci].properties.FNB_0203);
				var fb_epci_02 = Number(epci_data.features[indexepci].properties.FB_0203);
				var th_epci_02 = Number(epci_data.features[indexepci].properties.TH_0203);
				var tp_epci_02 = Number(epci_data.features[indexepci].properties.TP_0203);
				
				var fnb_epci_09 = Number(epci_data.features[indexepci].properties.FNB_0910);
				var fb_epci_09 = Number(epci_data.features[indexepci].properties.FB_0910);
				var th_epci_09 = Number(epci_data.features[indexepci].properties.TH_0910);
				var tp_epci_09 = Number(epci_data.features[indexepci].properties.TP_0910);
				
				var fnb_epci_11 = Number(epci_data.features[indexepci].properties.FNB_1112);
				var fb_epci_11 = Number(epci_data.features[indexepci].properties.FB_1112);
				var th_epci_11 = Number(epci_data.features[indexepci].properties.TH_1112);
				var cfe_epci_11 = Number(epci_data.features[indexepci].properties.CFE_1112);
				var cvae_epci_11 = Number(epci_data.features[indexepci].properties.CVAE_1112);
				var ifer_epci_11 = Number(epci_data.features[indexepci].properties.IFER_1112);
				var tsepci_epci_11 = Number(epci_data.features[indexepci].properties.TSCOM_1112);
				
				var fnb_epci_15 = Number(epci_data.features[indexepci].properties.FNB_1516);
				var fb_epci_15 = Number(epci_data.features[indexepci].properties.FB_1516);
				var th_epci_15 = Number(epci_data.features[indexepci].properties.TH_1516);
				var cfe_epci_15 = Number(epci_data.features[indexepci].properties.CFE_1516);
				var cvae_epci_15 = Number(epci_data.features[indexepci].properties.CVAE_1516);
				var ifer_epci_15 = Number(epci_data.features[indexepci].properties.IFER_1516);
				var tsepci_epci_15 = Number(epci_data.features[indexepci].properties.TSCOM_1516);
				
				var part_m_epci_02 = ((th_epci_02 + fb_epci_02)/(th_epci_02 + fb_epci_02 + fnb_epci_02 + tp_epci_02)) * 100
				var part_m_epci_09 = ((th_epci_09 + fb_epci_09)/(th_epci_09 + fb_epci_09 + fnb_epci_09 + tp_epci_09)) * 100				
				var part_m_epci_11 = ((th_epci_11 + fb_epci_11)/(th_epci_11 + fb_epci_11 + fnb_epci_11 + cfe_epci_11 + cvae_epci_11 + ifer_epci_11 + tsepci_epci_11)) * 100
				var part_m_epci_15 = ((th_epci_15 + fb_epci_15)/(th_epci_15 + fb_epci_15 + fnb_epci_15 + cfe_epci_15 + cvae_epci_15 + ifer_epci_15 + tsepci_epci_15)) * 100				

				var epci_graphe = [part_m_epci_02.toFixed(2),part_m_epci_09.toFixed(2),part_m_epci_11.toFixed(2),part_m_epci_15.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var fnb_dep_02 = Number(dep_data_t.features[indexdep].properties.FNB_0203);
				var fb_dep_02 = Number(dep_data_t.features[indexdep].properties.FB_0203);
				var th_dep_02 = Number(dep_data_t.features[indexdep].properties.TH_0203);
				var tp_dep_02 = Number(dep_data_t.features[indexdep].properties.TP_0203);
				
				var fnb_dep_09 = Number(dep_data_t.features[indexdep].properties.FNB_0910);
				var fb_dep_09 = Number(dep_data_t.features[indexdep].properties.FB_0910);
				var th_dep_09 = Number(dep_data_t.features[indexdep].properties.TH_0910);
				var tp_dep_09 = Number(dep_data_t.features[indexdep].properties.TP_0910);
				
				var fnb_dep_11 = Number(dep_data_t.features[indexdep].properties.FNB_1112);
				var fb_dep_11 = Number(dep_data_t.features[indexdep].properties.FB_1112);
				var th_dep_11 = Number(dep_data_t.features[indexdep].properties.TH_1112);
				var cfe_dep_11 = Number(dep_data_t.features[indexdep].properties.CFE_1112);
				var cvae_dep_11 = Number(dep_data_t.features[indexdep].properties.CVAE_1112);
				var ifer_dep_11 = Number(dep_data_t.features[indexdep].properties.IFER_1112);
				var tsdep_dep_11 = Number(dep_data_t.features[indexdep].properties.TSCOM_1112);
				
				var fnb_dep_15 = Number(dep_data_t.features[indexdep].properties.FNB_1516);
				var fb_dep_15 = Number(dep_data_t.features[indexdep].properties.FB_1516);
				var th_dep_15 = Number(dep_data_t.features[indexdep].properties.TH_1516);
				var cfe_dep_15 = Number(dep_data_t.features[indexdep].properties.CFE_1516);
				var cvae_dep_15 = Number(dep_data_t.features[indexdep].properties.CVAE_1516);
				var ifer_dep_15 = Number(dep_data_t.features[indexdep].properties.IFER_1516);
				var tsdep_dep_15 = Number(dep_data_t.features[indexdep].properties.TSCOM_1516);
				
				var part_m_dep_02 = ((th_dep_02 + fb_dep_02)/(th_dep_02 + fb_dep_02 + fnb_dep_02 + tp_dep_02)) * 100
				var part_m_dep_09 = ((th_dep_09 + fb_dep_09)/(th_dep_09 + fb_dep_09 + fnb_dep_09 + tp_dep_09)) * 100				
				var part_m_dep_11 = ((th_dep_11 + fb_dep_11)/(th_dep_11 + fb_dep_11 + fnb_dep_11 + cfe_dep_11 + cvae_dep_11 + ifer_dep_11 + tsdep_dep_11)) * 100
				var part_m_dep_15 = ((th_dep_15 + fb_dep_15)/(th_dep_15 + fb_dep_15 + fnb_dep_15 + cfe_dep_15 + cvae_dep_15 + ifer_dep_15 + tsdep_dep_15)) * 100				

				var depart_data = [part_m_dep_02.toFixed(2),part_m_dep_09.toFixed(2),part_m_dep_11.toFixed(2),part_m_dep_15.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var fnb_facade_02 = Number(facade_data_t.features[indexfac].properties.FNB_0203);
				var fb_facade_02 = Number(facade_data_t.features[indexfac].properties.FB_0203);
				var th_facade_02 = Number(facade_data_t.features[indexfac].properties.TH_0203);
				var tp_facade_02 = Number(facade_data_t.features[indexfac].properties.TP_0203);
				
				var fnb_facade_09 = Number(facade_data_t.features[indexfac].properties.FNB_0910);
				var fb_facade_09 = Number(facade_data_t.features[indexfac].properties.FB_0910);
				var th_facade_09 = Number(facade_data_t.features[indexfac].properties.TH_0910);
				var tp_facade_09 = Number(facade_data_t.features[indexfac].properties.TP_0910);
				
				var fnb_facade_11 = Number(facade_data_t.features[indexfac].properties.FNB_1112);
				var fb_facade_11 = Number(facade_data_t.features[indexfac].properties.FB_1112);
				var th_facade_11 = Number(facade_data_t.features[indexfac].properties.TH_1112);
				var cfe_facade_11 = Number(facade_data_t.features[indexfac].properties.CFE_1112);
				var cvae_facade_11 = Number(facade_data_t.features[indexfac].properties.CVAE_1112);
				var ifer_facade_11 = Number(facade_data_t.features[indexfac].properties.IFER_1112);
				var tsfacade_facade_11 = Number(facade_data_t.features[indexfac].properties.TSCOM_1112);
				
				var fnb_facade_15 = Number(facade_data_t.features[indexfac].properties.FNB_1516);
				var fb_facade_15 = Number(facade_data_t.features[indexfac].properties.FB_1516);
				var th_facade_15 = Number(facade_data_t.features[indexfac].properties.TH_1516);
				var cfe_facade_15 = Number(facade_data_t.features[indexfac].properties.CFE_1516);
				var cvae_facade_15 = Number(facade_data_t.features[indexfac].properties.CVAE_1516);
				var ifer_facade_15 = Number(facade_data_t.features[indexfac].properties.IFER_1516);
				var tsfacade_facade_15 = Number(facade_data_t.features[indexfac].properties.TSCOM_1516);
				
				var part_m_facade_02 = ((th_facade_02 + fb_facade_02)/(th_facade_02 + fb_facade_02 + fnb_facade_02 + tp_facade_02)) * 100
				var part_m_facade_09 = ((th_facade_09 + fb_facade_09)/(th_facade_09 + fb_facade_09 + fnb_facade_09 + tp_facade_09)) * 100				
				var part_m_facade_11 = ((th_facade_11 + fb_facade_11)/(th_facade_11 + fb_facade_11 + fnb_facade_11 + cfe_facade_11 + cvae_facade_11 + ifer_facade_11 + tsfacade_facade_11)) * 100
				var part_m_facade_15 = ((th_facade_15 + fb_facade_15)/(th_facade_15 + fb_facade_15 + fnb_facade_15 + cfe_facade_15 + cvae_facade_15 + ifer_facade_15 + tsfacade_facade_15)) * 100				

				var facade_data = [part_m_facade_02.toFixed(2),part_m_facade_09.toFixed(2),part_m_facade_11.toFixed(2),part_m_facade_15.toFixed(2)];
				
				
				////////////// FRANCE
				
				var fnb_france_02 = Number(france_data_t.features[0].properties.FNB_0203);
				var fb_france_02 = Number(france_data_t.features[0].properties.FB_0203);
				var th_france_02 = Number(france_data_t.features[0].properties.TH_0203);
				var tp_france_02 = Number(france_data_t.features[0].properties.TP_0203);
				
				var fnb_france_09 = Number(france_data_t.features[0].properties.FNB_0910);
				var fb_france_09 = Number(france_data_t.features[0].properties.FB_0910);
				var th_france_09 = Number(france_data_t.features[0].properties.TH_0910);
				var tp_france_09 = Number(france_data_t.features[0].properties.TP_0910);
				
				var fnb_france_11 = Number(france_data_t.features[0].properties.FNB_1112);
				var fb_france_11 = Number(france_data_t.features[0].properties.FB_1112);
				var th_france_11 = Number(france_data_t.features[0].properties.TH_1112);
				var cfe_france_11 = Number(france_data_t.features[0].properties.CFE_1112);
				var cvae_france_11 = Number(france_data_t.features[0].properties.CVAE_1112);
				var ifer_france_11 = Number(france_data_t.features[0].properties.IFER_1112);
				var tsfrance_france_11 = Number(france_data_t.features[0].properties.TSCOM_1112);
				
				var fnb_france_15 = Number(france_data_t.features[0].properties.FNB_1516);
				var fb_france_15 = Number(france_data_t.features[0].properties.FB_1516);
				var th_france_15 = Number(france_data_t.features[0].properties.TH_1516);
				var cfe_france_15 = Number(france_data_t.features[0].properties.CFE_1516);
				var cvae_france_15 = Number(france_data_t.features[0].properties.CVAE_1516);
				var ifer_france_15 = Number(france_data_t.features[0].properties.IFER_1516);
				var tsfrance_france_15 = Number(france_data_t.features[0].properties.TSCOM_1516);
				
				var part_m_france_02 = ((th_france_02 + fb_france_02)/(th_france_02 + fb_france_02 + fnb_france_02 + tp_france_02)) * 100
				var part_m_france_09 = ((th_france_09 + fb_france_09)/(th_france_09 + fb_france_09 + fnb_france_09 + tp_france_09)) * 100				
				var part_m_france_11 = ((th_france_11 + fb_france_11)/(th_france_11 + fb_france_11 + fnb_france_11 + cfe_france_11 + cvae_france_11 + ifer_france_11 + tsfrance_france_11)) * 100
				var part_m_france_15 = ((th_france_15 + fb_france_15)/(th_france_15 + fb_france_15 + fnb_france_15 + cfe_france_15 + cvae_france_15 + ifer_france_15 + tsfrance_france_15)) * 100				

				var fra_data = [part_m_france_02.toFixed(2),part_m_france_09.toFixed(2),part_m_france_11.toFixed(2),part_m_france_15.toFixed(2)];
				
				barChartData3.datasets[0].data = nouvelleData; // Remplacement des données de base par les données de population 
				barChartData3.datasets[1].data = epci_graphe;
				barChartData3.datasets[2].data = depart_data;
				barChartData3.datasets[3].data = facade_data;
				barChartData3.datasets[4].data = fra_data;
				barChartData3.labels = ['2002-03', '2009-10', '2011-12', '2015-16'];
				window.myBar3.update();
		
				window.myBar3.options.title.text = 'Part du produit des impôts ménages dans le produit total des impôts locaux du bloc communal (%)';
				barChartData3.datasets[0].label = nomcom;
				barChartData3.datasets[1].label = "Moyenne " + epci;
				barChartData3.datasets[2].label = "Moyenne " + depart;
				window.myBar3.update();
						
						
			
			
			break;
			
			
			case '9': // Part des recettes fiscales dans le produit total de fonctionnement
			
				////////////// COMMUNE
			
				var fisc_com02 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_0203);
				var fisc_com09 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_0910);
				var fisc_com15 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_1516);
				var fonct_com02 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_0203);
				var fonct_com09 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_0910);
				var fonct_com15 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_1516);
				
				var part_fisc_com02 = (fisc_com02 / fonct_com02 ) * 100;
				var part_fisc_com09 = (fisc_com09 / fonct_com09 ) * 100;
				var part_fisc_com15 = (fisc_com15 / fonct_com15 ) * 100;
				
				var nouvelleData = [part_fisc_com02.toFixed(2),part_fisc_com09.toFixed(2),part_fisc_com15.toFixed(2)]; 

				////////////// EPCI

				var fisc_epci02 = Number(epci_data.features[indexepci].properties.FISC_0203);
				var fisc_epci09 = Number(epci_data.features[indexepci].properties.FISC_0910);
				var fisc_epci15 = Number(epci_data.features[indexepci].properties.FISC_1516);
				var fonct_epci02 = Number(epci_data.features[indexepci].properties.P_FCT_0203);
				var fonct_epci09 = Number(epci_data.features[indexepci].properties.P_FCT_0910);
				var fonct_epci15 = Number(epci_data.features[indexepci].properties.P_FCT_1516);
				
				var part_fisc_epci02 = (fisc_epci02 / fonct_epci02 ) * 100;
				var part_fisc_epci09 = (fisc_epci09 / fonct_epci09 ) * 100;
				var part_fisc_epci15 = (fisc_epci15 / fonct_epci15 ) * 100;
				
				var epci_graphe = [part_fisc_epci02.toFixed(2),part_fisc_epci09.toFixed(2),part_fisc_epci15.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var fisc_depart02 = Number(dep_data_t.features[indexdep].properties.FISC_0203);
				var fisc_depart09 = Number(dep_data_t.features[indexdep].properties.FISC_0910);
				var fisc_depart15 = Number(dep_data_t.features[indexdep].properties.FISC_1516);
				var fonct_depart02 = Number(dep_data_t.features[indexdep].properties.P_FCT_0203);
				var fonct_depart09 = Number(dep_data_t.features[indexdep].properties.P_FCT_0910);
				var fonct_depart15 = Number(dep_data_t.features[indexdep].properties.P_FCT_1516);
				
				var part_fisc_depart02 = (fisc_depart02 / fonct_depart02 ) * 100;
				var part_fisc_depart09 = (fisc_depart09 / fonct_depart09 ) * 100;
				var part_fisc_depart15 = (fisc_depart15 / fonct_depart15 ) * 100;
				
				var depart_data = [part_fisc_depart02.toFixed(2),part_fisc_depart09.toFixed(2),part_fisc_depart15.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var fisc_facade02 = Number(facade_data_t.features[indexfac].properties.FISC_0203);
				var fisc_facade09 = Number(facade_data_t.features[indexfac].properties.FISC_0910);
				var fisc_facade15 = Number(facade_data_t.features[indexfac].properties.FISC_1516);
				var fonct_facade02 = Number(facade_data_t.features[indexfac].properties.P_FCT_0203);
				var fonct_facade09 = Number(facade_data_t.features[indexfac].properties.P_FCT_0910);
				var fonct_facade15 = Number(facade_data_t.features[indexfac].properties.P_FCT_1516);
				
				var part_fisc_facade02 = (fisc_facade02 / fonct_facade02 ) * 100;
				var part_fisc_facade09 = (fisc_facade09 / fonct_facade09 ) * 100;
				var part_fisc_facade15 = (fisc_facade15 / fonct_facade15 ) * 100;
				
				var facade_data = [part_fisc_facade02.toFixed(2),part_fisc_facade09.toFixed(2),part_fisc_facade15.toFixed(2)];
				
				
				////////////// FRANCE
				
				var fisc_france02 = Number(france_data_t.features[0].properties.FISC_0203);
				var fisc_france09 = Number(france_data_t.features[0].properties.FISC_0910);
				var fisc_france15 = Number(france_data_t.features[0].properties.FISC_1516);
				var fonct_france02 = Number(france_data_t.features[0].properties.P_FCT_0203);
				var fonct_france09 = Number(france_data_t.features[0].properties.P_FCT_0910);
				var fonct_france15 = Number(france_data_t.features[0].properties.P_FCT_1516);
				
				var part_fisc_france02 = (fisc_france02 / fonct_france02 ) * 100;
				var part_fisc_france09 = (fisc_france09 / fonct_france09 ) * 100;
				var part_fisc_france15 = (fisc_france15 / fonct_france15 ) * 100;
				
				var fra_data = [part_fisc_france02.toFixed(2),part_fisc_france09.toFixed(2),part_fisc_france15.toFixed(2)];
				
				barChartData3.datasets[0].data = nouvelleData; 
				barChartData3.datasets[1].data = epci_graphe;
				barChartData3.datasets[2].data = depart_data;
				barChartData3.datasets[3].data = facade_data;
				barChartData3.datasets[4].data = fra_data;
				barChartData3.labels = ['2002-03', '2009-10', '2015-16'];
				window.myBar3.update();
		
				window.myBar3.options.title.text = 'Part des recettes fiscales dans le produit total de fonctionnement (%)';
				barChartData3.datasets[0].label = nomcom;
				barChartData3.datasets[1].label = "Moyenne " + epci;
				barChartData3.datasets[2].label = "Moyenne " + depart;
				window.myBar3.update();
						
			
			
			break;
			
			
			
		}	
		
	}
	
		function graphe4(choix) {	
		document.getElementById("selecteur4").style.visibility = "hidden";
		
		
		while (barChartData4.datasets.length > 0){
			barChartData4.datasets.pop(); 
		}
		
		barChartData4.datasets.push({label : nomcom, backgroundColor: window.chartColors.red, stack : 'Stack 0', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData4.datasets.push({label : 'Moyenne ' + epci, backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData4.datasets.push({label : 'Moyenne ' + depart, backgroundColor: window.chartColors.yellow, stack : 'Stack 2', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData4.datasets.push({label : 'Moyenne ' + facade, backgroundColor: window.chartColors.blue, stack : 'Stack 3', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});
		barChartData4.datasets.push({label : 'Moyenne France', backgroundColor: window.chartColors.green, stack : 'Stack 4', data : [getRandomInt(60,5550),getRandomInt(60,5550),getRandomInt(60,5550)]});

		window.myBar4.options.legend.display = true;
		window.myBar4.update();


		var valeur_graphe4 = document.getElementById("graphique4"); 
		var choixUti4 = valeur_graphe4.options[valeur_graphe4.selectedIndex].value; // Récupération du choix de l'utilisateur

		switch (choixUti4) { // Calcul des données des graphiques en fonction du choix de l'utilisateur graphique 4
			case '1': // Cas n°1 : données de population 

				////////////// COMMUNE
			
				var pop_com99 = json_donnees_finales.features[indexcom_d].properties.Pop_1999;
				var pop_com10 = json_donnees_finales.features[indexcom_d].properties.Pop_2010;
				var pop_com15 = json_donnees_finales.features[indexcom_d].properties.Pop_2015;
				var evolpop9910 = (((pop_com10-pop_com99)/pop_com99)*100)/11;
				var evolpop1015 = (((pop_com15-pop_com10)/pop_com10)*100)/5;
				var nouvelleData = [evolpop9910.toFixed(2),evolpop1015.toFixed(2)]; // Valeur d'évolution de la population de la commune

				////////////// EPCI

				var pop_epci99 = epci_data.features[indexepci].properties.Pop_1999;
				var pop_epci10 = epci_data.features[indexepci].properties.Pop_2010;
				var pop_epci15 = epci_data.features[indexepci].properties.Pop_2015;
				var evolpopepci9910 = (((pop_epci10-pop_epci99)/pop_epci99)*100)/11;
				var evolpopepci1015 = (((pop_epci15-pop_epci10)/pop_epci10)*100)/5;
				var epci_graphe = [evolpopepci9910.toFixed(2),evolpopepci1015.toFixed(2)]; // Valeur d'évolution de la population de la commune

				
				////////////// DEPARTEMENT
				
				var pop_depart99 = dep_data_t.features[indexdep].properties.Pop_1999;
				var pop_depart10 = dep_data_t.features[indexdep].properties.Pop_2010;
				var pop_depart15 = dep_data_t.features[indexdep].properties.Pop_2015;
				var evolpopdepart9910 = (((pop_depart10-pop_depart99)/pop_depart99)*100)/11;
				var evolpopdepart1015 = (((pop_depart15-pop_depart10)/pop_depart10)*100)/5;
				var depart_data = [evolpopdepart9910.toFixed(2),evolpopdepart1015.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var pop_facade99 = facade_data_t.features[indexfac].properties.Pop_1999;
				var pop_facade10 = facade_data_t.features[indexfac].properties.Pop_2010;
				var pop_facade15 = facade_data_t.features[indexfac].properties.Pop_2015;
				var evolpopfacade9910 = (((pop_facade10-pop_facade99)/pop_facade99)*100)/11;
				var evolpopfacade1015 = (((pop_facade15-pop_facade10)/pop_facade10)*100)/5;
				var facade_data = [evolpopfacade9910.toFixed(2),evolpopfacade1015.toFixed(2)];
				
				
				////////////// FRANCE
				
				var pop_fra99 = france_data_t.features[0].properties.Pop_1999;
				var pop_fra10 = france_data_t.features[0].properties.Pop_2010;
				var pop_fra15 = france_data_t.features[0].properties.Pop_2015;
				var evolpopfra9910 = (((pop_fra10-pop_fra99)/pop_fra99)*100)/11;
				var evolpopfra1015 = (((pop_fra15-pop_fra10)/pop_fra10)*100)/5;
				var fra_data = [evolpopfra9910.toFixed(2),evolpopfra1015.toFixed(2)];
				
				barChartData4.datasets[0].data = nouvelleData; // Remplacement des données de base par les données de population 
				barChartData4.datasets[1].data = epci_graphe;
				barChartData4.datasets[2].data = depart_data;
				barChartData4.datasets[3].data = facade_data;
				barChartData4.datasets[4].data = fra_data;
				barChartData4.labels = ['1999 - 2010', '2010 - 2015'];
				window.myBar4.update();
		
				window.myBar4.options.title.text = 'Taux d\'évolution annuel de la population (%)';
				barChartData4.datasets[0].label = nomcom;
				barChartData4.datasets[1].label = "Moyenne " + epci;
				barChartData4.datasets[2].label = "Moyenne " + depart;
				window.myBar4.update();
				
				
			break;
			
			
			
			
			
			case '2': // Cas n°2 : Structure des âges
			
				while (barChartData4.datasets.length > 0 ){
					barChartData4.datasets.pop(); 
				}
				
				document.getElementById("selecteur4").style.visibility = "visible";
				
				barChartData4.datasets.push({label : ' -15 ans', backgroundColor: window.chartColors.red, stack : 'Stack 1', data : [1,1,1,5,5,5,5,5,5,5,5,5]});
				barChartData4.datasets.push({label : ' 15 - 29 ans', backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData4.datasets.push({label : ' 30 - 44 ans', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData4.datasets.push({label : ' 45 - 59 ans', backgroundColor: window.chartColors.blue, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData4.datasets.push({label : ' 60 - 74 ans', backgroundColor: window.chartColors.green, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				barChartData4.datasets.push({label : ' 75 ans et plus', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,5,5,5,5,5,5,5,5,5]});
				
				//////////////// Populations
				
				var pop_com_s_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP;
				var pop_com_s_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP;
				var pop_com_s_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP;
				var pop_epci_s_99 = epci_data.features[indexepci].properties.P99_POP;
				var pop_epci_s_10 = epci_data.features[indexepci].properties.P10_POP;
				var pop_epci_s_16 = epci_data.features[indexepci].properties.P16_POP;
				var pop_dep_s_99 = dep_data_t.features[indexdep].properties.P99_POP;
				var pop_dep_s_10 = dep_data_t.features[indexdep].properties.P10_POP;
				var pop_dep_s_16 = dep_data_t.features[indexdep].properties.P16_POP;
				var pop_fac_s_99 = facade_data_t.features[indexfac].properties.P99_POP;
				var pop_fac_s_10 = facade_data_t.features[indexfac].properties.P10_POP;
				var pop_fac_s_16 = facade_data_t.features[indexfac].properties.P16_POP;
				var pop_fra_s_99 = france_data_t.features[0].properties.P99_POP;
				var pop_fra_s_10 = france_data_t.features[0].properties.P10_POP;
				var pop_fra_s_16 = france_data_t.features[0].properties.P16_POP;
				
				
				
				////////////// Moins de 15 ans 
				
				var moins_15_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP0014;
				var moins_15_epci_99 = epci_data.features[indexepci].properties.P99_POP0014;
				var moins_15_dep_99 = dep_data_t.features[indexdep].properties.P99_POP0014;
				var moins_15_fac_99 = facade_data_t.features[indexfac].properties.P99_POP0014;
				var moins_15_fra_99 = france_data_t.features[0].properties.P99_POP0014;
				var moins_15_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP0014;
				var moins_15_epci_10 = epci_data.features[indexepci].properties.P10_POP0014;
				var moins_15_dep_10 = dep_data_t.features[indexdep].properties.P10_POP0014;
				var moins_15_fac_10 = facade_data_t.features[indexfac].properties.P10_POP0014;
				var moins_15_fra_10 = france_data_t.features[0].properties.P10_POP0014;
				var moins_15_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP0014;
				var moins_15_epci_16 = epci_data.features[indexepci].properties.P16_POP0014;
				var moins_15_dep_16 = dep_data_t.features[indexdep].properties.P16_POP0014;
				var moins_15_fac_16 = facade_data_t.features[indexfac].properties.P16_POP0014;
				var moins_15_fra_16 = france_data_t.features[0].properties.P16_POP0014;
				
				var part_moins_15_com_99 = (moins_15_com_99 / pop_com_s_99) * 100;
				var part_moins_15_epci_99 = (moins_15_epci_99 / pop_epci_s_99) * 100;
				var part_moins_15_dep_99 = (moins_15_dep_99 / pop_dep_s_99) * 100;
				var part_moins_15_fac_99 = (moins_15_fac_99 / pop_fac_s_99) * 100;
				var part_moins_15_fra_99 = (moins_15_fra_99 / pop_fra_s_99) * 100;
				var part_moins_15_com_10 = (moins_15_com_10 / pop_com_s_10) * 100;
				var part_moins_15_epci_10 = (moins_15_epci_10 / pop_epci_s_10) * 100;
				var part_moins_15_dep_10 = (moins_15_dep_10 / pop_dep_s_10) * 100;
				var part_moins_15_fac_10 = (moins_15_fac_10 / pop_fac_s_10) * 100;
				var part_moins_15_fra_10 = (moins_15_fra_10 / pop_fra_s_10) * 100;
				var part_moins_15_com_16 = (moins_15_com_16 / pop_com_s_16) * 100;
				var part_moins_15_epci_16 = (moins_15_epci_16 / pop_epci_s_16) * 100;
				var part_moins_15_dep_16 = (moins_15_dep_16 / pop_dep_s_16) * 100;
				var part_moins_15_fac_16 = (moins_15_fac_16 / pop_fac_s_16) * 100;
				var part_moins_15_fra_16 = (moins_15_fra_16 / pop_fra_s_16) * 100;

				////////////// 15 à 29 ans

				var p_1529_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP1529;
				var p_1529_epci_99 = epci_data.features[indexepci].properties.P99_POP1529;
				var p_1529_dep_99 = dep_data_t.features[indexdep].properties.P99_POP1529;
				var p_1529_fac_99 = facade_data_t.features[indexfac].properties.P99_POP1529;
				var p_1529_fra_99 = france_data_t.features[0].properties.P99_POP1529;
				var p_1529_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP1529;
				var p_1529_epci_10 = epci_data.features[indexepci].properties.P10_POP1529;
				var p_1529_dep_10 = dep_data_t.features[indexdep].properties.P10_POP1529;
				var p_1529_fac_10 = facade_data_t.features[indexfac].properties.P10_POP1529;
				var p_1529_fra_10 = france_data_t.features[0].properties.P10_POP1529;
				var p_1529_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP1529;
				var p_1529_epci_16 = epci_data.features[indexepci].properties.P16_POP1529;
				var p_1529_dep_16 = dep_data_t.features[indexdep].properties.P16_POP1529;
				var p_1529_fac_16 = facade_data_t.features[indexfac].properties.P16_POP1529;
				var p_1529_fra_16 = france_data_t.features[0].properties.P16_POP1529;

				var part_p_1529_com_99 = (p_1529_com_99 / pop_com_s_99) * 100;
				var part_p_1529_epci_99 = (p_1529_epci_99 / pop_epci_s_99) * 100;
				var part_p_1529_dep_99 = (p_1529_dep_99 / pop_dep_s_99) * 100;
				var part_p_1529_fac_99 = (p_1529_fac_99 / pop_fac_s_99) * 100;
				var part_p_1529_fra_99 = (p_1529_fra_99 / pop_fra_s_99) * 100;
				var part_p_1529_com_10 = (p_1529_com_10 / pop_com_s_10) * 100;
				var part_p_1529_epci_10 = (p_1529_epci_10 / pop_epci_s_10) * 100;
				var part_p_1529_dep_10 = (p_1529_dep_10 / pop_dep_s_10) * 100;
				var part_p_1529_fac_10 = (p_1529_fac_10 / pop_fac_s_10) * 100;
				var part_p_1529_fra_10 = (p_1529_fra_10 / pop_fra_s_10) * 100;
				var part_p_1529_com_16 = (p_1529_com_16 / pop_com_s_16) * 100;
				var part_p_1529_epci_16 = (p_1529_epci_16 / pop_epci_s_16) * 100;
				var part_p_1529_dep_16 = (p_1529_dep_16 / pop_dep_s_16) * 100;
				var part_p_1529_fac_16 = (p_1529_fac_16 / pop_fac_s_16) * 100;
				var part_p_1529_fra_16 = (p_1529_fra_16 / pop_fra_s_16) * 100;
				
				
				
				////////////// 30 à 44 ans
				
				var p_3044_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP3044;
				var p_3044_epci_99 = epci_data.features[indexepci].properties.P99_POP3044;
				var p_3044_dep_99 = dep_data_t.features[indexdep].properties.P99_POP3044;
				var p_3044_fac_99 = facade_data_t.features[indexfac].properties.P99_POP3044;
				var p_3044_fra_99 = france_data_t.features[0].properties.P99_POP3044;
				var p_3044_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP3044;
				var p_3044_epci_10 = epci_data.features[indexepci].properties.P10_POP3044;
				var p_3044_dep_10 = dep_data_t.features[indexdep].properties.P10_POP3044;
				var p_3044_fac_10 = facade_data_t.features[indexfac].properties.P10_POP3044;
				var p_3044_fra_10 = france_data_t.features[0].properties.P10_POP3044;
				var p_3044_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP3044;
				var p_3044_epci_16 = epci_data.features[indexepci].properties.P16_POP3044;
				var p_3044_dep_16 = dep_data_t.features[indexdep].properties.P16_POP3044;
				var p_3044_fac_16 = facade_data_t.features[indexfac].properties.P16_POP3044;
				var p_3044_fra_16 = france_data_t.features[0].properties.P16_POP3044;
				
				var part_p_3044_com_99 = (p_3044_com_99 / pop_com_s_99) * 100;
				var part_p_3044_epci_99 = (p_3044_epci_99 / pop_epci_s_99) * 100;
				var part_p_3044_dep_99 = (p_3044_dep_99 / pop_dep_s_99) * 100;
				var part_p_3044_fac_99 = (p_3044_fac_99 / pop_fac_s_99) * 100;
				var part_p_3044_fra_99 = (p_3044_fra_99 / pop_fra_s_99) * 100;
				var part_p_3044_com_10 = (p_3044_com_10 / pop_com_s_10) * 100;
				var part_p_3044_epci_10 = (p_3044_epci_10 / pop_epci_s_10) * 100;
				var part_p_3044_dep_10 = (p_3044_dep_10 / pop_dep_s_10) * 100;
				var part_p_3044_fac_10 = (p_3044_fac_10 / pop_fac_s_10) * 100;
				var part_p_3044_fra_10 = (p_3044_fra_10 / pop_fra_s_10) * 100;
				var part_p_3044_com_16 = (p_3044_com_16 / pop_com_s_16) * 100;
				var part_p_3044_epci_16 = (p_3044_epci_16 / pop_epci_s_16) * 100;
				var part_p_3044_dep_16 = (p_3044_dep_16 / pop_dep_s_16) * 100;
				var part_p_3044_fac_16 = (p_3044_fac_16 / pop_fac_s_16) * 100;
				var part_p_3044_fra_16 = (p_3044_fra_16 / pop_fra_s_16) * 100;
				
				////////////// 45 à 59 ans 
				
				var p_4559_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP4559;
				var p_4559_epci_99 = epci_data.features[indexepci].properties.P99_POP4559;
				var p_4559_dep_99 = dep_data_t.features[indexdep].properties.P99_POP4559;
				var p_4559_fac_99 = facade_data_t.features[indexfac].properties.P99_POP4559;
				var p_4559_fra_99 = france_data_t.features[0].properties.P99_POP4559;
				var p_4559_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP4559;
				var p_4559_epci_10 = epci_data.features[indexepci].properties.P10_POP4559;
				var p_4559_dep_10 = dep_data_t.features[indexdep].properties.P10_POP4559;
				var p_4559_fac_10 = facade_data_t.features[indexfac].properties.P10_POP4559;
				var p_4559_fra_10 = france_data_t.features[0].properties.P10_POP4559;
				var p_4559_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP4559;
				var p_4559_epci_16 = epci_data.features[indexepci].properties.P16_POP4559;
				var p_4559_dep_16 = dep_data_t.features[indexdep].properties.P16_POP4559;
				var p_4559_fac_16 = facade_data_t.features[indexfac].properties.P16_POP4559;
				var p_4559_fra_16 = france_data_t.features[0].properties.P16_POP4559;
				
				var part_p_4559_com_99 = (p_4559_com_99 / pop_com_s_99) * 100;
				var part_p_4559_epci_99 = (p_4559_epci_99 / pop_epci_s_99) * 100;
				var part_p_4559_dep_99 = (p_4559_dep_99 / pop_dep_s_99) * 100;
				var part_p_4559_fac_99 = (p_4559_fac_99 / pop_fac_s_99) * 100;
				var part_p_4559_fra_99 = (p_4559_fra_99 / pop_fra_s_99) * 100;
				var part_p_4559_com_10 = (p_4559_com_10 / pop_com_s_10) * 100;
				var part_p_4559_epci_10 = (p_4559_epci_10 / pop_epci_s_10) * 100;
				var part_p_4559_dep_10 = (p_4559_dep_10 / pop_dep_s_10) * 100;
				var part_p_4559_fac_10 = (p_4559_fac_10 / pop_fac_s_10) * 100;
				var part_p_4559_fra_10 = (p_4559_fra_10 / pop_fra_s_10) * 100;
				var part_p_4559_com_16 = (p_4559_com_16 / pop_com_s_16) * 100;
				var part_p_4559_epci_16 = (p_4559_epci_16 / pop_epci_s_16) * 100;
				var part_p_4559_dep_16 = (p_4559_dep_16 / pop_dep_s_16) * 100;
				var part_p_4559_fac_16 = (p_4559_fac_16 / pop_fac_s_16) * 100;
				var part_p_4559_fra_16 = (p_4559_fra_16 / pop_fra_s_16) * 100;
				
				
				////////////// 60 à 74 ans
				
				var p_6074_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP6074;
				var p_6074_epci_99 = epci_data.features[indexepci].properties.P99_POP6074;
				var p_6074_dep_99 = dep_data_t.features[indexdep].properties.P99_POP6074;
				var p_6074_fac_99 = facade_data_t.features[indexfac].properties.P99_POP6074;
				var p_6074_fra_99 = france_data_t.features[0].properties.P99_POP6074;
				var p_6074_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP6074;
				var p_6074_epci_10 = epci_data.features[indexepci].properties.P10_POP6074;
				var p_6074_dep_10 = dep_data_t.features[indexdep].properties.P10_POP6074;
				var p_6074_fac_10 = facade_data_t.features[indexfac].properties.P10_POP6074;
				var p_6074_fra_10 = france_data_t.features[0].properties.P10_POP6074;
				var p_6074_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP6074;
				var p_6074_epci_16 = epci_data.features[indexepci].properties.P16_POP6074;
				var p_6074_dep_16 = dep_data_t.features[indexdep].properties.P16_POP6074;
				var p_6074_fac_16 = facade_data_t.features[indexfac].properties.P16_POP6074;
				var p_6074_fra_16 = france_data_t.features[0].properties.P16_POP6074;

				var part_p_6074_com_99 = (p_6074_com_99 / pop_com_s_99) * 100;
				var part_p_6074_epci_99 = (p_6074_epci_99 / pop_epci_s_99) * 100;
				var part_p_6074_dep_99 = (p_6074_dep_99 / pop_dep_s_99) * 100;
				var part_p_6074_fac_99 = (p_6074_fac_99 / pop_fac_s_99) * 100;
				var part_p_6074_fra_99 = (p_6074_fra_99 / pop_fra_s_99) * 100;
				var part_p_6074_com_10 = (p_6074_com_10 / pop_com_s_10) * 100;
				var part_p_6074_epci_10 = (p_6074_epci_10 / pop_epci_s_10) * 100;
				var part_p_6074_dep_10 = (p_6074_dep_10 / pop_dep_s_10) * 100;
				var part_p_6074_fac_10 = (p_6074_fac_10 / pop_fac_s_10) * 100;
				var part_p_6074_fra_10 = (p_6074_fra_10 / pop_fra_s_10) * 100;
				var part_p_6074_com_16 = (p_6074_com_16 / pop_com_s_16) * 100;
				var part_p_6074_epci_16 = (p_6074_epci_16 / pop_epci_s_16) * 100;
				var part_p_6074_dep_16 = (p_6074_dep_16 / pop_dep_s_16) * 100;
				var part_p_6074_fac_16 = (p_6074_fac_16 / pop_fac_s_16) * 100;
				var part_p_6074_fra_16 = (p_6074_fra_16 / pop_fra_s_16) * 100;
				
				////////////// 75 ans et plus
				
				var p_75P_com_99 = json_donnees_finales.features[indexcom_d].properties.P99_POP75P;
				var p_75P_epci_99 = epci_data.features[indexepci].properties.P99_POP75P;
				var p_75P_dep_99 = dep_data_t.features[indexdep].properties.P99_POP75P;
				var p_75P_fac_99 = facade_data_t.features[indexfac].properties.P99_POP75P;
				var p_75P_fra_99 = france_data_t.features[0].properties.P99_POP75P;
				var p_75P_com_10 = json_donnees_finales.features[indexcom_d].properties.P10_POP75P;
				var p_75P_epci_10 = epci_data.features[indexepci].properties.P10_POP75P;
				var p_75P_dep_10 = dep_data_t.features[indexdep].properties.P10_POP75P;
				var p_75P_fac_10 = facade_data_t.features[indexfac].properties.P10_POP75P;
				var p_75P_fra_10 = france_data_t.features[0].properties.P10_POP75P;
				var p_75P_com_16 = json_donnees_finales.features[indexcom_d].properties.P16_POP75P;
				var p_75P_epci_16 = epci_data.features[indexepci].properties.P16_POP75P;
				var p_75P_dep_16 = dep_data_t.features[indexdep].properties.P16_POP75P;
				var p_75P_fac_16 = facade_data_t.features[indexfac].properties.P16_POP75P;
				var p_75P_fra_16 = france_data_t.features[0].properties.P16_POP75P;
				
				var part_p_75P_com_99 = (p_75P_com_99 / pop_com_s_99) * 100;
				var part_p_75P_epci_99 = (p_75P_epci_99 / pop_epci_s_99) * 100;
				var part_p_75P_dep_99 = (p_75P_dep_99 / pop_dep_s_99) * 100;
				var part_p_75P_fac_99 = (p_75P_fac_99 / pop_fac_s_99) * 100;
				var part_p_75P_fra_99 = (p_75P_fra_99 / pop_fra_s_99) * 100;
				var part_p_75P_com_10 = (p_75P_com_10 / pop_com_s_10) * 100;
				var part_p_75P_epci_10 = (p_75P_epci_10 / pop_epci_s_10) * 100;
				var part_p_75P_dep_10 = (p_75P_dep_10 / pop_dep_s_10) * 100;
				var part_p_75P_fac_10 = (p_75P_fac_10 / pop_fac_s_10) * 100;
				var part_p_75P_fra_10 = (p_75P_fra_10 / pop_fra_s_10) * 100;
				var part_p_75P_com_16 = (p_75P_com_16 / pop_com_s_16) * 100;
				var part_p_75P_epci_16 = (p_75P_epci_16 / pop_epci_s_16) * 100;
				var part_p_75P_dep_16 = (p_75P_dep_16 / pop_dep_s_16) * 100;
				var part_p_75P_fac_16 = (p_75P_fac_16 / pop_fac_s_16) * 100;
				var part_p_75P_fra_16 = (p_75P_fra_16 / pop_fra_s_16) * 100;
	
				var anneechoisie = document.getElementById("selecteur4");
				var anneestruct = anneechoisie.options[anneechoisie.selectedIndex].value;
	
				switch (anneestruct) {
				
				case '1999' : 
					barChartData4.datasets[0].data = [part_moins_15_com_99.toFixed(2),part_moins_15_epci_99.toFixed(2),part_moins_15_dep_99.toFixed(2),part_moins_15_fac_99.toFixed(2),part_moins_15_fra_99.toFixed(2)];
					barChartData4.datasets[1].data = [part_p_1529_com_99.toFixed(2),part_p_1529_epci_99.toFixed(2),part_p_1529_dep_99.toFixed(2),part_p_1529_fac_99.toFixed(2),part_p_1529_fra_99.toFixed(2)];
					barChartData4.datasets[2].data = [part_p_3044_com_99.toFixed(2),part_p_3044_epci_99.toFixed(2),part_p_3044_dep_99.toFixed(2),part_p_3044_fac_99.toFixed(2),part_p_3044_fra_99.toFixed(2)];
					barChartData4.datasets[3].data = [part_p_4559_com_99.toFixed(2),part_p_4559_epci_99.toFixed(2),part_p_4559_dep_99.toFixed(2),part_p_4559_fac_99.toFixed(2),part_p_4559_fra_99.toFixed(2)];
					barChartData4.datasets[4].data = [part_p_6074_com_99.toFixed(2),part_p_6074_epci_99.toFixed(2),part_p_6074_dep_99.toFixed(2),part_p_6074_fac_99.toFixed(2),part_p_6074_fra_99.toFixed(2)];
					barChartData4.datasets[5].data = [part_p_75P_com_99.toFixed(2),part_p_75P_epci_99.toFixed(2),part_p_75P_dep_99.toFixed(2),part_p_75P_fac_99.toFixed(2),part_p_75P_fra_99.toFixed(2)];
				window.myBar4.options.title.text = 'Structure par âge de la population en 1999 (part en %)';
				break;
				
				case '2010' : 
					barChartData4.datasets[0].data = [part_moins_15_com_10.toFixed(2),part_moins_15_epci_10.toFixed(2),part_moins_15_dep_10.toFixed(2),part_moins_15_fac_10.toFixed(2),part_moins_15_fra_10.toFixed(2)];
					barChartData4.datasets[1].data = [part_p_1529_com_10.toFixed(2),part_p_1529_epci_10.toFixed(2),part_p_1529_dep_10.toFixed(2),part_p_1529_fac_10.toFixed(2),part_p_1529_fra_10.toFixed(2)];
					barChartData4.datasets[2].data = [part_p_3044_com_10.toFixed(2),part_p_3044_epci_10.toFixed(2),part_p_3044_dep_10.toFixed(2),part_p_3044_fac_10.toFixed(2),part_p_3044_fra_10.toFixed(2)];
					barChartData4.datasets[3].data = [part_p_4559_com_10.toFixed(2),part_p_4559_epci_10.toFixed(2),part_p_4559_dep_10.toFixed(2),part_p_4559_fac_10.toFixed(2),part_p_4559_fra_10.toFixed(2)];
					barChartData4.datasets[4].data = [part_p_6074_com_10.toFixed(2),part_p_6074_epci_10.toFixed(2),part_p_6074_dep_10.toFixed(2),part_p_6074_fac_10.toFixed(2),part_p_6074_fra_10.toFixed(2)];
					barChartData4.datasets[5].data = [part_p_75P_com_10.toFixed(2),part_p_75P_epci_10.toFixed(2),part_p_75P_dep_10.toFixed(2),part_p_75P_fac_10.toFixed(2),part_p_75P_fra_10.toFixed(2)];
				window.myBar4.options.title.text = 'Structure par âge de la population en 2010 (part en %)';
				break;
						
				case '2016' : 
				barChartData4.datasets[0].data = [part_moins_15_com_16.toFixed(2),part_moins_15_epci_16.toFixed(2),part_moins_15_dep_16.toFixed(2),part_moins_15_fac_16.toFixed(2),part_moins_15_fra_16.toFixed(2)];
					barChartData4.datasets[1].data = [part_p_1529_com_16.toFixed(2),part_p_1529_epci_16.toFixed(2),part_p_1529_dep_16.toFixed(2),part_p_1529_fac_16.toFixed(2),part_p_1529_fra_16.toFixed(2)];
					barChartData4.datasets[2].data = [part_p_3044_com_16.toFixed(2),part_p_3044_epci_16.toFixed(2),part_p_3044_dep_16.toFixed(2),part_p_3044_fac_16.toFixed(2),part_p_3044_fra_16.toFixed(2)];
					barChartData4.datasets[3].data = [part_p_4559_com_16.toFixed(2),part_p_4559_epci_16.toFixed(2),part_p_4559_dep_16.toFixed(2),part_p_4559_fac_16.toFixed(2),part_p_4559_fra_16.toFixed(2)];
					barChartData4.datasets[4].data = [part_p_6074_com_16.toFixed(2),part_p_6074_epci_16.toFixed(2),part_p_6074_dep_16.toFixed(2),part_p_6074_fac_16.toFixed(2),part_p_6074_fra_16.toFixed(2)];
					barChartData4.datasets[5].data = [part_p_75P_com_16.toFixed(2),part_p_75P_epci_16.toFixed(2),part_p_75P_dep_16.toFixed(2),part_p_75P_fac_16.toFixed(2),part_p_75P_fra_16.toFixed(2)];
				window.myBar4.options.title.text = 'Structure par âge de la population en 2016 (part en %)';
				break;
				
			}



				barChartData4.labels = [nomcom,['',epci],depart,['',facade],'France'];
				window.myBar4.update();
		
				//window.myBar4.options.title.text = 'Structure par âge de la population (part en %)';
				window.myBar4.update();

			break;
			
			
			
			
			
			
			
			case '3': // Part de l'emploi présentiel
			
				////////////// COMMUNE
			
				var nouvelleData = [json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_1999,json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_2009,json_donnees_finales.features[indexcom_d].properties.Prct_emploi_presentiel_2014]; 
			
				////////////// EPCI

				var emp_t_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_1999;
				var emp_r_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_2009;
				var emp_r_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_résidentiel_2014;
				var prt_em_epci99 = (emp_r_epci_99/emp_t_epci_99)*100;
				var prt_em_epci09 = (emp_r_epci_09/emp_t_epci_09)*100;
				var prt_em_epci14 = (emp_r_epci_14/emp_t_epci_14)*100;
				var epci_graphe = [prt_em_epci99.toFixed(2),prt_em_epci09.toFixed(2),prt_em_epci14.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var emp_t_depart_99 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_depart_09 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_depart_14 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_depart_99 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_1999;
				var emp_r_depart_09 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_2009;
				var emp_r_depart_14 = dep_data_t.features[indexdep].properties.Nb_emploi_résidentiel_2014;
				var prt_em_depart99 = (emp_r_depart_99/emp_t_depart_99)*100;
				var prt_em_depart09 = (emp_r_depart_09/emp_t_depart_09)*100;
				var prt_em_depart14 = (emp_r_depart_14/emp_t_depart_14)*100;
				var depart_data = [prt_em_depart99.toFixed(2),prt_em_depart09.toFixed(2),prt_em_depart14.toFixed(2)]; 
				
				////////////// FACADE LITTORALE 
				
				var emp_t_facade_99 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_facade_09 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_facade_14 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_facade_99 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_1999;
				var emp_r_facade_09 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_2009;
				var emp_r_facade_14 = facade_data_t.features[indexfac].properties.Nb_emploi_résidentiel_2014;
				var prt_em_facade99 = (emp_r_facade_99/emp_t_facade_99)*100;
				var prt_em_facade09 = (emp_r_facade_09/emp_t_facade_09)*100;
				var prt_em_facade14 = (emp_r_facade_14/emp_t_facade_14)*100;
				var facade_data = [prt_em_facade99.toFixed(2),prt_em_facade09.toFixed(2),prt_em_facade14.toFixed(2)]; 
				
				
				////////////// FRANCE
				
				var emp_t_fra_99 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fra_09 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fra_14 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2014;
				var emp_r_fra_99 = france_data_t.features[0].properties.Nb_emploi_résidentiel_1999;
				var emp_r_fra_09 = france_data_t.features[0].properties.Nb_emploi_résidentiel_2009;
				var emp_r_fra_14 = france_data_t.features[0].properties.Nb_emploi_résidentiel_2014;
				var prt_em_fra99 = (emp_r_fra_99/emp_t_fra_99)*100;
				var prt_em_fra09 = (emp_r_fra_09/emp_t_fra_09)*100;
				var prt_em_fra14 = (emp_r_fra_14/emp_t_fra_14)*100;
				var fra_data = [prt_em_fra99.toFixed(2),prt_em_fra09.toFixed(2),prt_em_fra14.toFixed(2)]; 
				
				barChartData4.datasets[0].data = nouvelleData;  
				barChartData4.datasets[1].data = epci_graphe;
				barChartData4.datasets[2].data = depart_data;
				barChartData4.datasets[3].data = facade_data;
				barChartData4.datasets[4].data = fra_data;
				barChartData4.labels = ['1999', '2009', '2014'];
				window.myBar4.update();
		
				window.myBar4.options.title.text = 'Part des emplois de la sphère résidentielle dans l\'emploi total (%)';
				barChartData4.datasets[0].label = nomcom;
				barChartData4.datasets[1].label = "Moyenne " + epci;
				barChartData4.datasets[2].label = "Moyenne " + depart;
				window.myBar4.update();
			
			
			break;
			
			
			
			
			
			
			
			case '4': // Nombre d'emplois au lieu de travail
				////////////// COMMUNE
			
				var pop_com99 = json_donnees_finales.features[indexcom_d].properties.Pop_1999;
				var pop_com10 = json_donnees_finales.features[indexcom_d].properties.Pop_2010;
				var pop_com15 = json_donnees_finales.features[indexcom_d].properties.Pop_2015;
				var emp_t_com_99 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_com_09 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_com_14 = json_donnees_finales.features[indexcom_d].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_com99 = (emp_t_com_99/pop_com99);
				var em_ph_com09 = (emp_t_com_09/pop_com10);
				var em_ph_com14 = (emp_t_com_14/pop_com15);
				var nouvelleData = [em_ph_com99.toFixed(2),em_ph_com09.toFixed(2),em_ph_com14.toFixed(2)]; 

				////////////// EPCI

				var pop_epci99 = epci_data.features[indexepci].properties.Pop_1999;
				var pop_epci10 = epci_data.features[indexepci].properties.Pop_2010;
				var pop_epci15 = epci_data.features[indexepci].properties.Pop_2015;
				var emp_t_epci_99 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_epci_09 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_epci_14 = epci_data.features[indexepci].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_epci99 = (emp_t_epci_99/pop_epci99);
				var em_ph_epci09 = (emp_t_epci_09/pop_epci10);
				var em_ph_epci14 = (emp_t_epci_14/pop_epci15);
				var epci_graphe = [em_ph_epci99.toFixed(2),em_ph_epci09.toFixed(2),em_ph_epci14.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var pop_dep99 = dep_data_t.features[indexdep].properties.Pop_1999;
				var pop_dep10 = dep_data_t.features[indexdep].properties.Pop_2010;
				var pop_dep15 = dep_data_t.features[indexdep].properties.Pop_2015;
				var emp_t_dep_99 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_dep_09 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_dep_14 = dep_data_t.features[indexdep].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_dep99 = (emp_t_dep_99/pop_dep99);
				var em_ph_dep09 = (emp_t_dep_09/pop_dep10);
				var em_ph_dep14 = (emp_t_dep_14/pop_dep15);
				var depart_data = [em_ph_dep99.toFixed(2),em_ph_dep09.toFixed(2),em_ph_dep14.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var pop_fac99 = facade_data_t.features[indexfac].properties.Pop_1999;
				var pop_fac10 = facade_data_t.features[indexfac].properties.Pop_2010;
				var pop_fac15 = facade_data_t.features[indexfac].properties.Pop_2015;
				var emp_t_fac_99 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fac_09 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fac_14 = facade_data_t.features[indexfac].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_fac99 = (emp_t_fac_99/pop_fac99);
				var em_ph_fac09 = (emp_t_fac_09/pop_fac10);
				var em_ph_fac14 = (emp_t_fac_14/pop_fac15);
				var facade_data = [em_ph_fac99.toFixed(2),em_ph_fac09.toFixed(2),em_ph_fac14.toFixed(2)];
				
				
				////////////// FRANCE
				
				var pop_fra99 = france_data_t.features[0].properties.Pop_1999;
				var pop_fra10 = france_data_t.features[0].properties.Pop_2010;
				var pop_fra15 = france_data_t.features[0].properties.Pop_2015;
				var emp_t_fra_99 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_1999;
				var emp_t_fra_09 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2009;
				var emp_t_fra_14 = france_data_t.features[0].properties.Nb_emploi_lieu_de_travail_2014;
				var em_ph_fra99 = (emp_t_fra_99/pop_fra99);
				var em_ph_fra09 = (emp_t_fra_09/pop_fra10);
				var em_ph_fra14 = (emp_t_fra_14/pop_fra15);
				var fra_data = [em_ph_fra99.toFixed(2),em_ph_fra09.toFixed(2),em_ph_fra14.toFixed(2)];
				
				barChartData4.datasets[0].data = nouvelleData; 
				barChartData4.datasets[1].data = epci_graphe;
				barChartData4.datasets[2].data = depart_data;
				barChartData4.datasets[3].data = facade_data;
				barChartData4.datasets[4].data = fra_data;
				barChartData4.labels = ['1999', '2009', '2014'];
				window.myBar4.update();
		
				window.myBar4.options.title.text = 'Nombre d\'emplois au lieu de travail (emplois/hab)';
				barChartData4.datasets[0].label = nomcom;
				barChartData4.datasets[1].label = "Moyenne " + epci;
				barChartData4.datasets[2].label = "Moyenne " + depart;
				window.myBar4.update();
						
			
			
			break;
			
			
			
			
			
			
			
			case '5': // Artificialisation
				
				////////////// COMMUNE
			
				var artif_com00 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2000;
				var artif_com06 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2006;
				var artif_com12 = json_donnees_finales.features[indexcom_d].properties.SURF_ARTIF_2012;
				var surf_com = json_donnees_finales.features[indexcom_d].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_com00 = (artif_com00/surf_com)*100;
				var prct_artif_com06 = (artif_com06/surf_com)*100;
				var prct_artif_com12 = (artif_com12/surf_com)*100;
				var nouvelleData = [prct_artif_com00.toFixed(2),prct_artif_com06.toFixed(2),prct_artif_com12.toFixed(2)]; 

				////////////// EPCI

				var artif_epci00 = epci_data.features[indexepci].properties.SURF_ARTIF_2000;
				var artif_epci06 = epci_data.features[indexepci].properties.SURF_ARTIF_2006;
				var artif_epci12 = epci_data.features[indexepci].properties.SURF_ARTIF_2012;
				var surf_epci = epci_data.features[indexepci].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_epci00 = (artif_epci00/surf_epci)*100;
				var prct_artif_epci06 = (artif_epci06/surf_epci)*100;
				var prct_artif_epci12 = (artif_epci12/surf_epci)*100;
				var epci_graphe = [prct_artif_epci00.toFixed(2),prct_artif_epci06.toFixed(2),prct_artif_epci12.toFixed(2)]; // Valeur d'évolution de la population de la commune

				
				////////////// DEPARTEMENT
				
				var artif_dep00 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2000;
				var artif_dep06 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2006;
				var artif_dep12 = dep_data_t.features[indexdep].properties.SURF_ARTIF_2012;
				var surf_dep = dep_data_t.features[indexdep].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_dep00 = (artif_dep00/surf_dep)*100;
				var prct_artif_dep06 = (artif_dep06/surf_dep)*100;
				var prct_artif_dep12 = (artif_dep12/surf_dep)*100;
				var depart_data = [prct_artif_dep00.toFixed(2),prct_artif_dep06.toFixed(2),prct_artif_dep12.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var artif_fac00 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2000;
				var artif_fac06 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2006;
				var artif_fac12 = facade_data_t.features[indexfac].properties.SURF_ARTIF_2012;
				var surf_fac = facade_data_t.features[indexfac].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_fac00 = (artif_fac00/surf_fac)*100;
				var prct_artif_fac06 = (artif_fac06/surf_fac)*100;
				var prct_artif_fac12 = (artif_fac12/surf_fac)*100;
				var facade_data = [prct_artif_fac00.toFixed(2),prct_artif_fac06.toFixed(2),prct_artif_fac12.toFixed(2)];
				
				
				////////////// FRANCE
				
				var artif_fra00 = france_data_t.features[0].properties.SURF_ARTIF_2000;
				var artif_fra06 = france_data_t.features[0].properties.SURF_ARTIF_2006;
				var artif_fra12 = france_data_t.features[0].properties.SURF_ARTIF_2012;
				var surf_fra = france_data_t.features[0].properties.SUR_TOTALE_COMMUNE;
				var prct_artif_fra00 = (artif_fra00/surf_fra)*100;
				var prct_artif_fra06 = (artif_fra06/surf_fra)*100;
				var prct_artif_fra12 = (artif_fra12/surf_fra)*100;
				var fra_data = [prct_artif_fra00.toFixed(2),prct_artif_fra06.toFixed(2),prct_artif_fra12.toFixed(2)];
				
				barChartData4.datasets[0].data = nouvelleData; 
				barChartData4.datasets[1].data = epci_graphe;
				barChartData4.datasets[2].data = depart_data;
				barChartData4.datasets[3].data = facade_data;
				barChartData4.datasets[4].data = fra_data;
				barChartData4.labels = ['2000', '2006', '2012'];
				window.myBar4.update();
		
				window.myBar4.options.title.text = 'Part des espaces artificialisés sur le territoire communal (%)';
				barChartData4.datasets[0].label = nomcom;
				barChartData4.datasets[1].label = "Moyenne " + epci;
				barChartData4.datasets[2].label = "Moyenne " + depart;
				window.myBar4.update();
			
			break;
			
			
			
			
			
			
			
			case '6': // Part des résidences secondaires
			
				////////////// COMMUNE
			
				var nb_log_com99 = sec_com.features[indexcom_r].properties.NB_LOG_1999;
				var nb_log_com11 = sec_com.features[indexcom_r].properties.NB_LOG_2011;
				var nb_log_com16 = sec_com.features[indexcom_r].properties.NB_LOG_2016;
				var nb_sec_com99 = sec_com.features[indexcom_r].properties.NB_SEC_1999;
				var nb_sec_com11 = sec_com.features[indexcom_r].properties.NB_SEC_2011;
				var nb_sec_com16 = sec_com.features[indexcom_r].properties.NB_SEC_2016;	
				var prct_sec_com_99 = (nb_sec_com99 / nb_log_com99 ) * 100;
				var prct_sec_com_11 = (nb_sec_com11 / nb_log_com11 ) * 100;
				var prct_sec_com_16 = (nb_sec_com16 / nb_log_com16 ) * 100;
				var nouvelleData = [prct_sec_com_99.toFixed(2),prct_sec_com_11.toFixed(2),prct_sec_com_16.toFixed(2)];

				////////////// EPCI

				var nb_log_epci99 = sec_epci.features[indexepci_r].properties.NB_LOG_1999;
				var nb_log_epci11 = sec_epci.features[indexepci_r].properties.NB_LOG_2011;
				var nb_log_epci16 = sec_epci.features[indexepci_r].properties.NB_LOG_2016;
				var nb_sec_epci99 = sec_epci.features[indexepci_r].properties.NB_SEC_1999;
				var nb_sec_epci11 = sec_epci.features[indexepci_r].properties.NB_SEC_2011;
				var nb_sec_epci16 = sec_epci.features[indexepci_r].properties.NB_SEC_2016;	
				var prct_sec_epci_99 = (nb_sec_epci99 / nb_log_epci99 ) * 100;
				var prct_sec_epci_11 = (nb_sec_epci11 / nb_log_epci11 ) * 100;
				var prct_sec_epci_16 = (nb_sec_epci16 / nb_log_epci16 ) * 100;
				var epci_graphe = [prct_sec_epci_99.toFixed(2),prct_sec_epci_11.toFixed(2),prct_sec_epci_16.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var nb_log_dep99 = sec_dep.features[indexdep_r].properties.NB_LOG_1999;
				var nb_log_dep11 = sec_dep.features[indexdep_r].properties.NB_LOG_2011;
				var nb_log_dep16 = sec_dep.features[indexdep_r].properties.NB_LOG_2016;
				var nb_sec_dep99 = sec_dep.features[indexdep_r].properties.NB_SEC_1999;
				var nb_sec_dep11 = sec_dep.features[indexdep_r].properties.NB_SEC_2011;
				var nb_sec_dep16 = sec_dep.features[indexdep_r].properties.NB_SEC_2016;	
				var prct_sec_dep_99 = (nb_sec_dep99 / nb_log_dep99 ) * 100;
				var prct_sec_dep_11 = (nb_sec_dep11 / nb_log_dep11 ) * 100;
				var prct_sec_dep_16 = (nb_sec_dep16 / nb_log_dep16 ) * 100;
				var depart_data = [prct_sec_dep_99.toFixed(2),prct_sec_dep_11.toFixed(2),prct_sec_dep_16.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var nb_log_fac99 = sec_fac.features[indexfac_r].properties.NB_LOG_1999;
				var nb_log_fac11 = sec_fac.features[indexfac_r].properties.NB_LOG_2011;
				var nb_log_fac16 = sec_fac.features[indexfac_r].properties.NB_LOG_2016;
				var nb_sec_fac99 = sec_fac.features[indexfac_r].properties.NB_SEC_1999;
				var nb_sec_fac11 = sec_fac.features[indexfac_r].properties.NB_SEC_2011;
				var nb_sec_fac16 = sec_fac.features[indexfac_r].properties.NB_SEC_2016;	
				var prct_sec_fac_99 = (nb_sec_fac99 / nb_log_fac99 ) * 100;
				var prct_sec_fac_11 = (nb_sec_fac11 / nb_log_fac11 ) * 100;
				var prct_sec_fac_16 = (nb_sec_fac16 / nb_log_fac16 ) * 100;
				var facade_data = [prct_sec_fac_99.toFixed(2),prct_sec_fac_11.toFixed(2),prct_sec_fac_16.toFixed(2)];
				
				
				////////////// FRANCE
				
				var nb_log_fra99 = sec_fra.features[0].properties.NB_LOG_1999;
				var nb_log_fra11 = sec_fra.features[0].properties.NB_LOG_2011;
				var nb_log_fra16 = sec_fra.features[0].properties.NB_LOG_2016;
				var nb_sec_fra99 = sec_fra.features[0].properties.NB_SEC_1999;
				var nb_sec_fra11 = sec_fra.features[0].properties.NB_SEC_2011;
				var nb_sec_fra16 = sec_fra.features[0].properties.NB_SEC_2016;	
				var prct_sec_fra_99 = (nb_sec_fra99 / nb_log_fra99 ) * 100;
				var prct_sec_fra_11 = (nb_sec_fra11 / nb_log_fra11 ) * 100;
				var prct_sec_fra_16 = (nb_sec_fra16 / nb_log_fra16 ) * 100;
				var fra_data = [prct_sec_fra_99.toFixed(2),prct_sec_fra_11.toFixed(2),prct_sec_fra_16.toFixed(2)];
				
				barChartData4.datasets[0].data = nouvelleData; 
				barChartData4.datasets[1].data = epci_graphe;
				barChartData4.datasets[2].data = depart_data;
				barChartData4.datasets[3].data = facade_data;
				barChartData4.datasets[4].data = fra_data;
				barChartData4.labels = ['1999', '2011', '2016'];
				window.myBar4.update();
		
				window.myBar4.options.title.text = 'Part des résidences secondaires dans le total des logements (%)';
				barChartData4.datasets[0].label = nomcom;
				barChartData4.datasets[1].label = "Moyenne " + epci;
				barChartData4.datasets[2].label = "Moyenne " + depart;
				window.myBar4.update();
						
			
			
			break;
			
			
			
			
			
			
			
			
			case '7': // Composition parc de logements
			
					while (barChartData4.datasets.length > 0 ){
						barChartData4.datasets.pop(); 
					}
			
			
				barChartData4.datasets.push({label : ' Maison avant 1991 ', backgroundColor: window.chartColors.green, stack : 'Stack 1', data : [1,1,1,2,1]});
				barChartData4.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.orange, stack : 'Stack 1', data : [3,1,2,2,1]});
				barChartData4.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.blue, stack : 'Stack 1', data : [3,1,2,3,1]});
				barChartData4.datasets.push({label : ' Appartement avant 1991 ', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData4.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.grey, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData4.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,1,1]});
				barChartData4.datasets.push({label : ' Autre avant 1991 ', backgroundColor: window.chartColors.yellow, stack : 'Stack 1', data : [3,1,2,4,3]});
				barChartData4.datasets.push({label : ' 1991 - 2005 ', backgroundColor: window.chartColors.grey, stack : 'Stack 1', data : [3,1,2,2,3]});
				barChartData4.datasets.push({label : ' 2006 - 2013 ', backgroundColor: window.chartColors.purple, stack : 'Stack 1', data : [3,1,2,2,2]});


				////////////// Maison avant 1991

				var m_av_91_com = json_donnees_finales.features[indexcom_d].properties.MAISON_AVT91;
				var m_av_91_epci = epci_data.features[indexepci].properties.MAISON_AVT91;
				var m_av_91_dep = dep_data_t.features[indexdep].properties.MAISON_AVT91;
				var m_av_91_fac = facade_data_t.features[indexfac].properties.MAISON_AVT91;
				var m_av_91_fra = france_data_t.features[0].properties.MAISON_AVT91;


				////////////// Maison 1991 - 2005

				var m_9105_com = json_donnees_finales.features[indexcom_d].properties.MAISON_9105;
				var m_9105_epci = epci_data.features[indexepci].properties.MAISON_9105;
				var m_9105_dep = dep_data_t.features[indexdep].properties.MAISON_9105;
				var m_9105_fac = facade_data_t.features[indexfac].properties.MAISON_9105;
				var m_9105_fra = france_data_t.features[0].properties.MAISON_9105;

				////////////// Maison 2006 - 2013
	
				var m_0613_com = json_donnees_finales.features[indexcom_d].properties.MAISON_0613;
				var m_0613_epci = epci_data.features[indexepci].properties.MAISON_0613;
				var m_0613_dep = dep_data_t.features[indexdep].properties.MAISON_0613;
				var m_0613_fac = facade_data_t.features[indexfac].properties.MAISON_0613;
				var m_0613_fra = france_data_t.features[0].properties.MAISON_0613;
				
				////////////// Appartement avant 1991

				var ap_av_91_com = json_donnees_finales.features[indexcom_d].properties.APPART_AVT91;
				var ap_av_91_epci = epci_data.features[indexepci].properties.APPART_AVT91;
				var ap_av_91_dep = dep_data_t.features[indexdep].properties.APPART_AVT91;
				var ap_av_91_fac = facade_data_t.features[indexfac].properties.APPART_AVT91;
				var ap_av_91_fra = france_data_t.features[0].properties.APPART_AVT91;

				////////////// Appartement 1991 - 2005

				var ap_9105_com = json_donnees_finales.features[indexcom_d].properties.APPART_9105;
				var ap_9105_epci = epci_data.features[indexepci].properties.APPART_9105;
				var ap_9105_dep = dep_data_t.features[indexdep].properties.APPART_9105;
				var ap_9105_fac = facade_data_t.features[indexfac].properties.APPART_9105;
				var ap_9105_fra = france_data_t.features[0].properties.APPART_9105;


				////////////// Appartement 2006 - 2013
				
				var ap_0613_com = json_donnees_finales.features[indexcom_d].properties.APPART_0613;
				var ap_0613_epci = epci_data.features[indexepci].properties.APPART_0613;
				var ap_0613_dep = dep_data_t.features[indexdep].properties.APPART_0613;
				var ap_0613_fac = facade_data_t.features[indexfac].properties.APPART_0613;
				var ap_0613_fra = france_data_t.features[0].properties.APPART_0613;		
				
				
				////////////// Autre avant 1991
				
				var au_av_91_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_AVT91;
				var au_av_91_epci = epci_data.features[indexepci].properties.AUTRE_AVT91;
				var au_av_91_dep = dep_data_t.features[indexdep].properties.AUTRE_AVT91;
				var au_av_91_fac = facade_data_t.features[indexfac].properties.AUTRE_AVT91;
				var au_av_91_fra = france_data_t.features[0].properties.AUTRE_AVT91;
				
				
				////////////// Autre 1991 - 2005

				var au_9105_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_9105;
				var au_9105_epci = epci_data.features[indexepci].properties.AUTRE_9105;
				var au_9105_dep = dep_data_t.features[indexdep].properties.AUTRE_9105;
				var au_9105_fac = facade_data_t.features[indexfac].properties.AUTRE_9105;
				var au_9105_fra = france_data_t.features[0].properties.AUTRE_9105;


				////////////// Autre 2006 - 2013		

				var au_0613_com = json_donnees_finales.features[indexcom_d].properties.AUTRE_0613;
				var au_0613_epci = epci_data.features[indexepci].properties.AUTRE_0613;
				var au_0613_dep = dep_data_t.features[indexdep].properties.AUTRE_0613;
				var au_0613_fac = facade_data_t.features[indexfac].properties.AUTRE_0613;
				var au_0613_fra = france_data_t.features[0].properties.AUTRE_0613;

				///////////// Nombre de logements 
				
				var nb_log_com = m_av_91_com + m_9105_com + m_0613_com + ap_av_91_com + ap_9105_com + ap_0613_com, au_av_91_com, au_9105_com, au_0613_com;
				var nb_log_epci = m_av_91_epci + m_9105_epci + m_0613_epci + ap_av_91_epci + ap_9105_epci + ap_0613_epci, au_av_91_epci, au_9105_epci, au_0613_epci;
				var nb_log_dep = m_av_91_dep + m_9105_dep + m_0613_dep + ap_av_91_dep + ap_9105_dep + ap_0613_dep, au_av_91_dep, au_9105_dep, au_0613_dep;
				var nb_log_fac = m_av_91_fac + m_9105_fac + m_0613_fac + ap_av_91_fac + ap_9105_fac + ap_0613_fac, au_av_91_fac, au_9105_fac, au_0613_fac;
				var nb_log_fra = m_av_91_fra + m_9105_fra + m_0613_fra + ap_av_91_fra + ap_9105_fra + ap_0613_fra, au_av_91_fra, au_9105_fra, au_0613_fra;

				//////////// Pourcentages maison avant 91 
				
				var p_m_av_91_com = (m_av_91_com / nb_log_com) * 100;
				var p_m_av_91_epci = (m_av_91_epci / nb_log_epci) * 100;
				var p_m_av_91_dep = (m_av_91_dep / nb_log_dep) * 100;
				var p_m_av_91_fac = (m_av_91_fac / nb_log_fac) * 100;
				var p_m_av_91_fra = (m_av_91_fra / nb_log_fra) * 100;
				
				barChartData4.datasets[0].data = [p_m_av_91_com.toFixed(2),p_m_av_91_epci.toFixed(2),p_m_av_91_dep.toFixed(2),p_m_av_91_fac.toFixed(2),p_m_av_91_fra.toFixed(2)];

				//////////// Pourcentages maison 1991 - 2005 
				
				var p_m_9105_com = (m_9105_com / nb_log_com) * 100;
				var p_m_9105_epci = (m_9105_epci / nb_log_epci) * 100;
				var p_m_9105_dep = (m_9105_dep / nb_log_dep) * 100;
				var p_m_9105_fac = (m_9105_fac / nb_log_fac) * 100;
				var p_m_9105_fra = (m_9105_fra / nb_log_fra) * 100;
				
				barChartData4.datasets[1].data = [p_m_9105_com.toFixed(2),p_m_9105_epci.toFixed(2),p_m_9105_dep.toFixed(2),p_m_9105_fac.toFixed(2),p_m_9105_fra.toFixed(2)];

				//////////// Pourcentages maison 2006 - 2013
				
				var p_m_0613_com = (m_0613_com / nb_log_com) * 100;
				var p_m_0613_epci = (m_0613_epci / nb_log_epci) * 100;
				var p_m_0613_dep = (m_0613_dep / nb_log_dep) * 100;
				var p_m_0613_fac = (m_0613_fac / nb_log_fac) * 100;
				var p_m_0613_fra = (m_0613_fra / nb_log_fra) * 100;
				
				barChartData4.datasets[2].data = [p_m_0613_com.toFixed(2),p_m_0613_epci.toFixed(2),p_m_0613_dep.toFixed(2),p_m_0613_fac.toFixed(2),p_m_0613_fra.toFixed(2)];

				//////////// Pourcentages appartement avant 1991

				var p_ap_av_91_com = (ap_av_91_com / nb_log_com) * 100;
				var p_ap_av_91_epci = (ap_av_91_epci / nb_log_epci) * 100;
				var p_ap_av_91_dep = (ap_av_91_dep / nb_log_dep) * 100;
				var p_ap_av_91_fac = (ap_av_91_fac / nb_log_fac) * 100;
				var p_ap_av_91_fra = (ap_av_91_fra / nb_log_fra) * 100;
				
				barChartData4.datasets[3].data = [p_ap_av_91_com.toFixed(2),p_ap_av_91_epci.toFixed(2),p_ap_av_91_dep.toFixed(2),p_ap_av_91_fac.toFixed(2),p_ap_av_91_fra.toFixed(2)];

				//////////// Pourcentages appartement 1991 - 2005 
				
				var p_ap_9105_com = (ap_9105_com / nb_log_com) * 100;
				var p_ap_9105_epci = (ap_9105_epci / nb_log_epci) * 100;
				var p_ap_9105_dep = (ap_9105_dep / nb_log_dep) * 100;
				var p_ap_9105_fac = (ap_9105_fac / nb_log_fac) * 100;
				var p_ap_9105_fra = (ap_9105_fra / nb_log_fra) * 100;
				
				barChartData4.datasets[4].data = [p_ap_9105_com.toFixed(2),p_ap_9105_epci.toFixed(2),p_ap_9105_dep.toFixed(2),p_ap_9105_fac.toFixed(2),p_ap_9105_fra.toFixed(2)];

				//////////// Pourcentages appartement 2006 - 2013
				
				var p_ap_0613_com = (ap_0613_com / nb_log_com) * 100;
				var p_ap_0613_epci = (ap_0613_epci / nb_log_epci) * 100;
				var p_ap_0613_dep = (ap_0613_dep / nb_log_dep) * 100;
				var p_ap_0613_fac = (ap_0613_fac / nb_log_fac) * 100;
				var p_ap_0613_fra = (ap_0613_fra / nb_log_fra) * 100;
				
				barChartData4.datasets[5].data = [p_ap_0613_com.toFixed(2),p_ap_0613_epci.toFixed(2),p_ap_0613_dep.toFixed(2),p_ap_0613_fac.toFixed(2),p_ap_0613_fra.toFixed(2)];

				//////////// Pourcentages autres avant 91 
				
				var p_au_av_91_com = (au_av_91_com / nb_log_com) * 100;
				var p_au_av_91_epci = (au_av_91_epci / nb_log_epci) * 100;
				var p_au_av_91_dep = (au_av_91_dep / nb_log_dep) * 100;
				var p_au_av_91_fac = (au_av_91_fac / nb_log_fac) * 100;
				var p_au_av_91_fra = (au_av_91_fra / nb_log_fra) * 100;
				
				barChartData4.datasets[6].data = [p_au_av_91_com.toFixed(2),p_au_av_91_epci.toFixed(2),p_au_av_91_dep.toFixed(2),p_au_av_91_fac.toFixed(2),p_au_av_91_fra.toFixed(2)];

				//////////// Pourcentages autres 1991 - 2005 
				
				var p_au_9105_com = (au_9105_com / nb_log_com) * 100;
				var p_au_9105_epci = (au_9105_epci / nb_log_epci) * 100;
				var p_au_9105_dep = (au_9105_dep / nb_log_dep) * 100;
				var p_au_9105_fac = (au_9105_fac / nb_log_fac) * 100;
				var p_au_9105_fra = (au_9105_fra / nb_log_fra) * 100;
				
				barChartData4.datasets[7].data = [p_au_9105_com.toFixed(2),p_au_9105_epci.toFixed(2),p_au_9105_dep.toFixed(2),p_au_9105_fac.toFixed(2),p_au_9105_fra.toFixed(2)];

				//////////// Pourcentages autres 2006 - 2013
				
				var p_au_0613_com = (au_0613_com / nb_log_com) * 100;
				var p_au_0613_epci = (au_0613_epci / nb_log_epci) * 100;
				var p_au_0613_dep = (au_0613_dep / nb_log_dep) * 100;
				var p_au_0613_fac = (au_0613_fac / nb_log_fac) * 100;
				var p_au_0613_fra = (au_0613_fra / nb_log_fra) * 100;
				
				barChartData4.datasets[8].data = [p_au_0613_com.toFixed(2),p_au_0613_epci.toFixed(2),p_au_0613_dep.toFixed(2),p_au_0613_fac.toFixed(2),p_au_0613_fra.toFixed(2)];

				barChartData4.datasets[0].backgroundColor = "#21618c";
				barChartData4.datasets[1].backgroundColor = "#3498db";
				barChartData4.datasets[2].backgroundColor = "#85c1e9";
				
				barChartData4.datasets[3].backgroundColor = "#e74c3c";
				barChartData4.datasets[4].backgroundColor = "#ec7063";
				barChartData4.datasets[5].backgroundColor = "#f5b7b1";
				
				barChartData4.datasets[6].backgroundColor = "#186a3b";
				barChartData4.datasets[7].backgroundColor = "#2ecc71";
				barChartData4.datasets[8].backgroundColor = "#82e0aa";

				barChartData4.labels = [nomcom, ['',epci], depart, ['',facade], 'France'];
				window.myBar4.update();
		
				window.myBar4.options.title.text = 'Composition du parc de logements en 2016 (parts en %)';
				window.myBar4.update();
						
						
			
			break;
			
			
			
			
			
			
			
			case '8': // Part des impôts ménages
			
				////////////// COMMUNE
			
				var fnb_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_0203);
				var fb_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.FB_0203);
				var th_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.TH_0203);
				var tp_com_02 = Number(json_donnees_finales.features[indexcom_d].properties.TP_0203);
				
				var fnb_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_0910);
				var fb_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.FB_0910);
				var th_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.TH_0910);
				var tp_com_09 = Number(json_donnees_finales.features[indexcom_d].properties.TP_0910);
				
				var fnb_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_1112);
				var fb_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.FB_1112);
				var th_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.TH_1112);
				var cfe_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.CFE_1112);
				var cvae_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.CVAE_1112);
				var ifer_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.IFER_1112);
				var tscom_com_11 = Number(json_donnees_finales.features[indexcom_d].properties.TSCOM_1112);
				
				var fnb_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.FNB_1516);
				var fb_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.FB_1516);
				var th_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.TH_1516);
				var cfe_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.CFE_1516);
				var cvae_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.CVAE_1516);
				var ifer_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.IFER_1516);
				var tscom_com_15 = Number(json_donnees_finales.features[indexcom_d].properties.TSCOM_1516);
				
				var part_m_com_02 = ((th_com_02 + fb_com_02)/(th_com_02 + fb_com_02 + fnb_com_02 + tp_com_02)) * 100
				var part_m_com_09 = ((th_com_09 + fb_com_09)/(th_com_09 + fb_com_09 + fnb_com_09 + tp_com_09)) * 100				
				var part_m_com_11 = ((th_com_11 + fb_com_11)/(th_com_11 + fb_com_11 + fnb_com_11 + cfe_com_11 + cvae_com_11 + ifer_com_11 + tscom_com_11)) * 100
				var part_m_com_15 = ((th_com_15 + fb_com_15)/(th_com_15 + fb_com_15 + fnb_com_15 + cfe_com_15 + cvae_com_15 + ifer_com_15 + tscom_com_15)) * 100				

				var nouvelleData = [part_m_com_02.toFixed(2),part_m_com_09.toFixed(2),part_m_com_11.toFixed(2),part_m_com_15.toFixed(2)]; 

				////////////// EPCI

				var fnb_epci_02 = Number(epci_data.features[indexepci].properties.FNB_0203);
				var fb_epci_02 = Number(epci_data.features[indexepci].properties.FB_0203);
				var th_epci_02 = Number(epci_data.features[indexepci].properties.TH_0203);
				var tp_epci_02 = Number(epci_data.features[indexepci].properties.TP_0203);
				
				var fnb_epci_09 = Number(epci_data.features[indexepci].properties.FNB_0910);
				var fb_epci_09 = Number(epci_data.features[indexepci].properties.FB_0910);
				var th_epci_09 = Number(epci_data.features[indexepci].properties.TH_0910);
				var tp_epci_09 = Number(epci_data.features[indexepci].properties.TP_0910);
				
				var fnb_epci_11 = Number(epci_data.features[indexepci].properties.FNB_1112);
				var fb_epci_11 = Number(epci_data.features[indexepci].properties.FB_1112);
				var th_epci_11 = Number(epci_data.features[indexepci].properties.TH_1112);
				var cfe_epci_11 = Number(epci_data.features[indexepci].properties.CFE_1112);
				var cvae_epci_11 = Number(epci_data.features[indexepci].properties.CVAE_1112);
				var ifer_epci_11 = Number(epci_data.features[indexepci].properties.IFER_1112);
				var tsepci_epci_11 = Number(epci_data.features[indexepci].properties.TSCOM_1112);
				
				var fnb_epci_15 = Number(epci_data.features[indexepci].properties.FNB_1516);
				var fb_epci_15 = Number(epci_data.features[indexepci].properties.FB_1516);
				var th_epci_15 = Number(epci_data.features[indexepci].properties.TH_1516);
				var cfe_epci_15 = Number(epci_data.features[indexepci].properties.CFE_1516);
				var cvae_epci_15 = Number(epci_data.features[indexepci].properties.CVAE_1516);
				var ifer_epci_15 = Number(epci_data.features[indexepci].properties.IFER_1516);
				var tsepci_epci_15 = Number(epci_data.features[indexepci].properties.TSCOM_1516);
				
				var part_m_epci_02 = ((th_epci_02 + fb_epci_02)/(th_epci_02 + fb_epci_02 + fnb_epci_02 + tp_epci_02)) * 100
				var part_m_epci_09 = ((th_epci_09 + fb_epci_09)/(th_epci_09 + fb_epci_09 + fnb_epci_09 + tp_epci_09)) * 100				
				var part_m_epci_11 = ((th_epci_11 + fb_epci_11)/(th_epci_11 + fb_epci_11 + fnb_epci_11 + cfe_epci_11 + cvae_epci_11 + ifer_epci_11 + tsepci_epci_11)) * 100
				var part_m_epci_15 = ((th_epci_15 + fb_epci_15)/(th_epci_15 + fb_epci_15 + fnb_epci_15 + cfe_epci_15 + cvae_epci_15 + ifer_epci_15 + tsepci_epci_15)) * 100				

				var epci_graphe = [part_m_epci_02.toFixed(2),part_m_epci_09.toFixed(2),part_m_epci_11.toFixed(2),part_m_epci_15.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var fnb_dep_02 = Number(dep_data_t.features[indexdep].properties.FNB_0203);
				var fb_dep_02 = Number(dep_data_t.features[indexdep].properties.FB_0203);
				var th_dep_02 = Number(dep_data_t.features[indexdep].properties.TH_0203);
				var tp_dep_02 = Number(dep_data_t.features[indexdep].properties.TP_0203);
				
				var fnb_dep_09 = Number(dep_data_t.features[indexdep].properties.FNB_0910);
				var fb_dep_09 = Number(dep_data_t.features[indexdep].properties.FB_0910);
				var th_dep_09 = Number(dep_data_t.features[indexdep].properties.TH_0910);
				var tp_dep_09 = Number(dep_data_t.features[indexdep].properties.TP_0910);
				
				var fnb_dep_11 = Number(dep_data_t.features[indexdep].properties.FNB_1112);
				var fb_dep_11 = Number(dep_data_t.features[indexdep].properties.FB_1112);
				var th_dep_11 = Number(dep_data_t.features[indexdep].properties.TH_1112);
				var cfe_dep_11 = Number(dep_data_t.features[indexdep].properties.CFE_1112);
				var cvae_dep_11 = Number(dep_data_t.features[indexdep].properties.CVAE_1112);
				var ifer_dep_11 = Number(dep_data_t.features[indexdep].properties.IFER_1112);
				var tsdep_dep_11 = Number(dep_data_t.features[indexdep].properties.TSCOM_1112);
				
				var fnb_dep_15 = Number(dep_data_t.features[indexdep].properties.FNB_1516);
				var fb_dep_15 = Number(dep_data_t.features[indexdep].properties.FB_1516);
				var th_dep_15 = Number(dep_data_t.features[indexdep].properties.TH_1516);
				var cfe_dep_15 = Number(dep_data_t.features[indexdep].properties.CFE_1516);
				var cvae_dep_15 = Number(dep_data_t.features[indexdep].properties.CVAE_1516);
				var ifer_dep_15 = Number(dep_data_t.features[indexdep].properties.IFER_1516);
				var tsdep_dep_15 = Number(dep_data_t.features[indexdep].properties.TSCOM_1516);
				
				var part_m_dep_02 = ((th_dep_02 + fb_dep_02)/(th_dep_02 + fb_dep_02 + fnb_dep_02 + tp_dep_02)) * 100
				var part_m_dep_09 = ((th_dep_09 + fb_dep_09)/(th_dep_09 + fb_dep_09 + fnb_dep_09 + tp_dep_09)) * 100				
				var part_m_dep_11 = ((th_dep_11 + fb_dep_11)/(th_dep_11 + fb_dep_11 + fnb_dep_11 + cfe_dep_11 + cvae_dep_11 + ifer_dep_11 + tsdep_dep_11)) * 100
				var part_m_dep_15 = ((th_dep_15 + fb_dep_15)/(th_dep_15 + fb_dep_15 + fnb_dep_15 + cfe_dep_15 + cvae_dep_15 + ifer_dep_15 + tsdep_dep_15)) * 100				

				var depart_data = [part_m_dep_02.toFixed(2),part_m_dep_09.toFixed(2),part_m_dep_11.toFixed(2),part_m_dep_15.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var fnb_facade_02 = Number(facade_data_t.features[indexfac].properties.FNB_0203);
				var fb_facade_02 = Number(facade_data_t.features[indexfac].properties.FB_0203);
				var th_facade_02 = Number(facade_data_t.features[indexfac].properties.TH_0203);
				var tp_facade_02 = Number(facade_data_t.features[indexfac].properties.TP_0203);
				
				var fnb_facade_09 = Number(facade_data_t.features[indexfac].properties.FNB_0910);
				var fb_facade_09 = Number(facade_data_t.features[indexfac].properties.FB_0910);
				var th_facade_09 = Number(facade_data_t.features[indexfac].properties.TH_0910);
				var tp_facade_09 = Number(facade_data_t.features[indexfac].properties.TP_0910);
				
				var fnb_facade_11 = Number(facade_data_t.features[indexfac].properties.FNB_1112);
				var fb_facade_11 = Number(facade_data_t.features[indexfac].properties.FB_1112);
				var th_facade_11 = Number(facade_data_t.features[indexfac].properties.TH_1112);
				var cfe_facade_11 = Number(facade_data_t.features[indexfac].properties.CFE_1112);
				var cvae_facade_11 = Number(facade_data_t.features[indexfac].properties.CVAE_1112);
				var ifer_facade_11 = Number(facade_data_t.features[indexfac].properties.IFER_1112);
				var tsfacade_facade_11 = Number(facade_data_t.features[indexfac].properties.TSCOM_1112);
				
				var fnb_facade_15 = Number(facade_data_t.features[indexfac].properties.FNB_1516);
				var fb_facade_15 = Number(facade_data_t.features[indexfac].properties.FB_1516);
				var th_facade_15 = Number(facade_data_t.features[indexfac].properties.TH_1516);
				var cfe_facade_15 = Number(facade_data_t.features[indexfac].properties.CFE_1516);
				var cvae_facade_15 = Number(facade_data_t.features[indexfac].properties.CVAE_1516);
				var ifer_facade_15 = Number(facade_data_t.features[indexfac].properties.IFER_1516);
				var tsfacade_facade_15 = Number(facade_data_t.features[indexfac].properties.TSCOM_1516);
				
				var part_m_facade_02 = ((th_facade_02 + fb_facade_02)/(th_facade_02 + fb_facade_02 + fnb_facade_02 + tp_facade_02)) * 100
				var part_m_facade_09 = ((th_facade_09 + fb_facade_09)/(th_facade_09 + fb_facade_09 + fnb_facade_09 + tp_facade_09)) * 100				
				var part_m_facade_11 = ((th_facade_11 + fb_facade_11)/(th_facade_11 + fb_facade_11 + fnb_facade_11 + cfe_facade_11 + cvae_facade_11 + ifer_facade_11 + tsfacade_facade_11)) * 100
				var part_m_facade_15 = ((th_facade_15 + fb_facade_15)/(th_facade_15 + fb_facade_15 + fnb_facade_15 + cfe_facade_15 + cvae_facade_15 + ifer_facade_15 + tsfacade_facade_15)) * 100				

				var facade_data = [part_m_facade_02.toFixed(2),part_m_facade_09.toFixed(2),part_m_facade_11.toFixed(2),part_m_facade_15.toFixed(2)];
				
				
				////////////// FRANCE
				
				var fnb_france_02 = Number(france_data_t.features[0].properties.FNB_0203);
				var fb_france_02 = Number(france_data_t.features[0].properties.FB_0203);
				var th_france_02 = Number(france_data_t.features[0].properties.TH_0203);
				var tp_france_02 = Number(france_data_t.features[0].properties.TP_0203);
				
				var fnb_france_09 = Number(france_data_t.features[0].properties.FNB_0910);
				var fb_france_09 = Number(france_data_t.features[0].properties.FB_0910);
				var th_france_09 = Number(france_data_t.features[0].properties.TH_0910);
				var tp_france_09 = Number(france_data_t.features[0].properties.TP_0910);
				
				var fnb_france_11 = Number(france_data_t.features[0].properties.FNB_1112);
				var fb_france_11 = Number(france_data_t.features[0].properties.FB_1112);
				var th_france_11 = Number(france_data_t.features[0].properties.TH_1112);
				var cfe_france_11 = Number(france_data_t.features[0].properties.CFE_1112);
				var cvae_france_11 = Number(france_data_t.features[0].properties.CVAE_1112);
				var ifer_france_11 = Number(france_data_t.features[0].properties.IFER_1112);
				var tsfrance_france_11 = Number(france_data_t.features[0].properties.TSCOM_1112);
				
				var fnb_france_15 = Number(france_data_t.features[0].properties.FNB_1516);
				var fb_france_15 = Number(france_data_t.features[0].properties.FB_1516);
				var th_france_15 = Number(france_data_t.features[0].properties.TH_1516);
				var cfe_france_15 = Number(france_data_t.features[0].properties.CFE_1516);
				var cvae_france_15 = Number(france_data_t.features[0].properties.CVAE_1516);
				var ifer_france_15 = Number(france_data_t.features[0].properties.IFER_1516);
				var tsfrance_france_15 = Number(france_data_t.features[0].properties.TSCOM_1516);
				
				var part_m_france_02 = ((th_france_02 + fb_france_02)/(th_france_02 + fb_france_02 + fnb_france_02 + tp_france_02)) * 100
				var part_m_france_09 = ((th_france_09 + fb_france_09)/(th_france_09 + fb_france_09 + fnb_france_09 + tp_france_09)) * 100				
				var part_m_france_11 = ((th_france_11 + fb_france_11)/(th_france_11 + fb_france_11 + fnb_france_11 + cfe_france_11 + cvae_france_11 + ifer_france_11 + tsfrance_france_11)) * 100
				var part_m_france_15 = ((th_france_15 + fb_france_15)/(th_france_15 + fb_france_15 + fnb_france_15 + cfe_france_15 + cvae_france_15 + ifer_france_15 + tsfrance_france_15)) * 100				

				var fra_data = [part_m_france_02.toFixed(2),part_m_france_09.toFixed(2),part_m_france_11.toFixed(2),part_m_france_15.toFixed(2)];
				
				barChartData4.datasets[0].data = nouvelleData; // Remplacement des données de base par les données de population 
				barChartData4.datasets[1].data = epci_graphe;
				barChartData4.datasets[2].data = depart_data;
				barChartData4.datasets[3].data = facade_data;
				barChartData4.datasets[4].data = fra_data;
				barChartData4.labels = ['2002-03', '2009-10', '2011-12', '2015-16'];
				window.myBar4.update();
		
				window.myBar4.options.title.text = 'Part du produit des impôts ménages dans le produit total des impôts locaux du bloc communal (%)';
				barChartData4.datasets[0].label = nomcom;
				barChartData4.datasets[1].label = "Moyenne " + epci;
				barChartData4.datasets[2].label = "Moyenne " + depart;
				window.myBar4.update();
						
						
			
			
			break;
			
			
			case '9': // Part des recettes fiscales dans le produit total de fonctionnement
			
				////////////// COMMUNE
			
				var fisc_com02 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_0203);
				var fisc_com09 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_0910);
				var fisc_com15 = Number(json_donnees_finales.features[indexcom_d].properties.FISC_1516);
				var fonct_com02 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_0203);
				var fonct_com09 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_0910);
				var fonct_com15 = Number(json_donnees_finales.features[indexcom_d].properties.P_FCT_1516);
				
				var part_fisc_com02 = (fisc_com02 / fonct_com02 ) * 100;
				var part_fisc_com09 = (fisc_com09 / fonct_com09 ) * 100;
				var part_fisc_com15 = (fisc_com15 / fonct_com15 ) * 100;
				
				var nouvelleData = [part_fisc_com02.toFixed(2),part_fisc_com09.toFixed(2),part_fisc_com15.toFixed(2)]; 

				////////////// EPCI

				var fisc_epci02 = Number(epci_data.features[indexepci].properties.FISC_0203);
				var fisc_epci09 = Number(epci_data.features[indexepci].properties.FISC_0910);
				var fisc_epci15 = Number(epci_data.features[indexepci].properties.FISC_1516);
				var fonct_epci02 = Number(epci_data.features[indexepci].properties.P_FCT_0203);
				var fonct_epci09 = Number(epci_data.features[indexepci].properties.P_FCT_0910);
				var fonct_epci15 = Number(epci_data.features[indexepci].properties.P_FCT_1516);
				
				var part_fisc_epci02 = (fisc_epci02 / fonct_epci02 ) * 100;
				var part_fisc_epci09 = (fisc_epci09 / fonct_epci09 ) * 100;
				var part_fisc_epci15 = (fisc_epci15 / fonct_epci15 ) * 100;
				
				var epci_graphe = [part_fisc_epci02.toFixed(2),part_fisc_epci09.toFixed(2),part_fisc_epci15.toFixed(2)]; 

				
				////////////// DEPARTEMENT
				
				var fisc_depart02 = Number(dep_data_t.features[indexdep].properties.FISC_0203);
				var fisc_depart09 = Number(dep_data_t.features[indexdep].properties.FISC_0910);
				var fisc_depart15 = Number(dep_data_t.features[indexdep].properties.FISC_1516);
				var fonct_depart02 = Number(dep_data_t.features[indexdep].properties.P_FCT_0203);
				var fonct_depart09 = Number(dep_data_t.features[indexdep].properties.P_FCT_0910);
				var fonct_depart15 = Number(dep_data_t.features[indexdep].properties.P_FCT_1516);
				
				var part_fisc_depart02 = (fisc_depart02 / fonct_depart02 ) * 100;
				var part_fisc_depart09 = (fisc_depart09 / fonct_depart09 ) * 100;
				var part_fisc_depart15 = (fisc_depart15 / fonct_depart15 ) * 100;
				
				var depart_data = [part_fisc_depart02.toFixed(2),part_fisc_depart09.toFixed(2),part_fisc_depart15.toFixed(2)];
				
				////////////// FACADE LITTORALE 
				
				var fisc_facade02 = Number(facade_data_t.features[indexfac].properties.FISC_0203);
				var fisc_facade09 = Number(facade_data_t.features[indexfac].properties.FISC_0910);
				var fisc_facade15 = Number(facade_data_t.features[indexfac].properties.FISC_1516);
				var fonct_facade02 = Number(facade_data_t.features[indexfac].properties.P_FCT_0203);
				var fonct_facade09 = Number(facade_data_t.features[indexfac].properties.P_FCT_0910);
				var fonct_facade15 = Number(facade_data_t.features[indexfac].properties.P_FCT_1516);
				
				var part_fisc_facade02 = (fisc_facade02 / fonct_facade02 ) * 100;
				var part_fisc_facade09 = (fisc_facade09 / fonct_facade09 ) * 100;
				var part_fisc_facade15 = (fisc_facade15 / fonct_facade15 ) * 100;
				
				var facade_data = [part_fisc_facade02.toFixed(2),part_fisc_facade09.toFixed(2),part_fisc_facade15.toFixed(2)];
				
				
				////////////// FRANCE
				
				var fisc_france02 = Number(france_data_t.features[0].properties.FISC_0203);
				var fisc_france09 = Number(france_data_t.features[0].properties.FISC_0910);
				var fisc_france15 = Number(france_data_t.features[0].properties.FISC_1516);
				var fonct_france02 = Number(france_data_t.features[0].properties.P_FCT_0203);
				var fonct_france09 = Number(france_data_t.features[0].properties.P_FCT_0910);
				var fonct_france15 = Number(france_data_t.features[0].properties.P_FCT_1516);
				
				var part_fisc_france02 = (fisc_france02 / fonct_france02 ) * 100;
				var part_fisc_france09 = (fisc_france09 / fonct_france09 ) * 100;
				var part_fisc_france15 = (fisc_france15 / fonct_france15 ) * 100;
				
				var fra_data = [part_fisc_france02.toFixed(2),part_fisc_france09.toFixed(2),part_fisc_france15.toFixed(2)];
				
				barChartData4.datasets[0].data = nouvelleData; 
				barChartData4.datasets[1].data = epci_graphe;
				barChartData4.datasets[2].data = depart_data;
				barChartData4.datasets[3].data = facade_data;
				barChartData4.datasets[4].data = fra_data;
				barChartData4.labels = ['2002-03', '2009-10', '2015-16'];
				window.myBar4.update();
		
				window.myBar4.options.title.text = 'Part des recettes fiscales dans le produit total de fonctionnement (%)';
				barChartData4.datasets[0].label = nomcom;
				barChartData4.datasets[1].label = "Moyenne " + epci;
				barChartData4.datasets[2].label = "Moyenne " + depart;
				window.myBar4.update();
						
			
			
			break;
			
			
			
		}	
		
	}
	
		document.getElementById("selecteur2").style.visibility = "visible";
		document.getElementById("selecteur3").style.visibility = "visible";
		document.getElementById("selecteur4").style.visibility = "visible";
		document.getElementById("selection").style.visibility = "visible";
		document.getElementById("selection2").style.visibility = "visible";
		document.getElementById("selection3").style.visibility = "visible";
		document.getElementById("selection4").style.visibility = "visible";
	
	</script>
	
	  <script type="text/javascript"> // Cette fonction récupère l'index de la commune dans le tableau de données géographiques, afin d'en récupérer les espaces de référence
    var code = "Erreur";
	var indexcom = "Erreur";
	var nomcom = "Erreur"; 
	var epci = "Erreur";
	var depart = "Erreur";
	var facade = "Erreur";
	nomcom = "Erreur";
	indexcom = "Commune Inconnue";
    code = codecommuneconc;  
	for( i = 0; i < json_Couche_finale_typo_1.features.length; i += 1) { // Parcourt le tableau de données pour récupérer l'index de l'entité correspondant au code INSEE
        if(json_Couche_finale_typo_1.features[i].properties.insee_comm === code) {
            indexcom = i;
        }
    }
	if(indexcom === "Commune Inconnue") { 
		alert('Commune inconnue, veuillez réessayer');
	};
	nomcom = json_Couche_finale_typo_1.features[indexcom].properties.Nom;
	epci = json_Couche_finale_typo_1.features[indexcom].properties.EPCI;
	depart = json_Couche_finale_typo_1.features[indexcom].properties.nom_depart;
	facade = json_Couche_finale_typo_1.features[indexcom].properties.Facade;
	//alert(`Rapport pour la commune de ${nomcom}`);
	  </script>
	  
	<script type="text/javascript"> // Cette partie récupère l'index de la commune dans le tableau de données stat afin d'en récupérer les valeurs par la suite
	var code_d = "Erreur";
	var indexcom_d = "Erreur";
	for( j = 0; j < json_donnees_finales.features.length; j += 1) { // Parcourt le tableau de données pour récupérer l'index de l'entité correspondant au code INSEE
		if(json_donnees_finales.features[j].properties.insee_comm === code) {
            indexcom_d = j;
        }
    }
	if(indexcom_d === "Commune Inconnue") { 
		alert('Commune inconnue, veuillez réessayer');
	};
	</script>

	<script type="text/javascript"> // Cette partie récupère l'index de l'EPCI dans le tableau de données stat afin d'en récupérer les valeurs par la suite
	var indexepci = "Erreur";
	for( k = 0; k < epci_data.features.length; k += 1) { // Parcourt le tableau de données pour récupérer l'index de l'EPCI
		if(epci_data.features[k].properties.LIBEPCI === epci) {
            indexepci = k;
        }
    }
	if(indexepci === "Erreur") { 
		alert('EPCI inconnu, veuillez réessayer');
	};
	</script>

	<script type="text/javascript"> // Cette partie récupère l'index du département dans le tableau de données stat afin d'en récupérer les valeurs par la suite
	var indexdep = "Erreur";
	for( j = 0; j < dep_data_t.features.length; j += 1) { // Parcourt le tableau de données pour récupérer l'index du département
		if(dep_data_t.features[j].properties.d_libelle === depart) {
            indexdep = j;
        }
    }
	if(indexdep === "Erreur") { 
		alert('Département inconnu, veuillez réessayer');
	};
	</script>

	<script type="text/javascript"> // Cette partie récupère l'index de la façade dans le tableau de données stat afin d'en récupérer les valeurs par la suite
	var indexfac = "Erreur";
	for( j = 0; j < facade_data_t.features.length; j += 1) { // Parcourt le tableau de données pour récupérer l'index de la facade
		if(facade_data_t.features[j].properties.Facade === facade) {
            indexfac = j;
        }
    }
	if(indexfac === "Erreur") { 
		alert('Facade inconnue, veuillez réessayer');
	};
	</script>
	
	<script type="text/javascript"> // Cette partie récupère les différents index dans les tableau de données de résidences secondaires
	
	var code_r = "Erreur";
	var indexcom_r = "Erreur";
	for( j = 0; j < sec_com.features.length; j += 1) { // Parcourt le tableau de données pour récupérer l'index de l'entité correspondant au code INSEE
		if(sec_com.features[j].properties.Code === code) {
            indexcom_r = j;
        }
    }
	if(indexcom_r === "Erreur") { 
		alert('Commune inconnue, veuillez réessayer');
	};
	
	var indexepci_r = "Erreur";
	for( k = 0; k < sec_epci.features.length; k += 1) { // Parcourt le tableau de données pour récupérer l'index de l'EPCI
		if(sec_epci.features[k].properties.LIBEPCI === epci) {
            indexepci_r = k;
        }
    }
	if(indexepci_r === "Erreur") { 
		alert('EPCI inconnu, veuillez réessayer');
	};
	
	var indexdep_r = "Erreur";
	for( j = 0; j < sec_dep.features.length; j += 1) { // Parcourt le tableau de données pour récupérer l'index du département
		if(sec_dep.features[j].properties.d_libelle === depart) {
            indexdep_r = j;
        }
    }
	if(indexdep_r === "Erreur") { 
		alert('Département inconnu, veuillez réessayer');
	};
	
	var indexfac_r = "Erreur";
	for( j = 0; j < sec_fac.features.length; j += 1) { // Parcourt le tableau de données pour récupérer l'index de la facade
		if(sec_fac.features[j].properties.Facade === facade) {
            indexfac_r = j;
        }
    }
	if(indexfac_r === "Erreur") { 
		alert('Facade inconnue, veuillez réessayer');
	};
	
	
	
	</script>
	
	<script>
		var barChartData = {
			labels: ['1999', '2010', '2016'],
			datasets: [{
				label: "Moyenne " + nomcom,
				backgroundColor: window.chartColors.red,
				stack: 'Stack 0',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}, {
				label: "Moyenne " + epci,
				backgroundColor: window.chartColors.orange,
				stack: 'Stack 1',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}, 
			{
				label: "Moyenne " + depart,
				backgroundColor: window.chartColors.yellow,
				stack: 'Stack 2',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			},{
				label: "Moyenne " + facade,
				backgroundColor: window.chartColors.blue,
				stack: 'Stack 3',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			},
			{
				label: 'Moyenne France',
				backgroundColor: window.chartColors.green,
				stack: 'Stack 4',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}]

		};
	
		var barChartData2 = {
			labels: ['1999', '2010', '2016'],
			datasets: [{
				label: "Moyenne " + nomcom,
				backgroundColor: window.chartColors.red,
				stack: 'Stack 0',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}, {
				label: "Moyenne " + epci,
				backgroundColor: window.chartColors.orange,
				stack: 'Stack 1',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}, 
			{
				label: "Moyenne " + depart,
				backgroundColor: window.chartColors.yellow,
				stack: 'Stack 2',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			},{
				label: "Moyenne " + facade,
				backgroundColor: window.chartColors.blue,
				stack: 'Stack 3',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			},
			{
				label: 'Moyenne France',
				backgroundColor: window.chartColors.green,
				stack: 'Stack 4',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}]

		};
		
		var barChartData3 = {
			labels: ['1999', '2010', '2016'],
			datasets: [{
				label: "Moyenne " + nomcom,
				backgroundColor: window.chartColors.red,
				stack: 'Stack 0',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}, {
				label: "Moyenne " + epci,
				backgroundColor: window.chartColors.orange,
				stack: 'Stack 1',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}, 
			{
				label: "Moyenne " + depart,
				backgroundColor: window.chartColors.yellow,
				stack: 'Stack 2',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			},{
				label: "Moyenne " + facade,
				backgroundColor: window.chartColors.blue,
				stack: 'Stack 3',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			},
			{
				label: 'Moyenne France',
				backgroundColor: window.chartColors.green,
				stack: 'Stack 4',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}]

		};
		
		var barChartData4 = {
			labels: ['1999', '2010', '2016'],
			datasets: [{
				label: "Moyenne " + nomcom,
				backgroundColor: window.chartColors.red,
				stack: 'Stack 0',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}, {
				label: "Moyenne " + epci,
				backgroundColor: window.chartColors.orange,
				stack: 'Stack 1',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}, 
			{
				label: "Moyenne " + depart,
				backgroundColor: window.chartColors.yellow,
				stack: 'Stack 2',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			},{
				label: "Moyenne " + facade,
				backgroundColor: window.chartColors.blue,
				stack: 'Stack 3',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			},
			{
				label: 'Moyenne France',
				backgroundColor: window.chartColors.green,
				stack: 'Stack 4',
				data: [
					getRandomInt(60,5550),
					getRandomInt(60,5550),
					getRandomInt(60,5550)
				]
			}]

		};

		
		window.onload = function() {
			var ctx = document.getElementById('canvas').getContext('2d');
			window.myBar = new Chart(ctx, {
				type: 'bar',
				data: barChartData,
				options: {
					legend:{
						labels: {
							fontSize: 14,
							boxWidth: 30,
						}
					},
					title: {
						display: true,
						text: 'Commune de ' + nomcom,
						fontSize: 16
					},
					tooltips: {
						mode: 'index',
						intersect: false,
					},
					responsive: true,
					aspectRatio: 2,
					scales: {
						xAxes: [{
							stacked: true,
							ticks: {
								autoSkip: false,
								maxRotation: 0,
								minRotation: 0,
							}
						}],
						yAxes: [{
							stacked: true,
						}]
					}
				}
			});
			var ctx2 = document.getElementById('canvas2').getContext('2d');
			window.myBar2 = new Chart(ctx2, {
				type: 'bar',
				data: barChartData2,
				options: {
					legend:{
						labels: {
							fontSize: 14,
							boxWidth: 30,
						}
					},
					title: {
						display: true,
						text: 'Commune de ' + nomcom,
						fontSize: 16
					},
					tooltips: {
						mode: 'index',
						intersect: false,
					},
					responsive: true,
					scales: {
						xAxes: [{
							stacked: true,
							ticks: {
								autoSkip: false,
								maxRotation: 0,
								minRotation: 0,
							}
						}],
						yAxes: [{
							stacked: true,
						}]
					}
				}
			});
		};
			var ctx3 = document.getElementById('canvas3').getContext('2d');
			window.myBar3 = new Chart(ctx3, {
				type: 'bar',
				data: barChartData3,
				options: {
					legend:{
						labels: {
							fontSize: 14,
							boxWidth: 30,
						}
					},
					title: {
						display: true,
						text: 'Commune de ' + nomcom,
						fontSize: 16
					},
					tooltips: {
						mode: 'index',
						intersect: false,
					},
					responsive: true,
					scales: {
						xAxes: [{
							stacked: true,
							ticks: {
								autoSkip: false,
								maxRotation: 0,
								minRotation: 0,
							}
						}],
						yAxes: [{
							stacked: true,
						}]
					}
				}
			});
			var ctx4 = document.getElementById('canvas4').getContext('2d');
			window.myBar4 = new Chart(ctx4, {
				type: 'bar',
				data: barChartData4,
				options: {
					legend:{
						labels: {
							fontSize: 14,
							boxWidth: 30,
						}
					},
					title: {
						display: true,
						text: 'Commune de ' + nomcom,
						fontSize: 16
					},
					tooltips: {
						mode: 'index',
						intersect: false,
					},
					responsive: true,
					scales: {
						xAxes: [{
							stacked: true,
							ticks: {
								autoSkip: false,
								maxRotation: 0,
								minRotation: 0,
							}
						}],
						yAxes: [{
							stacked: true,
						}]
					}
				}
			});




		
		function getRandomInt(min, max) { // Génère des valeurs aléatoires entières
			min = Math.ceil(min);
			max = Math.floor(max);
			return Math.floor(Math.random() * (max - min)) + min;
		}


	</script>

<!-- <div id="centered_div"><div class="carre"><p style="text-align : center;"> <b> Commune de <script type="text/javascript"> document.write(nomcom) </script></b></p> </div></div> -->
</body>